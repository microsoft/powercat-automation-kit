<!doctype html>
<html lang="en-us">
    <a id="topOfPage"></a>
    <head>
        

<meta property="og:title" content="Regnemaskine" />
<meta property="og:description" content="Automatiseringssæt - Lommeregner" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/da/calculator/" /><meta property="article:section" content="" />





<meta name="description" content="Automatiseringssæt til Power Platform startside. Definer og mål investeringsafkast i Power Automate Desktop, link til læringsindhold og kundehistorier." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

        <title>Automation Kit for Power Platform</title>
        
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.900ac3346e02b249eca52c9ae838525e38bee9dc718fb9fd6cc0fbcfa923b149.css" integrity="sha256-kArDNG4CsknspSya6DhSXji&#43;6dxxj7n9bMD7z6kjsUk=">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script type="module" src="https://unpkg.com/@fluentui/web-components"></script>

    </head>
    <body>
    

    
<nav class="navbar navbar-expand-lg navbar-dark bg-gray">
    <div class="container d-flex justify-content-between">
        <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/da/">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="56">
        </a>
        <span class="my-1 title text-black">Automatiseringssæt til Power Platform</span>
    </div>
</nav>
<article>
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Regnemaskine</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      












<script>
    
    
    data = "{\r\n  \"showQuestionNumbers\": \"off\",\r\n  \"pages\": [\r\n    {\r\n      \"name\": \"welcome\",\r\n      \"visibleIf\": \"{preview} = true\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"radiogroup\",\r\n          \"name\": \"scenario\",\r\n          \"title\": {\r\n            \"default\": \"What scenario are you trying to calculate?\",\r\n            \"da\": \"Hvilket scenarie forsøger du at beregne?\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"calculator\",\r\n              \"text\": {\r\n                \"default\": \"Power Automate / Power Automate Desktop license cost\",\r\n                \"da\": \"Licensomkostninger for Power Automate/Power Automate Desktop\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"migration-planner\",\r\n              \"text\": {\r\n                \"default\": \"Migration planner\",\r\n                \"da\": \"Planlægning af migrering\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"samples\",\r\n              \"text\": {\r\n                \"default\": \"Sample scenarios\",\r\n                \"da\": \"Eksempler på scenarier\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"radiogroup\",\r\n          \"name\": \"sample-scenario\",\r\n          \"visibleIf\": \"{scenario} = 'samples'\",\r\n          \"title\": {\r\n            \"default\": \"What sample scenario did you want to explore?\",\r\n            \"da\": \"Hvilket eksempelscenarie ville du undersøge?\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"migration-single-unattended\",\r\n              \"text\": {\r\n                \"default\": \"Migration of a single unattended bot running isolated from other bot process\",\r\n                \"da\": \"Migrering af en enkelt uovervåget robot, der kører isoleret fra en anden botproces\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"migration-200\",\r\n              \"text\": {\r\n                \"default\": \"Migration of hundreds of bots\",\r\n                \"da\": \"Migrering af hundredvis af bots\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"process-mining\",\r\n              \"text\": {\r\n                \"default\": \"Using Process Advisor to identify Process automation\",\r\n                \"da\": \"Brug af Process Advisor til at identificere procesautomatisering\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"task-mining\",\r\n              \"text\": {\r\n                \"default\": \"Using Process Advisor task mining to analyze and improve bot reliability\",\r\n                \"da\": \"Brug af Process Advisor opgavemining til at analysere og forbedre botpålidelighed\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{sample-scenario} = 'migration-single-unattended'\",\r\n          \"html\": {\r\n            \"default\": \"Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.\",\r\n            \"da\": \"Enkelt uovervåget botmigrering. I dette eksempel vil en organisation måske migrere en eksisterende automatiseringsløsning til Power Platform. Den implementerede bot hostes i et isoleret virtuelt netværk og Virtual Machine (VM) runner.\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"migration\",\r\n      \"title\": {\r\n        \"default\": \"Migration Parameters\",\r\n        \"da\": \"Parametre for overførsel\"\r\n      },\r\n      \"visibleIf\": \"{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')\",\r\n      \"elements\": [\r\n        {\r\n          \"name\": \"how-many-automation-projects\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"How many automation projects to migrate?\",\r\n            \"da\": \"Hvor mange automatiseringsprojekter skal migreres?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"attended-percentage\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"Percentage of attended automation projects?\",\r\n            \"da\": \"Procentdel af deltog automatiseringsprojekter?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"expression\",\r\n              \"text\": {\r\n                \"default\": \"A value between 0 and 100\",\r\n                \"da\": \"En værdi mellem 0 og 100\"\r\n              },\r\n              \"expression\": \"{attended-percentage} \u003e= 0 \u0026\u0026 {attended-percentage} \u003c= 100\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"unattended-percentage\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"Percentage of unattended automation projects?\",\r\n            \"da\": \"Procentdel af uovervågede automatiseringsprojekter?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"expression\",\r\n              \"text\": {\r\n                \"default\": \"A value between 0 and 100\",\r\n                \"da\": \"En værdi mellem 0 og 100\"\r\n              },\r\n              \"expression\": \"{unattended-percentage} \u003e= 0 \u0026\u0026 {unattended-percentage} \u003c= 100\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-groups\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new group\",\r\n            \"da\": \"Tilføj ny gruppe\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Migration Groups\",\r\n            \"da\": \"Overførselsgrupper\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"name\",\r\n              \"title\": {\r\n                \"default\": \"Migration Group Name\",\r\n                \"da\": \"Navn på overførselsgruppe\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            },\r\n            {\r\n              \"name\": \"description\",\r\n              \"title\": {\r\n                \"default\": \"Description\",\r\n                \"da\": \"Beskrivelse: __________\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"groups\",\r\n          \"type\": \"checkbox\",\r\n          \"title\": {\r\n            \"default\": \"Groups\",\r\n            \"da\": \"Grupper\"\r\n          },\r\n          \"visibleIf\": \"false\",\r\n          \"choices\": []\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-times\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"da\": \"Tilføj nyt element\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Duration Plan\",\r\n            \"da\": \"Varighed Plan\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"complexity\",\r\n              \"title\": {\r\n                \"default\": \"Complexity\",\r\n                \"da\": \"Kompleksitet\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"inputType\": \"count\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"low\",\r\n                  \"text\": {\r\n                    \"default\": \"Low\",\r\n                    \"da\": \"Lav\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"medium\",\r\n                  \"text\": {\r\n                    \"default\": \"Medium\",\r\n                    \"da\": \"Medium\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"high\",\r\n                  \"text\": {\r\n                    \"default\": \"High\",\r\n                    \"da\": \"Høj\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"group\",\r\n              \"title\": {\r\n                \"default\": \"Group\",\r\n                \"da\": \"Gruppe\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choicesFromQuestion\": \"groups\"\r\n            },\r\n            {\r\n              \"name\": \"percentage\",\r\n              \"title\": {\r\n                \"default\": \"Percentage\",\r\n                \"da\": \"Procentdel\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"projects\",\r\n              \"title\": {\r\n                \"default\": \"Projects\",\r\n                \"da\": \"Projekter\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))\"\r\n            },\r\n            {\r\n              \"name\": \"projectsPerMonth\",\r\n              \"title\": {\r\n                \"default\": \"Projects per month\",\r\n                \"da\": \"Projekter pr. måned\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"total\",\r\n              \"title\": {\r\n                \"default\": \"Total (Business Days)\",\r\n                \"da\": \"I alt (hverdage)\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"ceil({row.projects} / {row.projectsPerMonth} * 20)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.\",\r\n            \"da\": \"BEMÆRK: Værdierne er kun til illustrationsformål, og rampetid, projekter pr. måned og samlede arbejdsdage for migrering skal bestemmes for de specifikke projekter, der migreres.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"calc-migration-plan\",\r\n          \"title\": {\r\n            \"default\": \"Automatically calculate possible migration plan?\",\r\n            \"da\": \"Beregn automatisk mulig migreringsplan?\"\r\n          },\r\n          \"defaultValue\": true\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-plan\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"da\": \"Tilføj nyt element\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Migration Plan\",\r\n            \"da\": \"Migrationsplan\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"name\",\r\n              \"title\": {\r\n                \"default\": \"Name\",\r\n                \"da\": \"Navn\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            },\r\n            {\r\n              \"name\": \"low\",\r\n              \"title\": {\r\n                \"default\": \"Low\",\r\n                \"da\": \"Lav\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"medium\",\r\n              \"title\": {\r\n                \"default\": \"Medium\",\r\n                \"da\": \"Medium\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"high\",\r\n              \"title\": {\r\n                \"default\": \"High\",\r\n                \"da\": \"Høj\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"attended\",\r\n              \"title\": {\r\n                \"default\": \"Attended\",\r\n                \"da\": \"Deltog\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"unattended\",\r\n              \"title\": {\r\n                \"default\": \"Unattended\",\r\n                \"da\": \"Automatisk\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"calculation\",\r\n      \"elements\": [\r\n        {\r\n          \"name\": \"tellMeMore\",\r\n          \"type\": \"boolean\",\r\n          \"title\": {\r\n            \"default\": \"Tell me more about each license type\",\r\n            \"da\": \"Fortæl mig mere om hver licenstype\"\r\n          },\r\n          \"defaultValue\": true\r\n        },\r\n        {\r\n          \"name\": \"matrix-image\",\r\n          \"type\": \"image-task\",\r\n          \"visibleIf\": \"{tellMeMore} == true\",\r\n          \"title\": {\r\n            \"default\": \"Select plans you want more information on\",\r\n            \"da\": \"Vælg planer, du vil have flere oplysninger om\"\r\n          },\r\n          \"src\": \"https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2\"\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at \u003ca href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'\u003eBuy Power Automate Licenses\u003c/a\u003e\",\r\n            \"da\": \"Yderligere oplysninger om licenser, der omfatter seedede licenser med Microsoft Office 365, Microsoft Dynamics, Pay as you Go-indstillinger og Windows findes på \u003ca href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'\u003eKøb Power Automate-licenser\u003c/a\u003e\"\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"includeCurrentCost\",\r\n          \"title\": {\r\n            \"default\": \"Include current costs\",\r\n            \"da\": \"Inkluder løbende omkostninger\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"type\": \"boolean\",\r\n          \"defaultValue\": false\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"currentItems\",\r\n          \"rowCount\": 1,\r\n          \"minRowCount\": 1,\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"da\": \"Tilføj nyt element\"\r\n          },\r\n          \"visibleIf\": \"{includeCurrentCost}\",\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"type\",\r\n              \"title\": {\r\n                \"default\": \"Type\",\r\n                \"da\": \"Slags\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Makers\",\r\n                  \"text\": {\r\n                    \"default\": \"Makers\",\r\n                    \"da\": \"Beslutningstagere\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Licenses\",\r\n                  \"text\": {\r\n                    \"default\": \"Licenses\",\r\n                    \"da\": \"Licenser\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Infrastructure\",\r\n                  \"text\": {\r\n                    \"default\": \"Infrastructure\",\r\n                    \"da\": \"Infrastruktur\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"amount\",\r\n              \"title\": {\r\n                \"default\": \"Amount\",\r\n                \"da\": \"Beløb\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"min\": 1\r\n            },\r\n            {\r\n              \"name\": \"cost\",\r\n              \"title\": {\r\n                \"default\": \"Cost\",\r\n                \"da\": \"Koste\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"displayStyle\": \"currency\",\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"min\": 1\r\n            },\r\n            {\r\n              \"name\": \"monthly\",\r\n              \"title\": {\r\n                \"default\": \"Monthly\",\r\n                \"da\": \"Månedlig\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"boolean\",\r\n              \"defaultValue\": false,\r\n              \"labelTrue\": \"Monthly\",\r\n              \"labelFalse\": \"Yearly\"\r\n            },\r\n            {\r\n              \"name\": \"currentTotal\",\r\n              \"title\": {\r\n                \"default\": \"Total\",\r\n                \"da\": \"Total\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"{row.amount} * {row.cost} * iif({row.monthly},12,1)\",\r\n              \"displayStyle\": \"currency\",\r\n              \"totalType\": \"sum\",\r\n              \"totalDisplayStyle\": \"currency\",\r\n              \"totalFormat\": \"Total: {0}\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"retailPrice\",\r\n          \"type\": \"boolean\",\r\n          \"title\": {\r\n            \"default\": \"Power Platform license costs monthly\",\r\n            \"da\": \"Power Platform licens koster månedligt\"\r\n          },\r\n          \"labelTrue\": \"Retail price\",\r\n          \"labelFalse\": \"Custom price\",\r\n          \"defaultValue\": true\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"items\",\r\n          \"rowCount\": 1,\r\n          \"minRowCount\": 1,\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"da\": \"Tilføj nyt element\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"type\",\r\n              \"title\": {\r\n                \"default\": \"Type\",\r\n                \"da\": \"Slags\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Trial\",\r\n                  \"text\": {\r\n                    \"default\": \"Trial\",\r\n                    \"da\": \"Rettergang\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"User\",\r\n                  \"text\": {\r\n                    \"default\": \"User\",\r\n                    \"da\": \"Bruger\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Flow\",\r\n                  \"text\": {\r\n                    \"default\": \"Flow\",\r\n                    \"da\": \"Strøm\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Extra Flow\",\r\n                  \"text\": {\r\n                    \"default\": \"Extra Flow\",\r\n                    \"da\": \"Ekstra flow\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"mode\",\r\n              \"title\": {\r\n                \"default\": \"Mode\",\r\n                \"da\": \"Tilstand\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Attended\",\r\n                  \"text\": {\r\n                    \"default\": \"Attended\",\r\n                    \"da\": \"Deltog\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Unattended\",\r\n                  \"text\": {\r\n                    \"default\": \"Unattended\",\r\n                    \"da\": \"Automatisk\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Cloud\",\r\n                  \"text\": {\r\n                    \"default\": \"Cloud\",\r\n                    \"da\": \"Sky\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"price\",\r\n              \"title\": {\r\n                \"default\": \"Price\",\r\n                \"da\": \"Pris\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"getItemPrice()\",\r\n              \"displayStyle\": \"currency\",\r\n              \"visibleIf\": \"{retailPrice} == true\"\r\n            },\r\n            {\r\n              \"name\": \"customPrice\",\r\n              \"title\": {\r\n                \"default\": \"Price\",\r\n                \"da\": \"Pris\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"displayStyle\": \"currency\",\r\n              \"visibleIf\": \"{retailPrice} == false\"\r\n            },\r\n            {\r\n              \"name\": \"quantity\",\r\n              \"title\": {\r\n                \"default\": \"Quantity\",\r\n                \"da\": \"Kvantitet\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"totalType\": \"sum\",\r\n              \"totalFormat\": \"Total services: {0}\",\r\n              \"min\": 1\r\n            },\r\n            {\r\n              \"name\": \"total\",\r\n              \"title\": {\r\n                \"default\": \"Total\",\r\n                \"da\": \"Total\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})\",\r\n              \"displayStyle\": \"currency\",\r\n              \"totalType\": \"sum\",\r\n              \"totalDisplayStyle\": \"currency\",\r\n              \"totalFormat\": \"Total: {0}\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"NOTE: Type \u003cb\u003eFlow\u003c/b\u003e represents minimum order of 5 cloud / RPA flows. Type \u003cb\u003eExtra Flow\u003c/b\u003e represents single flow above the minimum order level of 5 flows.\",\r\n            \"da\": \"BEMÆRK: Skriv \u003cb\u003eStrøm\u003c/b\u003e repræsenterer minimumsordre på 5 cloud / RPA-strømme. Slags \u003cb\u003eEkstra flow\u003c/b\u003e repræsenterer enkelt flow over minimumsordreniveauet på 5 flows.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"expression\",\r\n          \"name\": \"powerPlatformCost\",\r\n          \"title\": {\r\n            \"default\": \"Power Platform license cost yearly\",\r\n            \"da\": \"Power Platform licensomkostninger årligt\"\r\n          },\r\n          \"expression\": \"{items-total.total}*12\",\r\n          \"displayStyle\": \"currency\"\r\n        },\r\n        {\r\n          \"name\": \"otherCosts\",\r\n          \"type\": \"boolean\",\r\n          \"title\": {\r\n            \"default\": \"Include other costs\",\r\n            \"da\": \"Inkluder andre omkostninger\"\r\n          },\r\n          \"defaultValue\": false\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"otherItems\",\r\n          \"rowCount\": 1,\r\n          \"minRowCount\": 1,\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"da\": \"Tilføj nyt element\"\r\n          },\r\n          \"visibleIf\": \"{otherCosts}\",\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"type\",\r\n              \"title\": {\r\n                \"default\": \"Type\",\r\n                \"da\": \"Slags\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Migration\",\r\n                  \"text\": {\r\n                    \"default\": \"Migration\",\r\n                    \"da\": \"Migration\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Infrastructure\",\r\n                  \"text\": {\r\n                    \"default\": \"Infrastructure\",\r\n                    \"da\": \"Infrastruktur\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"amount\",\r\n              \"title\": {\r\n                \"default\": \"Amount\",\r\n                \"da\": \"Beløb\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"min\": 1\r\n            },\r\n            {\r\n              \"name\": \"monthly\",\r\n              \"title\": {\r\n                \"default\": \"Monthly\",\r\n                \"da\": \"Månedlig\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"boolean\",\r\n              \"defaultValue\": true,\r\n              \"labelTrue\": \"Monthly\",\r\n              \"labelFalse\": \"Yearly\"\r\n            },\r\n            {\r\n              \"name\": \"otherTotal\",\r\n              \"title\": {\r\n                \"default\": \"Total\",\r\n                \"da\": \"Total\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"{row.amount} * iif({row.monthly},12,1)\",\r\n              \"displayStyle\": \"currency\",\r\n              \"totalType\": \"sum\",\r\n              \"totalDisplayStyle\": \"currency\",\r\n              \"totalFormat\": \"Total: {0}\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"expression\",\r\n          \"title\": {\r\n            \"default\": \"Difference yearly\",\r\n            \"da\": \"Forskel årligt\"\r\n          },\r\n          \"expression\": \"iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))\",\r\n          \"displayStyle\": \"currency\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
    .sv-btn {
        border-radius: 0.3em;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>JavaScript skal være aktiveret for at vise dette indhold</p>
</noscript>


    
<script>
window.getNumber = function (params) {
    return parseInt(window.currentSurvey.data[params[0]])
}
window.getItemPrice = getItemPrice = function (params) {
  var rowType = !!this.row
    ? this.row.getQuestionByColumnName('type')
    : null;

    var modeType = !!this.row
    ? this.row.getQuestionByColumnName('mode')
    : null;
  // if we can't find a question inside the cell (by row and column name) then return
  if (! rowType || ! modeType) 
    return 0;
  
  // get the selected item/choice
  var selectedType = rowType.selectedItem;

  if ( selectedType == null ) {
    // return 0 if a user did not select the item yet.
    return 0
  }

  var modeType = modeType.selectedItem;

  if ( modeType == null ) {
    // return 0 if a user did not select the item yet.
    return 0
  }

  switch ( selectedType.value ) {
    case "Trial":
        return 0;
    case "User":
        switch ( modeType.value ) {
            case "Attended":
                return 40;
                break;
            case "Unattended":
                return 190;
                break;
            case "Cloud":
                return 15;
            default:
                return "";
        }
        break;
    case "Flow":
        switch ( modeType.value ) {
            case "Attended":
                return "";
                break;
            case "Unattended":
                return (150 * 5) + (5 * 100);
                break;
             case "Cloud":
                return (5 * 100);
                break;
            default:
                return "";
        }
        break
    case "Extra Flow":
        switch ( modeType.value ) {
            case "Attended":
                return "";
                break;
            case "Unattended":
                return 150 + 100;
                break;
             case "Cloud":
                return 100;
                break;
        }
        break;
  }
};

window.surveyChanged = function (sender, options) {
    window.currentSurvey = sender;

    var calculateChange = () => {
        let bots = sender.data['how-many-automation-projects'] + 0;
        let percentAttended = sender.data['attended-percentage'] + 0;
        let percentUnattended = sender.data['unattended-percentage'] + 0;
        let attended = Math.round(bots * ( percentAttended / 100));
        let unattended = Math.round(bots * ( percentUnattended / 100));
        let items = [];
        if ( attended > 0 ) {
            items.push({service: 'U_RPA_A', quantity: attended})
        }
        if ( unattended > 0 ) {
            items.push({service: 'U_RPA_UA', quantity: unattended})
        }
        sender.data["items"] = items
        calculatePlan()
    }

    var calculatePlan = () => {
        if ( sender.data['calc-migration-plan'] == false ) {
            return;
        }
        let times = sender.data['migration-times']
        let attendedPercentage = sender.data['attended-percentage']
        let unattendedPercentage = sender.data['unattended-percentage']
        let groups = sender.data['migration-groups']
        if ( times == null || times.length == 0 || groups == null ) {
            return;
        }

        var groupData = {}
        for ( var i = 0; i < groups.length; i++ ) {
            let months = times.reduce((accumlator, currentValue) => { 
                return Math.max(accumlator, ( groups[i].name == currentValue.group ) ? Math.ceil(currentValue.projects / currentValue.projectsPerMonth) : 0)
            }, 0)
            groupData[groups[i].name] = {
                'name': groups[i].name,
                'months': Array.apply(null, Array(months)).map(function(element, index) { return {
                    name: groups[i].name + " " + (index + 1),
                    low:0,
                    medium: 0,
                    high: 0,
                    attended: 0,
                    unattended: 0
                } }),
                'projects': times.reduce((accumlator, currentValue) => { 
                    return accumlator + (( groups[i].name == currentValue.group ) ? currentValue.projects : 0)
                }, 0),
                'low': times.reduce((accumlator, currentValue) => { 
                    return accumlator + (( groups[i].name == currentValue.group && currentValue.complexity == "low" ) ? currentValue.projects : 0)
                }, 0),
                'medium': times.reduce((accumlator, currentValue) => { 
                    return accumlator + (( groups[i].name == currentValue.group && currentValue.complexity == "medium" ) ? currentValue.projects : 0)
                }, 0),
                'high': times.reduce((accumlator, currentValue) => { 
                    return accumlator + (( groups[i].name == currentValue.group && currentValue.complexity == "high" ) ? currentValue.projects : 0)
                }, 0)
            }
            var remaining = {
                low: groupData[groups[i].name].low,
                medium: groupData[groups[i].name].medium,
                high: groupData[groups[i].name].high,
            }
            for ( var t = 0; t < times.length; t++ ) {
                if ( times[t].group == groups[i].name ) {
                    let groupTimeMonths = Math.ceil((times[t].projects / times[t].projectsPerMonth));
                    for ( var m = 0; m < groupTimeMonths; m++) {
                        let value = remaining[times[t].complexity];
                        let projects = Math.min(value, times[t].projectsPerMonth);
                        groupData[groups[i].name].months[m][times[t].complexity] = Math.max(projects,0)
                        value -= projects;
                        remaining[times[t].complexity] = value
                    }
                }
            }
            groupData[groups[i].name].months.map((month) => {
                let total = month.low + month.medium + month.high;
                month.attended = Math.round(total * ( attendedPercentage / 100));
                month.unattended = Math.round(total * ( unattendedPercentage / 100));
            })
        }

        var items = [];
        groups.map((group) => {
            let months = (groupData[group.name]).months;
            months.map((item) => items.push(item))
        })
        sender.setValue("migration-plan", items);
    }

    switch ( options.name ) {
        case 'how-many-bots':
        case 'attended-percentage':
        case 'unattended-percentage':
            calculateChange();
            break;
        case 'migration-groups':
            var items = []
            if ( options.value != null ) {
                for ( var i = 0; i < options.value.length;i++ ) {
                    if ( typeof options.value[i].name === "string" && options.value[i].name.length > 0 ) {
                        items.push(options.value[i].name);
                    }
                }
            }
            let groups = sender.getQuestionByName('groups')
            if ( typeof groups !== "undefined") {
                groups.choices = items
            }
            break;
        case 'migration-times':
            calculatePlan();
            break;
        case 'sample-scenario':
            switch ( options.value ) {
                case 'migration-single-unattended':
                    sender.setValue('how-many-automation-projects', 1);
                    sender.setValue('attended-percentage', 0);
                    sender.setValue('unattended-percentage', 100);
                    var groups1 = sender.getQuestionByName('groups')
                    if ( typeof groups1 !== "undefined") {
                        groups1.choices = ['Migration']
                    }
                    sender.clearValue('migration-groups')
                    sender.setValue('migration-groups',[
                        {name: 'Migration', description: "Migrate single bot"}
                    ])
                    sender.clearValue('migration-times')
                    sender.setValue('migration-times', [ 
                        {'complexity':'low', 'service':'U_RPA_UA', 'percentage': 100, group: 'Migration', 'projectsPerMonth': 1 }
                    ]);
                    sender.clearValue('items')
                    sender.setValue('items',[{'type':'User', 'mode': 'Unattended', 'quantity':1}]);
                    break;
                case 'migration-200':
                    sender.setValue('how-many-automation-projects', 200);
                    sender.setValue('attended-percentage', 90);
                    sender.setValue('unattended-percentage', 10);
                    sender.clearValue('migration-groups')
                    var groups2 = sender.getQuestionByName('groups')
                    if ( typeof groups2 !== "undefined") {
                        groups2.choices = ['Ramp Up', 'Factory']
                    }
                    sender.setValue('migration-groups',[
                        {name: 'Ramp Up', description: "Setup migration patterns and engage business units"},
                        {name: 'Factory', description: "Wave deployment model of bots per month"},
                    ])
                    sender.clearValue('migration-times')
                    sender.setValue('migration-times', [
                        {'complexity':'low', 'percentage': 1, group: 'Ramp Up', projectsPerMonth: 2 }, 
                        {'complexity':'low', 'percentage': 59,  group: 'Factory', projectsPerMonth: 15 }, 
                        {'complexity':'medium', 'percentage': 30, group: 'Factory', projectsPerMonth: 20 },
                        {'complexity':'high', 'percentage': 10, group: 'Factory', projectsPerMonth: 2 }
                    ]),
                    sender.clearValue('items')
                    sender.setValue('items',[
                        {'type':'User', 'mode': 'Attended', 'quantity':180},
                        {'type':'User', 'mode': 'Unattended', 'quantity':20}
                    ]);
                    break;
            }
            break;
    }
}
</script>



<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='createConnection'></fluent-button></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).closest(".sv-question").parent().attr("style","")
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            if ( typeof environment !== "undefined" && environment.length > 0 ) {
                                environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                                window.open(environment)
                            }
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='downloadLink'>Downloade</fluent-button><a id='downloadData' style='display:none'></a></div>",
               activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='sendFeedback'>Udfyld spørgsmål og send feedback</a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", 'Afsendelse af feedback')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", 'Kan ikke sende feedback')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", 'Valider spørgsmål er fuldført')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('Netværksrespons var ikke ok.');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('Netværksrespons var ikke ok.');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    function startsWithFunction(params) {
        try {
            return params[0].startsWith(params[1])
        } catch {
            return false
        }
        return false
    }

    function ceilingFunction(params) {
        try {
            return Math.ceil(params[0])
        } catch {
            return ''
        }
    }

    function parseIntFunction(params) {
        try {
            return parseInt(params[0])
        } catch {
            return ''
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.FunctionFactory
            .Instance
            .register("startsWith", startsWithFunction);

        Survey.FunctionFactory
            .Instance
            .register("int", parseIntFunction)

        Survey.FunctionFactory
            .Instance
            .register("ceil", ceilingFunction)

        Survey.StylesManager.applyTheme("modern");
        
        
            var parts = "getItemPrice,getNumber".split(',');
            for ( var i = 0; i < parts.length; i++) {
                Survey.FunctionFactory.Instance.register(parts[i], window[parts[i]]);
            }            
        

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }
            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onProcessHtml.add((survey, options) => {
                if ( typeof options.html == "string" ) {
                    options.html = converter.makeHtml(options.html);
                }
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons =  true 
        
            
            questionModel.locale = "da"
            
            questionModel.completedHtml = "";
            questionModel.focusFirstQuestionAutomatic = false;
            
            $("#questions").Survey({ model: questionModel });

            if ( window.surveyChanged != null ) {
                questionModel.onValueChanged.add(window.surveyChanged)
            }
            if ( window.afterRenderQuestion != null ) {
                questionModel.onAfterRenderQuestion.add(window.afterRenderQuestion)
            }

            questionModel.currentPageNo = 0;

            

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }
            

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('Netværksrespons var ikke ok.');
                })
        }
    });
</script>


    </div>
  </div>
</article>

    
    
    <footer class="d-print-none">
    <nav class="navbar navbar-light bg-light d-flex justify-content-around">
  <div class="container pt-3">
    <div class="row d-flex justify-content-center">
      <div class="col-lg-2 col-md-6">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Produkt</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/da/releases">
              Udgivelser
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/da/frequently-asked-questions">
              Ofte stillede spørgsmål
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/da/support">
              Støtte
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/da/office-hours">
              Kontortid
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-learn">
              Opdag funktioner
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/ak4pp-issues">
              Spørgsmål
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
              Milepæle
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/releases">
              Udgivelser
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://privacy.microsoft.com/privacystatement">
              Politik om beskyttelse af personlige oplysninger
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Lære</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
              Sådan kommer du i gang
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
              Konfigurer automatiseringssættet
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
              Brug automatiseringssættet
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Blog</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-blog">
              Offentlig prøveversion
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
              Cineplex kundehistorie
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
          <h3></h3>
          <nav class="level is-mobile">
            <div class="level-left">
              <a class="level-item" rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit">
                <span class="icon"><i class="fa fa-github"></i></span>
              </a>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>

    </nav>
</footer>
    

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
</html>