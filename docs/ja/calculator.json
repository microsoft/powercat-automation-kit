{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "visibleIf": "{preview} = true",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "ja": "どのシナリオを計算しようとしていますか?"
          },
          "choices": [
            {
              "value": "calculator",
              "text": {
                "default": "Power Automate / Power Automate Desktop license cost",
                "ja": "パワーオートメーション/パワーオートメーションデスクトップライセンスコスト"
              }
            },
            {
              "value": "migration-planner",
              "text": {
                "default": "Migration planner",
                "ja": "移行プランナー"
              }
            },
            {
              "value": "samples",
              "text": {
                "default": "Sample scenarios",
                "ja": "サンプル シナリオ"
              }
            }
          ]
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "ja": "どのサンプル シナリオを検討したいですか?"
          },
          "choices": [
            {
              "value": "migration-single-unattended",
              "text": {
                "default": "Migration of a single unattended bot running isolated from other bot process",
                "ja": "他のボットプロセスから分離して実行されている単一の無人ボットの移行"
              }
            },
            {
              "value": "migration-200",
              "text": {
                "default": "Migration of hundreds of bots",
                "ja": "数百のボットの移行"
              }
            },
            {
              "value": "process-mining",
              "text": {
                "default": "Using Process Advisor to identify Process automation",
                "ja": "Process Advisorを使用してプロセスの自動化を識別する"
              }
            },
            {
              "value": "task-mining",
              "text": {
                "default": "Using Process Advisor task mining to analyze and improve bot reliability",
                "ja": "Process Advisorタスクマイニングを使用してボットの信頼性を分析および改善する"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "ja": "単一の無人ボット移行。この例では、組織は既存の自動化ソリューションをPower Platformに移行できます。デプロイされたボットは、分離された仮想ネットワークと仮想マシン (VM) ランナーでホストされます。"
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "ja": "移行パラメータ"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-automation-projects",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many automation projects to migrate?",
            "ja": "移行する自動化プロジェクトはいくつありますか?"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended automation projects?",
            "ja": "参加した自動化プロジェクトの割合は?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "ja": "0 から 100 までの値"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended automation projects?",
            "ja": "無人自動化プロジェクトの割合は?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "ja": "0 から 100 までの値"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new group",
            "ja": "新しいグループの追加"
          },
          "title": {
            "default": "Migration Groups",
            "ja": "移行グループ"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "ja": "移行グループ名"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "ja": "形容"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "ja": "グループ"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "ja": "新しいアイテムを追加する"
          },
          "title": {
            "default": "Duration Plan",
            "ja": "期間プラン"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "ja": "複雑さ"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": [
                {
                  "value": "low",
                  "text": {
                    "default": "Low",
                    "ja": "低い"
                  }
                },
                {
                  "value": "medium",
                  "text": {
                    "default": "Medium",
                    "ja": "中程度"
                  }
                },
                {
                  "value": "high",
                  "text": {
                    "default": "High",
                    "ja": "高い"
                  }
                }
              ]
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "ja": "群"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "ja": "百分率"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "projects",
              "title": {
                "default": "Projects",
                "ja": "プロジェクト"
              },
              "cellType": "expression",
              "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
            },
            {
              "name": "projectsPerMonth",
              "title": {
                "default": "Projects per month",
                "ja": "月間プロジェクト"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "ja": "合計(営業日)"
              },
              "cellType": "expression",
              "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.",
            "ja": "注: 値は説明のみを目的としており、移行する特定のプロジェクトに対して、ランプ時間、月あたりのプロジェクト数、および移行の合計営業日を決定する必要があります。"
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "ja": "可能な移行計画を自動的に計算しますか?"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "ja": "新しいアイテムを追加する"
          },
          "title": {
            "default": "Migration Plan",
            "ja": "移行計画"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "ja": "名前"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "ja": "低い"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "ja": "中程度"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "ja": "高い"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "ja": "出席"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "ja": "無人"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "ja": "各ライセンスタイプについて詳しく教えてください"
          },
          "defaultValue": true
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "ja": "詳細情報が必要なプランを選択してください"
          },
          "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "ja": "Microsoft Office 365、Microsoft Dynamics、Pay as you Goオプション、およびWindowsのシードライセンスを含むライセンスの詳細については、次のURLを参照してください。<a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>パワーオートメーションライセンスを購入する</a>"
          }
        },
        {
          "name": "includeCurrentCost",
          "title": {
            "default": "Include current costs",
            "ja": "現在のコストを含める"
          },
          "isRequired": true,
          "type": "boolean",
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "currentItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "ja": "新しいアイテムを追加する"
          },
          "visibleIf": "{includeCurrentCost}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "ja": "種類"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Makers",
                  "text": {
                    "default": "Makers",
                    "ja": "メーカー"
                  }
                },
                {
                  "value": "Licenses",
                  "text": {
                    "default": "Licenses",
                    "ja": "ライセンス"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "ja": "インフラ"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "ja": "量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "cost",
              "title": {
                "default": "Cost",
                "ja": "費用"
              },
              "isRequired": true,
              "displayStyle": "currency",
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "ja": "マンスリー"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": false,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "currentTotal",
              "title": {
                "default": "Total",
                "ja": "トータル"
              },
              "cellType": "expression",
              "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Power Platform license costs monthly",
            "ja": "Power Platformライセンス費用は毎月"
          },
          "labelTrue": "Retail price",
          "labelFalse": "Custom price",
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "ja": "新しいアイテムを追加する"
          },
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "ja": "種類"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Trial",
                  "text": {
                    "default": "Trial",
                    "ja": "裁判"
                  }
                },
                {
                  "value": "User",
                  "text": {
                    "default": "User",
                    "ja": "利用者"
                  }
                },
                {
                  "value": "Flow",
                  "text": {
                    "default": "Flow",
                    "ja": "流れる"
                  }
                },
                {
                  "value": "Extra Flow",
                  "text": {
                    "default": "Extra Flow",
                    "ja": "余分なフロー"
                  }
                }
              ]
            },
            {
              "name": "mode",
              "title": {
                "default": "Mode",
                "ja": "モード"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Attended",
                  "text": {
                    "default": "Attended",
                    "ja": "出席"
                  }
                },
                {
                  "value": "Unattended",
                  "text": {
                    "default": "Unattended",
                    "ja": "無人"
                  }
                },
                {
                  "value": "Cloud",
                  "text": {
                    "default": "Cloud",
                    "ja": "雲"
                  }
                }
              ]
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "ja": "価格"
              },
              "cellType": "expression",
              "expression": "getItemPrice()",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "customPrice",
              "title": {
                "default": "Price",
                "ja": "価格"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "ja": "量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "ja": "トータル"
              },
              "cellType": "expression",
              "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows.",
            "ja": "メモ: タイプ<b>流れる</b>5つのクラウド/RPAフローの最小注文を表します。種類<b>余分なフロー</b>最小注文レベルの 5 フローを超える単一のフローを表します。"
          }
        },
        {
          "type": "expression",
          "name": "powerPlatformCost",
          "title": {
            "default": "Power Platform license cost yearly",
            "ja": "Power Platformライセンス費用"
          },
          "expression": "{items-total.total}*12",
          "displayStyle": "currency"
        },
        {
          "name": "otherCosts",
          "type": "boolean",
          "title": {
            "default": "Include other costs",
            "ja": "その他の費用を含める"
          },
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "otherItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "ja": "新しいアイテムを追加する"
          },
          "visibleIf": "{otherCosts}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "ja": "種類"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Migration",
                  "text": {
                    "default": "Migration",
                    "ja": "移動"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "ja": "インフラ"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "ja": "量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "ja": "マンスリー"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": true,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "otherTotal",
              "title": {
                "default": "Total",
                "ja": "トータル"
              },
              "cellType": "expression",
              "expression": "{row.amount} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "expression",
          "title": {
            "default": "Difference yearly",
            "ja": "年ごとの差"
          },
          "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}