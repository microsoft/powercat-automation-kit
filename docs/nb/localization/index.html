<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<meta property="og:title" content="Lokalisering" />
<meta property="og:description" content="Automatiseringssett - Lokalisering" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/nb/localization/" /><meta property="article:section" content="" />





<meta name="description" content="Automatiseringssett for startstedet Power Platform. Definer og mål Power Automate Desktop-avkastning på investeringen, koble til læringsinnhold og kundehistorier." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

    <title>Automation Kit for Power Platform</title>
    
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.973539e55bb9a3b263afa3bea3a5c42c6bc9388ce23c69a67bf0e629f1a941a0.css" integrity="sha256-lzU55Vu5o7Jjr6O&#43;o6XELGvJOIziPGmme/DmKfGpQaA=">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">


  </head>
  <body>
    
    
    <div id="preloader">
      <div id="status"></div>
    </div>
    

    

    

<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/nb/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">

        <div class="navbar-end">
          <a href="https://microsoft.github.io/powercat-automation-kit/nb/customer-stories" class="navbar-item is-secondary">
            Kundehistorier
          </a>
          <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
            Lære
          </a>
          <a href="https://microsoft.github.io/powercat-automation-kit/nb/office-hours" class="navbar-item is-secondary">
            Kontortid
          </a>
        </div>
      </div>
  </div>
</nav>



<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/nb/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">

      <div class="navbar-end">
        <a href="https://microsoft.github.io/powercat-automation-kit/nb/customer-stories" class="navbar-item is-secondary">
          Kundehistorier
        </a>
        <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
          Lære
        </a>
        <a href="https://microsoft.github.io/powercat-automation-kit/nb/office-hours" class="navbar-item is-secondary">
          Kontortid
        </a>
      </div>
    </div>
</div>
</nav>


<section class="section is-medium">
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Lokalisering</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      <p><strong>Status:</strong> 





<img src="https://microsoft.github.io/powercat-automation-kit/1f6a7_7505262936797633741_hua137f8314abe64f9b0db7024ac7d60e8_0_16x16_resize_box_3.png" alt="Construction Icon"/> Arbeid pågår - Eksperimentell</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#fremme-inkludering-og-mangfold-i-automatiseringssettet-ved-hjelp-av-lokalisering">Fremme inkludering og mangfold i automatiseringssettet ved hjelp av lokalisering</a></li>
    <li><a href="#mål">Mål</a></li>
    <li><a href="#nåværende-tilstand">Nåværende tilstand</a></li>
    <li><a href="#veikart">Veikart</a></li>
    <li><a href="#spørsmål-og-svar">Spørsmål og svar</a>
      <ul>
        <li><a href="#spørsmål-er-det-lokaliserte-innholdet-profesjonelt-oversatt-innhold"><strong>Spørsmål:</strong> Er det lokaliserte innholdet profesjonelt oversatt innhold?</a></li>
        <li><a href="#spørsmål-hvordan-kan-jeg-forbedre-oversettelsen-for-språket-mitt"><strong>Spørsmål:</strong> Hvordan kan jeg forbedre oversettelsen for språket mitt?</a></li>
        <li><a href="#spørsmål-hva-er-relasjonen-til-microsoft-learn-innholdet"><strong>Spørsmål:</strong> Hva er relasjonen til Microsoft Learn-innholdet?</a></li>
        <li><a href="#spørsmål-kan-andre-språk-legges-til"><strong>Spørsmål:</strong> Kan andre språk legges til?</a></li>
      </ul>
    </li>
    <li><a href="#gi-tilbakemelding">Gi tilbakemelding</a></li>
  </ul>
</nav>
<h2 id="fremme-inkludering-og-mangfold-i-automatiseringssettet-ved-hjelp-av-lokalisering">Fremme inkludering og mangfold i automatiseringssettet ved hjelp av lokalisering</h2>
<style>
    .outerBorder {
        border: 1px;
        color: black;
        border-style: solid;
        margin-bottom: 10px;
    }

    .outerBorder > center {
        padding: 5px;
    }
</style>
<div class="outerBorder">
    <center>

    <img src="https://microsoft.github.io/powercat-automation-kit/images/automation-kit-localization.png" alt="Lokalisering av automatiseringssett">

    </center>
</div>

<p>Det er estimert av <a href="https://hr.un.org/unhq/languages/english">FN</a> at 1,5 milliarder mennesker snakker engelsk. Men gitt verdens befolkning er anslått til å være <a href="https://www.un.org/en/desa/world-population-reach-8-billion-15-november-2022">8 milliarder</a> innen november 2022 presenterer dette et klart behov for å støtte andre språk.</p>
<p>Power Platform Automation Kit-teamet fungerer som standard med amerikansk engelsk for innhold som ikke er en del av Microsoft Learn-plattformen. For å imøtekomme ikke-engelsktalende eksperimenterer vi med en automatisert prosess som konverterer innhold som er en del av vår automasjonsstarteropplevelse. Ved å bruke denne tilnærmingen tar vi sikte på å skalere til et bredere samfunn.</p>
<p>Det som hjelper oss som et team, er å få <a href="https://microsoft.github.io/powercat-automation-kit/nb#provide-feedback">tilbakemelding</a> fra brukerfellesskapet vårt om viktigheten av lokalisering for deg. Selv om denne tilnærmingen ikke erstatter en profesjonell oversettelsesprosess, tar vi gjerne imot tilbakemeldinger du har på opplevelsen av at lokalisering gir deg i gang og bruker automatiseringssettet. Vi ser frem til å se hvordan vi kan støtte et bredere og mer mangfoldig sett med erfaringer når vi eksperimenterer og kontinuerlig forbedrer oss over tid.</p>
<p>Vi tar sikte på å bruke disse erfaringene og bruke dem på dashbordene og applikasjonene vi produserer som en del av settet. Ved å bruke den automatiserte oversettelsesprosessen kan vi produsere innhold som du kan importere til organisasjonen din, slik at du kan støtte og pleie flerspråklig bruk av automatiseringsprosjekter over hele verden.</p>
<h2 id="mål">Mål</h2>
<p>Et av hovedmålene med Automatiseringssett for Power Platform er å støtte å være inkluderende via lokalisering av innhold. For å nå dette målet gjelder følgende:</p>
<ul>
<li>
<p>Innhold som driftes på <a href="https://aka.ms/ak4pp/starter">Startside</a> gir automatisert oversettelse via Azure Cognitive Services og tilpassede tilordninger.</p>
</li>
<li>
<p>Kjerneteamet for startnettsted vil jobbe i en-us og transformere innholdet til følgende språk:</p>
<ul>
<li><a href="https://microsoft.github.io/powercat-automation-kit/da/">Dansk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/nl/">Nederlandsk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/fr/">Fransk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/de/">Tysk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/it/">Italiensk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/ko/">Koreansk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/ja/">Japansk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/nb/">Norsk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/pl/">Polsk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/zh-hans">Forenklet kinesisk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/es/">Spansk</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/sv/">Svensk</a></li>
</ul>
</li>
<li>
<p>Gi en tilbakemeldingsmekanisme slik at det automatiserte genererte innholdet kan forbedres over tid.</p>
</li>
<li>
<p>Ta tak i problemer med lokalisering tidlig, slik at innholdet flyttes til <a href="https://aka.ms/AutomationCoE">Lær CoE-innhold for automatisering</a> innhold er allerede tilgjengelig i lokaliserte formater.</p>
</li>
<li>
<p>Bruk erfaringene fra innholdet på startnettstedet til å forbedre andre Kit-ressurser, for eksempel rapporter eller programmer for instrumentbordmaler.</p>
</li>
<li>
<p>Tillat en &ldquo;crowd source&rdquo; -modell av bidrag som tillater forbedret språktransformasjon.</p>
</li>
<li>
<p>Bruk erfaringene til å tillate språkspesifikt &ldquo;Kommunikasjonshub&rdquo;-innhold for automatiseringspakken som kan importeres til organisasjonen.</p>
</li>
</ul>
<h2 id="nåværende-tilstand">Nåværende tilstand</h2>
<ul>
<li>
<p>Støtte fra amerikansk engelsk til britisk engelsk er ennå ikke implementert</p>
</li>
<li>
<p>Standard ut av boksen Azure Cognitive Service-tekstoversettelse av kontekst for prøvespråk ovenfor</p>
</li>
</ul>
<h2 id="veikart">Veikart</h2>
<p>Vi planlegger å ta disse erfaringene og bruke dem på Power BI-instrumentbordene og Power Apps vi bruker, slik at vi som team kan skalere til automatiserte oversettelser med en tilbakemeldingssløyfe som lar oss gi bredere flerspråklig dekning over tid.</p>
<p>Du kan se vårt lokaliseringsetterslep på vår <a href="https://github.com/microsoft/powercat-automation-kit/issues?q=is%3Aopen+is%3Aissue+label%3Alocalization">GitHub-nettstedet</a>.</p>
<h2 id="spørsmål-og-svar">Spørsmål og svar</h2>
<h3 id="spørsmål-er-det-lokaliserte-innholdet-profesjonelt-oversatt-innhold"><strong>Spørsmål:</strong> Er det lokaliserte innholdet profesjonelt oversatt innhold?</h3>
<p>Nei, standardinnholdet opprettes på amerikansk engelsk og oversettes automatisk til andre språk ved hjelp av Azure Cognitive Services og tilordningstermer.</p>
<h3 id="spørsmål-hvordan-kan-jeg-forbedre-oversettelsen-for-språket-mitt"><strong>Spørsmål:</strong> Hvordan kan jeg forbedre oversettelsen for språket mitt?</h3>
<p>Vurder å gi tilbakemelding eller et bidrag for å hjelpe oss med å forbedre den lokaliserte språkversjonen din.</p>
<h3 id="spørsmål-hva-er-relasjonen-til-microsoft-learn-innholdet"><strong>Spørsmål:</strong> Hva er relasjonen til Microsoft Learn-innholdet?</h3>
<p>Innholdet på startområdet administreres av Automatiseringssett for Power Platform kun team og bidragsytere. Når innhold overføres til Microsoft Learn-plattformen, går det gjennom en egen innholdsgjennomgang og lokaliseringsprosess.</p>
<h3 id="spørsmål-kan-andre-språk-legges-til"><strong>Spørsmål:</strong> Kan andre språk legges til?</h3>
<p>Ja, hvis språket støttes av <a href="https://learn.microsoft.com/azure/cognitive-services/language-support">Språkstøtte for Azure Cognitive Service</a> så kan det legges til.</p>
<h2 id="gi-tilbakemelding">Gi tilbakemelding</h2>
<p>Hva skal du gi tilbakemelding på lokaliseringsprosessen?</p>













<script>
    
    
    data = "{\r\n  \"triggers\": [\r\n    {\r\n      \"type\": \"setvalue\",\r\n      \"expression\": \"{send-results} = true\",\r\n      \"setToName\": \"code\",\r\n      \"setValue\": \"Localization-Feedback\"\r\n    }\r\n  ],\r\n  \"pages\": [\r\n    {\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"localization-useful\",\r\n          \"title\": {\r\n            \"default\": \"Is localization of the starter content useful to you?\",\r\n            \"nb\": \"Er lokalisering av startinnholdet nyttig for deg?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"not-useful\",\r\n          \"title\": {\r\n            \"default\": \"Why was the localized content not useful for you?\",\r\n            \"nb\": \"Hvorfor var det lokaliserte innholdet ikke nyttig for deg?\"\r\n          },\r\n          \"visibleIf\": \"{localization-useful} = false\"\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"important-languages\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 9\",\r\n          \"title\": {\r\n            \"default\": \"What language(s) are most important to you for your to assist using the Automation Kit?\",\r\n            \"nb\": \"Hvilke(n) språk(er) er viktigst for at du skal kunne hjelpe deg med å bruke automatiseringssettet?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"Danish\",\r\n              \"text\": {\r\n                \"default\": \"Danish\",\r\n                \"nb\": \"Dansk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Dutch\",\r\n              \"text\": {\r\n                \"default\": \"Dutch\",\r\n                \"nb\": \"Nederlandsk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"English\",\r\n              \"text\": {\r\n                \"default\": \"English\",\r\n                \"nb\": \"Engelsk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"French\",\r\n              \"text\": {\r\n                \"default\": \"French\",\r\n                \"nb\": \"Fransk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Italian\",\r\n              \"text\": {\r\n                \"default\": \"Italian\",\r\n                \"nb\": \"Italiensk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Korean\",\r\n              \"text\": {\r\n                \"default\": \"Korean\",\r\n                \"nb\": \"Koreansk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Japanese\",\r\n              \"text\": {\r\n                \"default\": \"Japanese\",\r\n                \"nb\": \"Japansk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Norwegian\",\r\n              \"text\": {\r\n                \"default\": \"Norwegian\",\r\n                \"nb\": \"Norsk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Polish\",\r\n              \"text\": {\r\n                \"default\": \"Polish\",\r\n                \"nb\": \"Polsk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Simplified Chinese\",\r\n              \"text\": {\r\n                \"default\": \"Simplified Chinese\",\r\n                \"nb\": \"Forenklet kinesisk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Spanish\",\r\n              \"text\": {\r\n                \"default\": \"Spanish\",\r\n                \"nb\": \"Spansk\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Swedish\",\r\n              \"text\": {\r\n                \"default\": \"Swedish\",\r\n                \"nb\": \"Svensk\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"rating\",\r\n          \"name\": \"nps_score\",\r\n          \"title\": {\r\n            \"default\": \"On a scale of zero to ten, how satisfied with the translation to your language(s)?\",\r\n            \"nb\": \"På en skala fra null til ti, hvor fornøyd med oversettelsen til ditt språk (er)?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"rateMin\": 0,\r\n          \"rateMax\": 10,\r\n          \"minRateDescription\": \"(Most unsatisfied)\",\r\n          \"maxRateDescription\": \"(Most satisfied)\"\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"promoter_features\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 9\",\r\n          \"title\": {\r\n            \"default\": \"Which of the following did you value the most?\",\r\n            \"nb\": \"Hvilket av følgende verdsatte du mest?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"That a localization was available\",\r\n              \"text\": {\r\n                \"default\": \"That a localization was available\",\r\n                \"nb\": \"At en lokalisering var tilgjengelig\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to support my teams across the world\",\r\n              \"text\": {\r\n                \"default\": \"The ability to support my teams across the world\",\r\n                \"nb\": \"Muligheten til å støtte teamene mine over hele verden\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to engage with content, as English is not my first language\",\r\n              \"text\": {\r\n                \"default\": \"The ability to engage with content, as English is not my first language\",\r\n                \"nb\": \"Muligheten til å engasjere seg med innhold, da engelsk ikke er mitt morsmål\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The approach could be used to improve the Power BI dashboards and applications that are included in the Automation Kit\",\r\n              \"text\": {\r\n                \"default\": \"The approach could be used to improve the Power BI dashboards and applications that are included in the Automation Kit\",\r\n                \"nb\": \"Tilnærmingen kan brukes til å forbedre Power BI-instrumentbordene og -programmene som er inkludert i automatiseringssettet\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The approach provides me an example of how we can support automated localization of content\",\r\n              \"text\": {\r\n                \"default\": \"The approach provides me an example of how we can support automated localization of content\",\r\n                \"nb\": \"Tilnærmingen gir meg et eksempel på hvordan vi kan støtte automatisert lokalisering av innhold\"\r\n              }\r\n            }\r\n          ],\r\n          \"otherText\": \"Other features:\"\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"passive_experience\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 7  and {nps_score} \u003c= 8\",\r\n          \"title\": {\r\n            \"default\": \"What can we do to make the localized content more satisfying?\",\r\n            \"nb\": \"Hva kan vi gjøre for å gjøre det lokaliserte innholdet mer tilfredsstillende?\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"disappointing_experience\",\r\n          \"visibleIf\": \"{nps_score} \u003c= 6\",\r\n          \"title\": {\r\n            \"default\": \"Please let us know why you had such a disappointing experience with the localized content\",\r\n            \"nb\": \"Gi oss beskjed om hvorfor du hadde en så skuffende opplevelse med det lokaliserte innholdet\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"products\",\r\n          \"title\": {\r\n            \"default\": \"What is most important to you?\",\r\n            \"nb\": \"Hva er viktigst for deg?\"\r\n          },\r\n          \"isRequired\": false,\r\n          \"colCount\": 1,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"English content is good enough, I do not need a localized version\",\r\n              \"text\": {\r\n                \"default\": \"English content is good enough, I do not need a localized version\",\r\n                \"nb\": \"Engelsk innhold er godt nok, jeg trenger ikke en lokalisert versjon\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"I would rather wait until localized content is on Microsoft Learn platform\",\r\n              \"text\": {\r\n                \"default\": \"I would rather wait until localized content is on Microsoft Learn platform\",\r\n                \"nb\": \"Jeg vil heller vente til lokalisert innhold er på Microsoft Learn-plattformen\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to contribute to improve localizations\",\r\n              \"text\": {\r\n                \"default\": \"Being able to contribute to improve localizations\",\r\n                \"nb\": \"Å kunne bidra til bedre lokaliseringer\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to support ability to load localized content into my organization using the same approach\",\r\n              \"text\": {\r\n                \"default\": \"Being able to support ability to load localized content into my organization using the same approach\",\r\n                \"nb\": \"Å kunne støtte muligheten til å laste lokalisert innhold inn i organisasjonen min ved hjelp av samme tilnærming\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to customize the content for my organization and add content that is relevant to our organization\",\r\n              \"text\": {\r\n                \"default\": \"Being able to customize the content for my organization and add content that is relevant to our organization\",\r\n                \"nb\": \"Å kunne tilpasse innholdet for organisasjonen min og legge til innhold som er relevant for organisasjonen vår\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Localized images and diagrams\",\r\n              \"text\": {\r\n                \"default\": \"Localized images and diagrams\",\r\n                \"nb\": \"Lokaliserte bilder og diagrammer\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Using learnings to apply localization to Power BI dashboard\",\r\n              \"text\": {\r\n                \"default\": \"Using learnings to apply localization to Power BI dashboard\",\r\n                \"nb\": \"Bruke læring til å bruke lokalisering på Power BI-instrumentbord\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Using learnings to apply localization to Power Power Apps\",\r\n              \"text\": {\r\n                \"default\": \"Using learnings to apply localization to Power Power Apps\",\r\n                \"nb\": \"Bruke læring til å bruke lokalisering i Power Power Apps\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to have content also available as Power Point in my language so I can present it to my team\",\r\n              \"text\": {\r\n                \"default\": \"The ability to have content also available as Power Point in my language so I can present it to my team\",\r\n                \"nb\": \"Muligheten til å ha innhold også tilgjengelig som Power Point på språket mitt, slik at jeg kan presentere det for teamet mitt\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"other-feedback\",\r\n          \"title\": {\r\n            \"default\": \"Any other feedback?\",\r\n            \"nb\": \"Noen andre tilbakemeldinger?\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"send-results\",\r\n          \"title\": {\r\n            \"default\": \"Do you want to send the results of the your feedback so that the Core Automation Kit team can tailor the localization based on your responses\",\r\n            \"nb\": \"Ønsker du å sende resultatene av tilbakemeldingen din slik at Core Automation Kit-teamet kan skreddersy lokaliseringen basert på svarene dine\"\r\n          },\r\n          \"label\": {\r\n            \"default\": \"Send results?\",\r\n            \"nb\": \"Sende resultater?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results} = false\",\r\n          \"html\": {\r\n            \"default\": \"We hope these questions will help you determine an idea of topics or questions if you attend\",\r\n            \"nb\": \"Vi håper disse spørsmålene vil hjelpe deg med å bestemme en ide om emner eller spørsmål hvis du deltar\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results} = true\",\r\n          \"html\": {\r\n            \"default\": \"We look forward to getting your feedback. As a core Automation Kit team we use the feedback to improve the overview.\",\r\n            \"nb\": \"Vi ser frem til å få din tilbakemelding. Som et kjerneteam for automatiseringssett bruker vi tilbakemeldingene til å forbedre oversikten.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"feedback-task\",\r\n          \"name\": \"send-results\",\r\n          \"title\": {\r\n            \"default\": \"Send your feedback now?\",\r\n            \"nb\": \"Send tilbakemelding nå?\"\r\n          },\r\n          \"destination\": \"https://aka.ms/ak4pp-feedback2\",\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results-status.length} \u003e 0\",\r\n          \"html\": {\r\n            \"default\": \"Status: {send-results-status}\",\r\n            \"nb\": \"Status: \"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>JavaScript må være aktivert for å se dette innholdet</p>
</noscript>



<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='createConnection'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                            window.open(environment)
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='downloadLink'>Laste ned</a><a id='downloadData' style='display:none'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='sendFeedback'>Fullfør spørsmål og send tilbakemelding</a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", 'Sende tilbakemelding')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", 'Kan ikke sende tilbakemelding')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", 'Valider at spørsmålene er fullført')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('Nettverksresponsen var ikke ok.');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('Nettverksresponsen var ikke ok.');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    function startsWithFunction(params) {
        try {
            return params[0].startsWith(params[1])
        } catch {
            return false
        }
        return false
    }

    function ceilingFunction(params) {
        try {
            return Math.ceil(params[0])
        } catch {
            return ''
        }
    }

    function parseIntFunction(params) {
        try {
            return parseInt(params[0])
        } catch {
            return ''
        }
    }

    

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.FunctionFactory
            .Instance
            .register("startsWith", startsWithFunction);

        Survey.FunctionFactory
            .Instance
            .register("int", parseIntFunction)

        Survey.FunctionFactory
            .Instance
            .register("ceil", ceilingFunction)

        Survey.StylesManager.applyTheme("modern");

        

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }
            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons = "false"
        
            
            questionModel.locale = "nb"
            
            questionModel.completedHtml = "Takk for at du fullførte spørsmål";

            const targetNode = document.getElementById('preloader');
            const observer = new MutationObserver(() => {
                const element = document.getElementById("topofpage");
                element.scrollIntoView({behavior: 'smooth'})
                element.scrollTop -= 300;
            });
            const config = { attributes: true, childList: true, subtree: true };
            observer.observe(targetNode, config);
            
            $("#questions").Survey({ model: questionModel });

            if ( window.surveyChanged != null ) {
                questionModel.onValueChanged.add(window.surveyChanged)
            }
            if ( window.afterRenderQuestion != null ) {
                questionModel.onAfterRenderQuestion.add(window.afterRenderQuestion)
            }

            questionModel.currentPageNo = 0;

            

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }
            

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('Nettverksresponsen var ikke ok.');
                })
        }
    });
</script>

    </div>
  </div>
</section>



    
    
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Produkt</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/nb/releases">
                  Utgivelser
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/nb/frequently-asked-questions">
                  Faq
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/nb/support">
                  Støtte
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/nb/office-hours">
                  Kontortid
                </a>
              </li>
              <li>
                <a href="https://aka.ms/automation-kit-learn">
                  Oppdag funksjoner
                </a>
              </li>
              <li>
                <a href="https://aka.ms/ak4pp-issues">
                  Problemer
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
                  Milepæler
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/releases">
                  Utgivelser
                </a>
              </li>
              <li>
                <a href="https://privacy.microsoft.com/privacystatement">
                  Personvernpolicy
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Lære</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
                  Kom i gang
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
                  Konfigurere automatiseringssettet
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
                  Bruk automatiseringssettet
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Blogg</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://aka.ms/automation-kit-blog">
                  Offentlig forhåndsversjon
                </a>
              </li>
              <li>
                <a href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
                  Cineplex Kundehistorie
                </a>
              </li>
            </ul>
          </div>
        </div>
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
            <h3></h3>
            <nav class="level is-mobile">
              <div class="level-left">
                <a class="level-item" href="https://github.com/microsoft/powercat-automation-kit">
                  <span class="icon"><i class="fa fa-github"></i></span>
                </a>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

    

    
    <div id="backtotop"><a href="#"></a></div>

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/fresh.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/jquery.panelslider.min.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
  </body>
</html>
