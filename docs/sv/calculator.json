{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "visibleIf": "{preview} = true",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "sv": "Vilket scenario försöker du beräkna?"
          },
          "choices": [
            {
              "value": "calculator",
              "text": {
                "default": "Power Automate / Power Automate Desktop license cost",
                "sv": "Power Automate / Power Automate Desktop-licenskostnad"
              }
            },
            {
              "value": "migration-planner",
              "text": {
                "default": "Migration planner",
                "sv": "Migrering planerare"
              }
            },
            {
              "value": "samples",
              "text": {
                "default": "Sample scenarios",
                "sv": "Exempel på scenarier"
              }
            }
          ]
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "sv": "Vilket exempelscenario ville du utforska?"
          },
          "choices": [
            {
              "value": "migration-single-unattended",
              "text": {
                "default": "Migration of a single unattended bot running isolated from other bot process",
                "sv": "Migrering av en enskild obevakad robot som körs isolerad från en annan robotprocess"
              }
            },
            {
              "value": "migration-200",
              "text": {
                "default": "Migration of hundreds of bots",
                "sv": "Migrering av hundratals bots"
              }
            },
            {
              "value": "process-mining",
              "text": {
                "default": "Using Process Advisor to identify Process automation",
                "sv": "Använda Process Advisor för att identifiera processautomatisering"
              }
            },
            {
              "value": "task-mining",
              "text": {
                "default": "Using Process Advisor task mining to analyze and improve bot reliability",
                "sv": "Använda Process Advisor uppgiftsutvinning för att analysera och förbättra robotens tillförlitlighet"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "sv": "Enkel obevakad robotmigrering. I det här exemplet kanske en organisation vill migrera en befintlig automatisera, en befintlig automatiseringslösning till Power Platform. Den distribuerade roboten finns i ett isolerat virtuellt nätverk och en virtuell dator."
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "sv": "Parametrar för migrering"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-automation-projects",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many automation projects to migrate?",
            "sv": "Hur många automatiseringsprojekt ska migreras?"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended automation projects?",
            "sv": "Andel deltagande automationsprojekt?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "sv": "Ett värde mellan 0 och 100"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended automation projects?",
            "sv": "Andel obevakade automatiseringsprojekt?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "sv": "Ett värde mellan 0 och 100"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new group",
            "sv": "Lägg till ny grupp"
          },
          "title": {
            "default": "Migration Groups",
            "sv": "Migreringsgrupper"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "sv": "Namn på migreringsgrupp"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "sv": "Beskrivning"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "sv": "Grupper"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "sv": "Lägg till nytt objekt"
          },
          "title": {
            "default": "Duration Plan",
            "sv": "Varaktighet Plan"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "sv": "Komplexitet"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": [
                {
                  "value": "low",
                  "text": {
                    "default": "Low",
                    "sv": "Låg"
                  }
                },
                {
                  "value": "medium",
                  "text": {
                    "default": "Medium",
                    "sv": "Medium"
                  }
                },
                {
                  "value": "high",
                  "text": {
                    "default": "High",
                    "sv": "Hög"
                  }
                }
              ]
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "sv": "Grupp"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "sv": "Procent"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "projects",
              "title": {
                "default": "Projects",
                "sv": "Projekt"
              },
              "cellType": "expression",
              "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
            },
            {
              "name": "projectsPerMonth",
              "title": {
                "default": "Projects per month",
                "sv": "Projekt per månad"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "sv": "Totalt (arbetsdagar)"
              },
              "cellType": "expression",
              "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.",
            "sv": "Värdena är endast i illustrationssyfte och ramptid, projekt per månad och totalt antal arbetsdagar för migrering måste fastställas för de specifika projekt som migreras."
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "sv": "Beräkna möjlig migreringsplan automatiskt?"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "sv": "Lägg till nytt objekt"
          },
          "title": {
            "default": "Migration Plan",
            "sv": "Migreringsplan"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "sv": "Namn"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "sv": "Låg"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "sv": "Medium"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "sv": "Hög"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "sv": "Deltog"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "sv": "Obevakad"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "sv": "Berätta mer om varje licenstyp"
          },
          "defaultValue": true
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "sv": "Välj planer som du vill ha mer information om"
          },
          "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "sv": "Mer information om licenser som ingår seedade licenser med Microsoft Office 365, Microsoft Dynamics, betala per användning-alternativ och Windows finns på <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Köp Power Automate-licenser</a>"
          }
        },
        {
          "name": "includeCurrentCost",
          "title": {
            "default": "Include current costs",
            "sv": "Inkludera aktuella kostnader"
          },
          "isRequired": true,
          "type": "boolean",
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "currentItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "sv": "Lägg till nytt objekt"
          },
          "visibleIf": "{includeCurrentCost}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "sv": "Typ"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Makers",
                  "text": {
                    "default": "Makers",
                    "sv": "Beslutsfattare"
                  }
                },
                {
                  "value": "Licenses",
                  "text": {
                    "default": "Licenses",
                    "sv": "Licenser"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "sv": "Infrastruktur"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "sv": "Belopp"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "cost",
              "title": {
                "default": "Cost",
                "sv": "Kostnad"
              },
              "isRequired": true,
              "displayStyle": "currency",
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "sv": "Månatlig"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": false,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "currentTotal",
              "title": {
                "default": "Total",
                "sv": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Power Platform license costs monthly",
            "sv": "Power Platform licens kostar månadsvis"
          },
          "labelTrue": "Retail price",
          "labelFalse": "Custom price",
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "sv": "Lägg till nytt objekt"
          },
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "sv": "Typ"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Trial",
                  "text": {
                    "default": "Trial",
                    "sv": "Rättegång"
                  }
                },
                {
                  "value": "User",
                  "text": {
                    "default": "User",
                    "sv": "Användare"
                  }
                },
                {
                  "value": "Flow",
                  "text": {
                    "default": "Flow",
                    "sv": "Rinna"
                  }
                },
                {
                  "value": "Extra Flow",
                  "text": {
                    "default": "Extra Flow",
                    "sv": "Extra flöde"
                  }
                }
              ]
            },
            {
              "name": "mode",
              "title": {
                "default": "Mode",
                "sv": "Läge"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Attended",
                  "text": {
                    "default": "Attended",
                    "sv": "Deltog"
                  }
                },
                {
                  "value": "Unattended",
                  "text": {
                    "default": "Unattended",
                    "sv": "Obevakad"
                  }
                },
                {
                  "value": "Cloud",
                  "text": {
                    "default": "Cloud",
                    "sv": "Moln"
                  }
                }
              ]
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "sv": "Pris"
              },
              "cellType": "expression",
              "expression": "getItemPrice()",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "customPrice",
              "title": {
                "default": "Price",
                "sv": "Pris"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "sv": "Kvantitet"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "sv": "Total"
              },
              "cellType": "expression",
              "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows.",
            "sv": "OBS: Typ <b>Rinna</b> representerar minsta ordning på 5 moln- / RPA-flöden. Typ <b>Extra flöde</b> representerar ett flöde över den minsta ordernivån på 5 flöden."
          }
        },
        {
          "type": "expression",
          "name": "powerPlatformCost",
          "title": {
            "default": "Power Platform license cost yearly",
            "sv": "Power Platform licenskostnad årligen"
          },
          "expression": "{items-total.total}*12",
          "displayStyle": "currency"
        },
        {
          "name": "otherCosts",
          "type": "boolean",
          "title": {
            "default": "Include other costs",
            "sv": "Inkludera andra kostnader"
          },
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "otherItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "sv": "Lägg till nytt objekt"
          },
          "visibleIf": "{otherCosts}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "sv": "Typ"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Migration",
                  "text": {
                    "default": "Migration",
                    "sv": "Migration"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "sv": "Infrastruktur"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "sv": "Belopp"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "sv": "Månatlig"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": true,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "otherTotal",
              "title": {
                "default": "Total",
                "sv": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "expression",
          "title": {
            "default": "Difference yearly",
            "sv": "Skillnad årligen"
          },
          "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}