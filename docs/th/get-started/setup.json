{
  "checkErrorsMode": "onValueChanging",
  "pages": [
    {
      "name": "welcome",
      "title": {
        "default": "Welcome",
        "th": "ต้อนรับ"
      },
      "elements": [
        {
          "type": "checkbox",
          "name": "installType",
          "title": {
            "default": "What component(s) are you looking to setup?",
            "th": "คุณต้องการติดตั้งส่วนประกอบใด"
          },
          "isRequired": true,
          "colCount": 1,
          "choices": [
            {
              "value": "Main solution",
              "text": {
                "default": "Main solution",
                "th": "ทางออกหลัก"
              }
            },
            {
              "value": "Satellite solution",
              "text": {
                "default": "Satellite solution",
                "th": "โซลูชันดาวเทียม"
              }
            },
            {
              "value": "Data Import",
              "text": {
                "default": "Data Import",
                "th": "การนําเข้าข้อมูล"
              }
            },
            {
              "value": "Security Group Setup",
              "text": {
                "default": "Security Group Setup",
                "th": "การตั้งค่ากลุ่มความปลอดภัย"
              }
            }
          ]
        }
      ]
    },
    {
      "title": {
        "default": "Main Solution - Connections",
        "th": "โซลูชันหลัก - การเชื่อมต่อ"
      },
      "visibleIf": "contains({installType}, 'Main solution')",
      "elements": [
        {
          "type": "paneldynamic",
          "name": "main-connections",
          "title": {
            "default": "Please provide one of each of the following the connections",
            "th": "โปรดระบุหนึ่งในการเชื่อมต่อต่อไปนี้"
          },
          "minPanelCount": 5,
          "maxPanelCount": 5,
          "templateElements": [
            {
              "name": "connectionType",
              "type": "dropdown",
              "title": {
                "default": "Connection",
                "th": "การเชื่อมต่อ"
              },
              "choices": [
                {
                  "value": "Approvals",
                  "text": {
                    "default": "Approvals",
                    "th": "อนุมัติ"
                  }
                },
                {
                  "value": "Microsoft Dataverse",
                  "text": {
                    "default": "Microsoft Dataverse",
                    "th": "Microsoft Dataverse"
                  }
                },
                {
                  "value": "Office 365 Users",
                  "text": {
                    "default": "Office 365 Users",
                    "th": "ผู้ใช้สํานักงาน 365"
                  }
                },
                {
                  "value": "Office 365 Outlook",
                  "text": {
                    "default": "Office 365 Outlook",
                    "th": "แนวโน้มของ Office 365"
                  }
                },
                {
                  "value": "Power Platform for Admins Automation",
                  "text": {
                    "default": "Power Platform for Admins Automation",
                    "th": "Power Platform สําหรับระบบอัตโนมัติของผู้ดูแลระบบ"
                  }
                }
              ],
              "isRequired": true
            },
            {
              "name": "url",
              "type": "text",
              "title": {
                "default": "Connection Link",
                "th": "ลิงค์การเชื่อมต่อ"
              },
              "isRequired": true,
              "startWithNewLine": false,
              "validators": [
                {
                  "type": "regex",
                  "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                  "regex": "^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_[a-z].*/)[a-zA-Z0-9]{32,32}(/details)"
                }
              ]
            }
          ]
        },
        {
          "type": "download-task",
          "title": {
            "default": "Download results",
            "th": "ดาวน์โหลดผลลัพธ์"
          },
          "name": "downloadResults",
          "filter": "main"
        }
      ]
    }
  ]
}