{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "visibleIf": "{preview} = true",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "zh-hans": "您要计算什么方案？"
          },
          "choices": [
            {
              "value": "calculator",
              "text": {
                "default": "Power Automate / Power Automate Desktop license cost",
                "zh-hans": "电源自动化/电源自动化桌面许可证成本"
              }
            },
            {
              "value": "migration-planner",
              "text": {
                "default": "Migration planner",
                "zh-hans": "迁移规划器"
              }
            },
            {
              "value": "samples",
              "text": {
                "default": "Sample scenarios",
                "zh-hans": "示例方案"
              }
            }
          ]
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "zh-hans": "您想探索哪个示例方案？"
          },
          "choices": [
            {
              "value": "migration-single-unattended",
              "text": {
                "default": "Migration of a single unattended bot running isolated from other bot process",
                "zh-hans": "迁移与其他机器人进程隔离运行的单个无人参与机器人"
              }
            },
            {
              "value": "migration-200",
              "text": {
                "default": "Migration of hundreds of bots",
                "zh-hans": "迁移数百个机器人"
              }
            },
            {
              "value": "process-mining",
              "text": {
                "default": "Using Process Advisor to identify Process automation",
                "zh-hans": "使用Process Advisor识别流程自动化"
              }
            },
            {
              "value": "task-mining",
              "text": {
                "default": "Using Process Advisor task mining to analyze and improve bot reliability",
                "zh-hans": "使用Process Advisor任务挖掘来分析和提高机器人可靠性"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "zh-hans": "单个无人值守机器人迁移。在此示例中，组织可能希望将现有的自动化现有自动化解决方案迁移到Power Platform。部署的机器人将托管在隔离的虚拟网络和虚拟机 （VM） 运行器中。"
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "zh-hans": "迁移参数"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-automation-projects",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many automation projects to migrate?",
            "zh-hans": "要迁移多少个自动化项目？"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended automation projects?",
            "zh-hans": "参与自动化项目的百分比？"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "zh-hans": "介于 0 和 100 之间的值"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended automation projects?",
            "zh-hans": "无人值守的自动化项目的百分比？"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "zh-hans": "介于 0 和 100 之间的值"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new group",
            "zh-hans": "添加新组"
          },
          "title": {
            "default": "Migration Groups",
            "zh-hans": "迁移组"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "zh-hans": "迁移组名称"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "zh-hans": "描述"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "zh-hans": "组"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "zh-hans": "添加新项目"
          },
          "title": {
            "default": "Duration Plan",
            "zh-hans": "持续时间计划"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "zh-hans": "复杂性"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": [
                {
                  "value": "low",
                  "text": {
                    "default": "Low",
                    "zh-hans": "低"
                  }
                },
                {
                  "value": "medium",
                  "text": {
                    "default": "Medium",
                    "zh-hans": "中等"
                  }
                },
                {
                  "value": "high",
                  "text": {
                    "default": "High",
                    "zh-hans": "高"
                  }
                }
              ]
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "zh-hans": "群"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "zh-hans": "百分比"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "projects",
              "title": {
                "default": "Projects",
                "zh-hans": "项目"
              },
              "cellType": "expression",
              "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
            },
            {
              "name": "projectsPerMonth",
              "title": {
                "default": "Projects per month",
                "zh-hans": "每月项目"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "zh-hans": "总计（工作日）"
              },
              "cellType": "expression",
              "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.",
            "zh-hans": "注意：这些值仅用于说明目的，需要为要迁移的特定项目确定迁移的爬坡时间、每月项目数和总工作日。"
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "zh-hans": "自动计算可能的迁移计划？"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "zh-hans": "添加新项目"
          },
          "title": {
            "default": "Migration Plan",
            "zh-hans": "迁移计划"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "zh-hans": "名字"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "zh-hans": "低"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "zh-hans": "中等"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "zh-hans": "高"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "zh-hans": "参加"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "zh-hans": "无人 值守"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "zh-hans": "告诉我有关每种许可证类型的更多信息"
          },
          "defaultValue": true
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "zh-hans": "选择您想了解更多信息的计划"
          },
          "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "zh-hans": "有关许可证的更多详细信息，包括Microsoft Office 365，Microsoft Dynamics，Pay for you Go选项和Windows的种子许可证，请访问<a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>购买电源自动化许可证</a>"
          }
        },
        {
          "name": "includeCurrentCost",
          "title": {
            "default": "Include current costs",
            "zh-hans": "包括当前成本"
          },
          "isRequired": true,
          "type": "boolean",
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "currentItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "zh-hans": "添加新项目"
          },
          "visibleIf": "{includeCurrentCost}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "zh-hans": "类型"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Makers",
                  "text": {
                    "default": "Makers",
                    "zh-hans": "制造商"
                  }
                },
                {
                  "value": "Licenses",
                  "text": {
                    "default": "Licenses",
                    "zh-hans": "许可证"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "zh-hans": "基础设施"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "zh-hans": "量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "cost",
              "title": {
                "default": "Cost",
                "zh-hans": "成本"
              },
              "isRequired": true,
              "displayStyle": "currency",
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "zh-hans": "每月"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": false,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "currentTotal",
              "title": {
                "default": "Total",
                "zh-hans": "总"
              },
              "cellType": "expression",
              "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Power Platform license costs monthly",
            "zh-hans": "Power Platform许可证每月费用"
          },
          "labelTrue": "Retail price",
          "labelFalse": "Custom price",
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "zh-hans": "添加新项目"
          },
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "zh-hans": "类型"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Trial",
                  "text": {
                    "default": "Trial",
                    "zh-hans": "试验"
                  }
                },
                {
                  "value": "User",
                  "text": {
                    "default": "User",
                    "zh-hans": "用户"
                  }
                },
                {
                  "value": "Flow",
                  "text": {
                    "default": "Flow",
                    "zh-hans": "流"
                  }
                },
                {
                  "value": "Extra Flow",
                  "text": {
                    "default": "Extra Flow",
                    "zh-hans": "额外流量"
                  }
                }
              ]
            },
            {
              "name": "mode",
              "title": {
                "default": "Mode",
                "zh-hans": "模式"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Attended",
                  "text": {
                    "default": "Attended",
                    "zh-hans": "参加"
                  }
                },
                {
                  "value": "Unattended",
                  "text": {
                    "default": "Unattended",
                    "zh-hans": "无人 值守"
                  }
                },
                {
                  "value": "Cloud",
                  "text": {
                    "default": "Cloud",
                    "zh-hans": "云"
                  }
                }
              ]
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "zh-hans": "价格"
              },
              "cellType": "expression",
              "expression": "getItemPrice()",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "customPrice",
              "title": {
                "default": "Price",
                "zh-hans": "价格"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "zh-hans": "数量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "zh-hans": "总"
              },
              "cellType": "expression",
              "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows.",
            "zh-hans": "注：类型<b>流</b>表示 5 个云/RPA 流的最小订单。类型<b>额外流量</b>表示高于 5 个流的最低订单级别的单个流。"
          }
        },
        {
          "type": "expression",
          "name": "powerPlatformCost",
          "title": {
            "default": "Power Platform license cost yearly",
            "zh-hans": "每年Power Platform许可证费用"
          },
          "expression": "{items-total.total}*12",
          "displayStyle": "currency"
        },
        {
          "name": "otherCosts",
          "type": "boolean",
          "title": {
            "default": "Include other costs",
            "zh-hans": "包括其他费用"
          },
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "otherItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "zh-hans": "添加新项目"
          },
          "visibleIf": "{otherCosts}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "zh-hans": "类型"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Migration",
                  "text": {
                    "default": "Migration",
                    "zh-hans": "迁移"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "zh-hans": "基础设施"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "zh-hans": "量"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "zh-hans": "每月"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": true,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "otherTotal",
              "title": {
                "default": "Total",
                "zh-hans": "总"
              },
              "cellType": "expression",
              "expression": "{row.amount} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "expression",
          "title": {
            "default": "Difference yearly",
            "zh-hans": "年差额"
          },
          "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}