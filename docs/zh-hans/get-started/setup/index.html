<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<meta property="og:title" content="设置" />
<meta property="og:description" content="自动化套件 - 设置" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/zh-hans/get-started/setup/" /><meta property="article:section" content="get-started" />





<meta name="description" content="用于入门站点Power Platform自动化套件。定义和衡量 Power Automate Desktop 投资回报率，链接到学习内容和客户案例。" />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

    <title>Automation Kit for Power Platform</title>
    
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.973539e55bb9a3b263afa3bea3a5c42c6bc9388ce23c69a67bf0e629f1a941a0.css" integrity="sha256-lzU55Vu5o7Jjr6O&#43;o6XELGvJOIziPGmme/DmKfGpQaA=">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">


  </head>
  <body>
    
    
    <div id="preloader">
      <div id="status"></div>
    </div>
    

    

    

<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/zh-hans/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">

        <div class="navbar-end">
          <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/customer-stories" class="navbar-item is-secondary">
            客户案例
          </a>
          <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
            学习
          </a>
          <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/office-hours" class="navbar-item is-secondary">
            办公时间
          </a>
        </div>
      </div>
  </div>
</nav>



<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/zh-hans/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">

      <div class="navbar-end">
        <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/customer-stories" class="navbar-item is-secondary">
          客户案例
        </a>
        <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
          学习
        </a>
        <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/office-hours" class="navbar-item is-secondary">
          办公时间
        </a>
      </div>
    </div>
</div>
</nav>


<section class="section is-medium">
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">设置</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      <p>使用以下步骤可帮助您为环境创建配置，以便您可以快速安装和配置安装。</p>
<p>如果您想提供有关设置过程的任何反馈？如果是这样，您可以使用<a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/get-started/setup-feedback">设置反馈</a>页。</p>












<script>
    
    
    data = "{\r\n  \"checkErrorsMode\": \"onValueChanging\",\r\n  \"pages\": [\r\n    {\r\n      \"name\": \"welcome\",\r\n      \"title\": {\r\n        \"default\": \"Welcome\",\r\n        \"zh-hans\": \"欢迎\"\r\n      },\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"installType\",\r\n          \"title\": {\r\n            \"default\": \"What component(s) are you looking to setup?\",\r\n            \"zh-hans\": \"您要设置哪些组件？\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"colCount\": 1,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"Main solution\",\r\n              \"text\": {\r\n                \"default\": \"Main solution\",\r\n                \"zh-hans\": \"主要解决方案\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Satellite solution\",\r\n              \"text\": {\r\n                \"default\": \"Satellite solution\",\r\n                \"zh-hans\": \"卫星解决方案\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Security Group Setup\",\r\n              \"text\": {\r\n                \"default\": \"Security Group Setup\",\r\n                \"zh-hans\": \"安全组设置\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Data Import - Main Solution\",\r\n              \"text\": {\r\n                \"default\": \"Data Import - Main Solution\",\r\n                \"zh-hans\": \"数据导入 - 主要解决方案\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({installType}, 'Main solution')\",\r\n          \"html\": {\r\n            \"default\": \"Will collect connection information for Main solution deployment. The main solution manages and monitors metered Power Automate Desktop solutions. Normally there will be one Main solution deployment per Power Platform tenant\",\r\n            \"zh-hans\": \"将收集主解决方案部署的连接信息。主解决方案管理和监视按流量计费的 Power Automate 桌面解决方案。通常，每个Power Platform租户将有一个主解决方案部署\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({installType}, 'Satellite solution')\",\r\n          \"html\": {\r\n            \"default\": \"Will collect information required to setup a monitored Power Platform environment. Power Automate cloud flows to centralize information with the central main solution Automation Kit environment. Normally there will be multiple satellite solution deployments per Power Platform tenant\",\r\n            \"zh-hans\": \"将收集设置受监视Power Platform环境所需的信息。Power 自动化云端流，以使用中央主解决方案自动化工具包环境集中信息。通常，每个Power Platform租户将部署多个卫星解决方案\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({installType}, 'Security Group Setup')\",\r\n          \"html\": {\r\n            \"default\": \"Configure users / groups that should be assigned to security groups for Administration, Contribution and View permissions for Automation projects\",\r\n            \"zh-hans\": \"配置应分配给自动化项目的管理、参与和查看权限安全组的用户/组\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({installType}, 'Data Import - Main Solution')\",\r\n          \"html\": {\r\n            \"default\": \"Perform an optional import of sample Main solution data to see sample end to end data entry and monitoring dashboards\",\r\n            \"zh-hans\": \"执行示例主解决方案数据的可选导入，以查看示例端到端数据输入和监视仪表板\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Main Solution - Prerequisites\",\r\n        \"zh-hans\": \"主要解决方案 - 先决条件\"\r\n      },\r\n      \"name\": \"prereqTest1\",\r\n      \"visibleIf\": \"contains({installType}, 'Main solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"prereqTest1\",\r\n          \"title\": {\r\n            \"default\": \"Verify that the following has been setup for the environment you will install the Automation Kit Main solution\",\r\n            \"zh-hans\": \"验证是否已为将要安装自动化工具包主解决方案的环境设置以下内容\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\",\r\n              \"text\": {\r\n                \"default\": \"You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\",\r\n                \"zh-hans\": \"您具有环境管理员权限，因此我们可以启用[PowerApps 组件框架功能](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"I DO NOT have environment administrator rights\",\r\n              \"text\": {\r\n                \"default\": \"I DO NOT have environment administrator rights\",\r\n                \"zh-hans\": \"我没有环境管理员权限\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\",\r\n              \"text\": {\r\n                \"default\": \"[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\",\r\n                \"zh-hans\": \"[安装微软Power Platform命令行界面](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The environment DLP policy allows for following connectors [Approvals](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\",\r\n              \"text\": {\r\n                \"default\": \"The environment DLP policy allows for following connectors [Approvals](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\",\r\n                \"zh-hans\": \"环境 DLP 策略允许以下连接器[批准](https://learn.microsoft.com/en-us/connectors/approvals/),[微软数据节](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/),[Office 365 展望](https://learn.microsoft.com/en-us/connectors/office365/),[Office 365 用户](https://learn.microsoft.com/en-us/connectors/office365users/)和[面向管理员Power Platform](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"'Power Apps Per User', 'Per App' or 'Pays as you go' license for users who will be Administrators, Contributors or viewers of Automation Projects\",\r\n              \"text\": {\r\n                \"default\": \"'Power Apps Per User', 'Per App' or 'Pays as you go' license for users who will be Administrators, Contributors or viewers of Automation Projects\",\r\n                \"zh-hans\": \"“Power Apps 每用户”、“按应用付费”或“即用即付”许可证，适用于将成为自动化项目的管理员、参与者或查看者的用户\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Office E3 license or above for Office 365 Outlook connection used by Cloud Flow\",\r\n              \"text\": {\r\n                \"default\": \"Office E3 license or above for Office 365 Outlook connection used by Cloud Flow\",\r\n                \"zh-hans\": \"适用于 Cloud Flow 使用的 Office 365 Outlook 连接的 Office E3 许可证或更高版本\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Download of free [Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/) or [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) to share your dashboard inside your organization\",\r\n              \"text\": {\r\n                \"default\": \"Download of free [Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/) or [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) to share your dashboard inside your organization\",\r\n                \"zh-hans\": \"免费下载[Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/)或[Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/)在组织内共享仪表板\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({prereqTest1}, 'I DO NOT have environment administrator rights')\",\r\n          \"html\": {\r\n            \"default\": \"You will need to have have an environment admin enable \u003ca href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'\u003ePowerApps component framework feature\u003c/a\u003e. If you have PowerApps component framework feature enabled you do not need environment administrator rights.\",\r\n            \"zh-hans\": \"您需要启用环境管理员\u003ca href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'\u003ePowerApps 组件框架功能\u003c/a\u003e.如果启用了 PowerApps 组件框架功能，则不需要环境管理员权限。\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"isSystemCustomizer\",\r\n          \"visibleIf\": \"contains({prereqTest1}, 'I DO NOT have environment administrator rights')\",\r\n          \"title\": {\r\n            \"default\": \"Are you a member of the System Customizer role for the environment?\",\r\n            \"zh-hans\": \"您是环境的系统定制员角色的成员吗？\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({prereqTest1}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false\",\r\n          \"html\": {\r\n            \"default\": \"You will need need to have a minimum of System Customizer to import the Automation Kit solutions\",\r\n            \"zh-hans\": \"您需要至少拥有系统定制器才能导入自动化工具包解决方案\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Main Solution\",\r\n        \"zh-hans\": \"主要解决方案\"\r\n      },\r\n      \"visibleIf\": \"contains({installType}, 'Main solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"name\": \"main-instanceUrl\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy instance url\",\r\n            \"zh-hans\": \"复制实例网址\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid environment instance url like https://contoso.crm.dyanamics.com/\",\r\n                \"zh-hans\": \"必须是有效的环境实例 URL，例如[https://contoso.crm.dyanamics.com/]()\"\r\n              },\r\n              \"regex\": \"https://([-a-z0-9].*?)\\\\.crm(.*?)\\\\.dynamics\\\\.com/\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Get the instance url from \u003ca href='https://make.powerapps.com' target='blank'\u003ehttp://make.powerapps.com\u003c/a\u003e Settings -\u003e Session details dialog\",\r\n            \"zh-hans\": \"从中获取实例网址\u003ca href='https://make.powerapps.com' target='blank'\u003ehttp://make.powerapps.com\u003c/a\u003e设置 -\u003e 会话详细信息对话框\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"markdown\",\r\n          \"title\": {\r\n            \"default\": \"Installation home link Notes\",\r\n            \"zh-hans\": \"安装主页链接 注意事项\"\r\n          },\r\n          \"markdown\": \"要获取安装环境参数，请访问\u003ca href='https://make.powerapps.com' target='blank'\u003ehttp://make.powerapps.com\u003c/a\u003e选择**主页图标**对于要安装主解决方案组件的环境\"\r\n        },\r\n        {\r\n          \"name\": \"main-installEnvironment\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Install Environment home link\",\r\n            \"zh-hans\": \"复制安装环境主页链接\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform environment starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^https:\\\\/\\\\/make.powerapps.com\\\\/environments\\\\/([a-zA-Z0-9\\\\-].*?)\\\\/home\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"This environment could be the same environment as the CoE Kit.\",\r\n            \"zh-hans\": \"此环境可能与 CoE 工具包的环境相同。\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_approvals\",\r\n          \"environment\": \"main-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"main-approvalConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Approval Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制审批连接详细信息页面链接\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"startWithNewLine\": false,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_approvals/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Approvals connector is used to approve or deny Automation Project requests\",\r\n            \"zh-hans\": \"审批连接器用于批准或拒绝自动化项目请求\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_commondataserviceforapps\",\r\n          \"environment\": \"main-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"main-dataverseConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Microsoft Dataverse Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制微软数据节连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Dataverse connector is used to store your Automation Kit project and telemetry data\",\r\n            \"zh-hans\": \"Dataverse 连接器用于存储自动化工具包项目和遥测数据\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_office365\",\r\n          \"environment\": \"main-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"main-office365OutlookConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Office 365 Outlook Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制 Office 365 Outlook 连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Office 365 connector is used to send emails as part of the Automation Kit management process\",\r\n            \"zh-hans\": \"Office 365 连接器用于在自动化工具包管理过程中发送电子邮件\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_office365users\",\r\n          \"environment\": \"main-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"main-offiec365UserConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Office 365 User Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制 Office 365 用户连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Office 365 users connector is used to query user information from the Office 365 graph\",\r\n            \"zh-hans\": \"Office 365 用户连接器用于从 Office 365 图形查询用户信息\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_powerplatformforadmins\",\r\n          \"environment\": \"main-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"main-powerPlatformAdminConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Power Platform for Admins Automation Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制管理员自动化连接详细信息页面链接的Power Platform\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Power Platform for Admins Automation connector is used to query information about your deployed solutions\",\r\n            \"zh-hans\": \"管理员自动化连接器Power Platform用于查询有关已部署解决方案的信息\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Main Solution - Security Group Setup\",\r\n        \"zh-hans\": \"主要解决方案 - 安全组设置\"\r\n      },\r\n      \"visibleIf\": \"contains({installType}, 'Main solution') and contains({installType}, 'Security Group Setup')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"paneldynamic\",\r\n          \"name\": \"main-administrators\",\r\n          \"title\": {\r\n            \"default\": \"Please add Automation Kit members for the Automation Administrators Security Group\",\r\n            \"zh-hans\": \"请为自动化管理员安全组添加自动化工具包成员\"\r\n          },\r\n          \"templateElements\": [\r\n            {\r\n              \"name\": \"user\",\r\n              \"type\": \"text\",\r\n              \"inputMask\": \"email\",\r\n              \"title\": {\r\n                \"default\": \"User or group email address\",\r\n                \"zh-hans\": \"用户或组电子邮件地址\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"validators\": [\r\n                {\r\n                  \"type\": \"email\",\r\n                  \"text\": {\r\n                    \"default\": \"Value must be a valid email address\",\r\n                    \"zh-hans\": \"值必须是有效的电子邮件地址\"\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"paneldynamic\",\r\n          \"name\": \"main-contributors\",\r\n          \"title\": {\r\n            \"default\": \"Please add Automation Kit contributors that can view and edit Automation Projects\",\r\n            \"zh-hans\": \"请添加可以查看和编辑自动化项目的自动化工具包参与者\"\r\n          },\r\n          \"templateElements\": [\r\n            {\r\n              \"name\": \"user\",\r\n              \"type\": \"text\",\r\n              \"inputMask\": \"email\",\r\n              \"title\": {\r\n                \"default\": \"User or group email address\",\r\n                \"zh-hans\": \"用户或组电子邮件地址\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"validators\": [\r\n                {\r\n                  \"type\": \"email\",\r\n                  \"text\": {\r\n                    \"default\": \"Value must be a valid email address\",\r\n                    \"zh-hans\": \"值必须是有效的电子邮件地址\"\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"paneldynamic\",\r\n          \"name\": \"main-viewers\",\r\n          \"title\": {\r\n            \"default\": \"Please add Automation Kit contributors that can review and view Automation Projects\",\r\n            \"zh-hans\": \"请添加可以查看和查看自动化项目的自动化工具包参与者\"\r\n          },\r\n          \"templateElements\": [\r\n            {\r\n              \"name\": \"user\",\r\n              \"type\": \"text\",\r\n              \"title\": {\r\n                \"default\": \"User or group email address\",\r\n                \"zh-hans\": \"用户或组电子邮件地址\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"inputMask\": \"email\",\r\n              \"validators\": [\r\n                {\r\n                  \"type\": \"email\",\r\n                  \"text\": {\r\n                    \"default\": \"Value must be a valid email address\",\r\n                    \"zh-hans\": \"值必须是有效的电子邮件地址\"\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"visibleIf\": \"contains({installType}, 'Main solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Use the download button below to obtain your main configuration file that will be used to customize your deployment\",\r\n            \"zh-hans\": \"使用下面的下载按钮获取将用于自定义部署的主配置文件\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"download-task\",\r\n          \"title\": {\r\n            \"default\": \"Download results\",\r\n            \"zh-hans\": \"下载结果\"\r\n          },\r\n          \"text\": {\r\n            \"default\": \"Download\",\r\n            \"zh-hans\": \"下载\"\r\n          },\r\n          \"name\": \"downloadResults\",\r\n          \"fileName\": \"automation-kit-main-install.json\",\r\n          \"filter\": \"main\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Satellite Solution - Prerequisites\",\r\n        \"zh-hans\": \"卫星解决方案 - 先决条件\"\r\n      },\r\n      \"visibleIf\": \"contains({installType}, 'Satellite solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"prereqTest2\",\r\n          \"title\": {\r\n            \"default\": \"Verify that the following has been setup for the environment you will install the Automation Kit Satellite solution\",\r\n            \"zh-hans\": \"验证是否已为将要安装自动化工具包卫星解决方案的环境设置以下内容\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\",\r\n              \"text\": {\r\n                \"default\": \"You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\",\r\n                \"zh-hans\": \"您具有环境管理员权限，因此我们可以启用[PowerApps 组件框架功能](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"I DO NOT have environment administrator rights\",\r\n              \"text\": {\r\n                \"default\": \"I DO NOT have environment administrator rights\",\r\n                \"zh-hans\": \"我没有环境管理员权限\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\",\r\n              \"text\": {\r\n                \"default\": \"[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\",\r\n                \"zh-hans\": \"[安装微软Power Platform命令行界面](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The environment DLP policy allows for the following connectors [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (Legacy)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/), [Power Automate Management](https://learn.microsoft.com/en-us/connectors/flowmanagement/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\",\r\n              \"text\": {\r\n                \"default\": \"The environment DLP policy allows for the following connectors [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (Legacy)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/), [Power Automate Management](https://learn.microsoft.com/en-us/connectors/flowmanagement/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\",\r\n                \"zh-hans\": \"环境 DLP 策略允许以下连接器[微软数据节](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/),[Microsoft Dataverse （Legacy）](https://learn.microsoft.com/en-us/connectors/commondataservice/),[Office 365 展望](https://learn.microsoft.com/en-us/connectors/office365/),[Office 365 用户](https://learn.microsoft.com/en-us/connectors/office365users/),[电源自动化管理](https://learn.microsoft.com/en-us/connectors/flowmanagement/)和[面向管理员Power Platform](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"A Azure Application Registration\",\r\n              \"text\": {\r\n                \"default\": \"A Azure Application Registration\",\r\n                \"zh-hans\": \"Azure 应用程序注册\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Configured Azure Application API Permissions\",\r\n              \"text\": {\r\n                \"default\": \"Configured Azure Application API Permissions\",\r\n                \"zh-hans\": \"已配置的 Azure 应用程序 API 权限\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Configured Azure Application ClientId and Secret\",\r\n              \"text\": {\r\n                \"default\": \"Configured Azure Application ClientId and Secret\",\r\n                \"zh-hans\": \"已配置的 Azure 应用程序客户端 ID 和机密\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"An Azure Key Vault to store the ClientId, Secret and Tenant Id\",\r\n              \"text\": {\r\n                \"default\": \"An Azure Key Vault to store the ClientId, Secret and Tenant Id\",\r\n                \"zh-hans\": \"用于存储客户端 ID、机密和租户 ID 的 Azure 密钥保管库\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({prereqTest2}, 'I DO NOT have environment administrator rights')\",\r\n          \"html\": {\r\n            \"default\": \"You will need to have have an environment admin enable \u003ca href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'\u003ePowerApps component framework feature\u003c/a\u003e. If you have PowerApps component framework feature enabled you do not need environment administrator rights.\",\r\n            \"zh-hans\": \"您需要启用环境管理员\u003ca href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'\u003ePowerApps 组件框架功能\u003c/a\u003e.如果启用了 PowerApps 组件框架功能，则不需要环境管理员权限。\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"isSystemCustomizer\",\r\n          \"visibleIf\": \"contains({prereqTest2}, 'I DO NOT have environment administrator rights')\",\r\n          \"title\": {\r\n            \"default\": \"Are you a member of the System Customizer role for the environment?\",\r\n            \"zh-hans\": \"您是环境的系统定制员角色的成员吗？\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"contains({prereqTest2}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false\",\r\n          \"html\": {\r\n            \"default\": \"You will need need to have a minimum of System Customizer to import the Automation Kit solutions\",\r\n            \"zh-hans\": \"您需要至少拥有系统定制器才能导入自动化工具包解决方案\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Read more in \u003ca href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='blank'\u003eAutomation Kit Prerequisites\u003c/a\u003e\",\r\n            \"zh-hans\": \"阅读更多\u003ca href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='blank'\u003e自动化套件先决条件\u003c/a\u003e\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Satellite Solution - Connections\",\r\n        \"zh-hans\": \"卫星解决方案 - 连接\"\r\n      },\r\n      \"visibleIf\": \"contains({installType}, 'Satellite solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"For the install environment visit \u003ca href='https://make.powerapps.com' target='blank'\u003emake.powerapps.com\u003c/a\u003e select the home icon for your environment you want to install the Automation Kit components into\",\r\n            \"zh-hans\": \"有关安装环境，请访问\u003ca href='https://make.powerapps.com' target='blank'\u003emake.powerapps.com\u003c/a\u003e选择要将自动化工具包组件安装到的环境的主页图标\"\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"satellite-installEnvironment\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Install Environment home link\",\r\n            \"zh-hans\": \"复制安装环境主页链接\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform environment starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/home)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"\u003cb\u003eNOTE:\u003c/b\u003e This environment MUST be the different than the main environment.\",\r\n            \"zh-hans\": \"\u003cb\u003e注意：\u003c/b\u003e此环境必须与主环境不同。\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_commondataservice\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-dataverseLegacyConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Microsoft Dataverse (Legacy) Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制 Microsoft Dataverse （旧版） 连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_commondataservice/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Dataverse Legacy connector is used to connect to your main Dataverse environment\",\r\n            \"zh-hans\": \"数据节旧版连接器用于连接到主数据节环境\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_commondataserviceforapps\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-dataverseConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Microsoft Dataverse Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制微软数据节连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Dataverse connector is used to store your Automation Kit project and telemetry data\",\r\n            \"zh-hans\": \"Dataverse 连接器用于存储自动化工具包项目和遥测数据\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_flowmanagement\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-flowManagementConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Flow Management Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制流管理连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_flowmanagement/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Flow Management connector is used to query Power Automate flows in the environment\",\r\n            \"zh-hans\": \"流管理连接器用于查询环境中的电源自动化流\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_office365\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-office365OutlookConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Office 365 Outlook Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制 Office 365 Outlook 连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Office 365 connector is used to send emails as part of the Automation Kit management process\",\r\n            \"zh-hans\": \"Office 365 连接器用于在自动化工具包管理过程中发送电子邮件\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_office365users\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-office365UserConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Office 365 User Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制 Office 365 用户连接详细信息页面链接\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Office 365 users connector is used to query user information from the Office 365 graph\",\r\n            \"zh-hans\": \"Office 365 用户连接器用于从 Office 365 图形查询用户信息\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"create-connection\",\r\n          \"title\": {\r\n            \"default\": \"Create\",\r\n            \"zh-hans\": \"创造\"\r\n          },\r\n          \"connector\": \"shared_powerplatformforadmins\",\r\n          \"environment\": \"satellite-installEnvironment\"\r\n        },\r\n        {\r\n          \"name\": \"satellite-powerPlatformAdminConnection\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Copy Power Platform for Admins Automation Connection details page link here\",\r\n            \"zh-hans\": \"在此处复制管理员自动化连接详细信息页面链接的Power Platform\"\r\n          },\r\n          \"startWithNewLine\": false,\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"regex\",\r\n              \"text\": {\r\n                \"default\": \"Must be a valid Power Platform connection link starting with https://make.powerapps.com\",\r\n                \"zh-hans\": \"必须是Power Platform以 [https://make.powerapps.com]()\"\r\n              },\r\n              \"regex\": \"^(https://make.powerapps.com/environments/)[-a-zA-Z0-9]{36,36}(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"The Power Platform for Admins Automation connector is used to query information about your deployed solutions\",\r\n            \"zh-hans\": \"管理员自动化连接器Power Platform用于查询有关已部署解决方案的信息\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"title\": {\r\n        \"default\": \"Satellite Solution - Environment Variables\",\r\n        \"zh-hans\": \"卫星解决方案 - 环境变量\"\r\n      },\r\n      \"visibleIf\": \"contains({installType}, 'Satellite solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Follow [Environment Variable Setup Guide](https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/environment-variables) to obtain the values for the items below\",\r\n            \"zh-hans\": \"跟随[环境变量设置指南](https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/environment-variables)获取以下项的值\"\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"satellite-azureKeyVaultClientId\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"AKV Client Id Secret\",\r\n            \"zh-hans\": \"AKV 客户端 ID 密钥\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-azureKeyVaultClientSecret\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"AKV Client Secret Secret\",\r\n            \"zh-hans\": \"AKV 客户端密钥密钥\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-azureKeyVaultTenantIdSecret\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"AKV Tenant Id Secret\",\r\n            \"zh-hans\": \"AKV 租户 ID 机密\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-automationCoEAlertEmailRecipient\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Automation CoE Alert Email Recipient\",\r\n            \"zh-hans\": \"自动化 CoE 警报电子邮件收件人\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-automationProjectAppId\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Automation Project app Id\",\r\n            \"zh-hans\": \"自动化项目应用 ID\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-desktopFlowsBaseUrl\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Desktop Flows Base URL\",\r\n            \"zh-hans\": \"桌面流基本网址\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentId\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Id\",\r\n            \"zh-hans\": \"环境标识\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentName\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Name\",\r\n            \"zh-hans\": \"环境名称\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentRegion\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Region\",\r\n            \"zh-hans\": \"环境区域\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentUniqueName\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Unique Name\",\r\n            \"zh-hans\": \"环境唯一名称\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentUniqueNameMain\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Unique Name (Automation Kit Main)\",\r\n            \"zh-hans\": \"环境唯一名称（自动化套件主）\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-environmentUrl\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Environment Url\",\r\n            \"zh-hans\": \"环境网址\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"satellite-flowSessionTraceRecordOwnerId\",\r\n          \"type\": \"text\",\r\n          \"title\": {\r\n            \"default\": \"Flow Session Trace Record Owner Id\",\r\n            \"zh-hans\": \"流会话跟踪记录所有者 ID\"\r\n          },\r\n          \"isRequired\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"visibleIf\": \"contains({installType}, 'Satellite solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Use the download button below to obtain your satellite configuration file that will be used to customize your deployment\",\r\n            \"zh-hans\": \"使用下面的下载按钮获取将用于自定义部署的附属配置文件\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"download-task\",\r\n          \"title\": {\r\n            \"default\": \"Download results\",\r\n            \"zh-hans\": \"下载结果\"\r\n          },\r\n          \"text\": {\r\n            \"default\": \"Download\",\r\n            \"zh-hans\": \"下载\"\r\n          },\r\n          \"name\": \"downloadResults\",\r\n          \"fileName\": \"automation-kit-satellite-install.json\",\r\n          \"filter\": \"satellite\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"visibleIf\": \"contains({installType}, 'Data Import - Main Solution')\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"\u003cb\u003eNOTE:\u003c/b\u003e Use the \u003ca href='https://microsoft.github.io/powercat-automation-kit/features/datapack' target='blank'\u003eData Packs\u003c/a\u003e documentation page for guidance on how to install the main solution with sample data\",\r\n            \"zh-hans\": \"\u003cb\u003e注意：\u003c/b\u003e使用\u003ca href='https://microsoft.github.io/powercat-automation-kit/features/datapack' target='blank'\u003e数据包\u003c/a\u003e文档页面，提供有关如何使用示例数据安装主解决方案的指导\"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>必须启用 JavaScript 才能查看此内容</p>
</noscript>

<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='createConnection'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                            window.open(environment)
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='downloadLink'>下载</a><a id='downloadData' style='display:none'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='sendFeedback'>完成问题并发送反馈</a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", '发送反馈')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", '无法发送反馈')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", '验证问题是否完成')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('网络响应不正常。');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('网络响应不正常。');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.StylesManager.applyTheme("modern");

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }

            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons =  true 
        
            
            questionModel.locale = "zh-hans"
            
            questionModel.completedHtml = "感谢您完成设置步骤";

            const targetNode = document.getElementById('preloader');
            const observer = new MutationObserver(() => {
                const element = document.getElementById("topofpage");
                element.scrollIntoView({behavior: 'smooth'})
                element.scrollTop -= 300;
            });
            const config = { attributes: true, childList: true, subtree: true };
            observer.observe(targetNode, config);

            $("#questions").Survey({ model: questionModel });

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('网络响应不正常。');
                })
        }
    });
</script>

    </div>
  </div>
</section>



    
    
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>产品</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/releases">
                  释放
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/frequently-asked-questions">
                  常见问题
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/support">
                  支持
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/zh-hans/office-hours">
                  办公时间
                </a>
              </li>
              <li>
                <a href="https://aka.ms/automation-kit-learn">
                  发现功能
                </a>
              </li>
              <li>
                <a href="https://aka.ms/ak4pp-issues">
                  问题
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
                  里程碑
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/releases">
                  释放
                </a>
              </li>
              <li>
                <a href="https://privacy.microsoft.com/privacystatement">
                  隐私策略
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>学习</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
                  开始使用
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
                  配置自动化工具包
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
                  使用自动化套件
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>博客</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://aka.ms/automation-kit-blog">
                  公共预览版
                </a>
              </li>
              <li>
                <a href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
                  电影院客户案例
                </a>
              </li>
            </ul>
          </div>
        </div>
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
            <h3></h3>
            <nav class="level is-mobile">
              <div class="level-left">
                <a class="level-item" href="https://github.com/microsoft/powercat-automation-kit">
                  <span class="icon"><i class="fa fa-github"></i></span>
                </a>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

    

    
    <div id="backtotop"><a href="#"></a></div>

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/fresh.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/jquery.panelslider.min.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
  </body>
</html>
