<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<meta property="og:title" content="Calcolatrice" />
<meta property="og:description" content="Kit di automazione - Calcolatrice" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/it/calculator/" /><meta property="article:section" content="" />





<meta name="description" content="Kit di automazione per Power Platform sito iniziale. Definisci e misura il ritorno sull&#39;investimento di Power Automate Desktop, collega i contenuti di apprendimento e le storie dei clienti." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

    <title>Automation Kit for Power Platform</title>
    
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.973539e55bb9a3b263afa3bea3a5c42c6bc9388ce23c69a67bf0e629f1a941a0.css" integrity="sha256-lzU55Vu5o7Jjr6O&#43;o6XELGvJOIziPGmme/DmKfGpQaA=">
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">


  </head>
  <body>
    
    
    <div id="preloader">
      <div id="status"></div>
    </div>
    

    

    

<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/it/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">

        <div class="navbar-end">
          <a href="https://microsoft.github.io/powercat-automation-kit/it/customer-stories" class="navbar-item is-secondary">
            Storie dei clienti
          </a>
          <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
            Imparare
          </a>
          <a href="https://microsoft.github.io/powercat-automation-kit/it/office-hours" class="navbar-item is-secondary">
            Orario d&#39;ufficio
          </a>
        </div>
      </div>
  </div>
</nav>



<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/it/">
        <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">

      <div class="navbar-end">
        <a href="https://microsoft.github.io/powercat-automation-kit/it/customer-stories" class="navbar-item is-secondary">
          Storie dei clienti
        </a>
        <a href="https://aka.ms/automation-kit-learn" class="navbar-item is-secondary">
          Imparare
        </a>
        <a href="https://microsoft.github.io/powercat-automation-kit/it/office-hours" class="navbar-item is-secondary">
          Orario d&#39;ufficio
        </a>
      </div>
    </div>
</div>
</nav>


<section class="section is-medium">
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Calcolatrice</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      












<script>
    
    
    data = "{\r\n  \"showQuestionNumbers\": \"off\",\r\n  \"pages\": [\r\n    {\r\n      \"name\": \"welcome\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"radiogroup\",\r\n          \"name\": \"scenario\",\r\n          \"title\": {\r\n            \"default\": \"What scenario are you trying to calculate?\",\r\n            \"it\": \"Quale scenario stai cercando di calcolare?\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"calculator\",\r\n              \"text\": {\r\n                \"default\": \"Power Automate / Power Automate Desktop license cost\",\r\n                \"it\": \"Costo della licenza di Power Automate / Power Automate Desktop\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"migration-planner\",\r\n              \"text\": {\r\n                \"default\": \"Migration planner\",\r\n                \"it\": \"Pianificatore della migrazione\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"samples\",\r\n              \"text\": {\r\n                \"default\": \"Sample scenarios\",\r\n                \"it\": \"Scenari di esempio\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"radiogroup\",\r\n          \"name\": \"sample-scenario\",\r\n          \"visibleIf\": \"{scenario} = 'samples'\",\r\n          \"title\": {\r\n            \"default\": \"What sample scenario did you want to explore?\",\r\n            \"it\": \"Quale scenario di esempio si voleva esplorare?\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"migration-single-unattended\",\r\n              \"text\": {\r\n                \"default\": \"Migration of a single unattended bot running isolated from other bot process\",\r\n                \"it\": \"Migrazione di un singolo bot automatico in esecuzione isolato da un altro processo bot\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"migration-200\",\r\n              \"text\": {\r\n                \"default\": \"Migration of hundreds of bots\",\r\n                \"it\": \"Migrazione di centinaia di bot\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"process-mining\",\r\n              \"text\": {\r\n                \"default\": \"Using Process Advisor to identify Process automation\",\r\n                \"it\": \"Utilizzo di Process Advisor per identificare l'automazione dei processi\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"task-mining\",\r\n              \"text\": {\r\n                \"default\": \"Using Process Advisor task mining to analyze and improve bot reliability\",\r\n                \"it\": \"Utilizzo del Process Advisor task mining per analizzare e migliorare l'affidabilità dei bot\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{sample-scenario} = 'migration-single-unattended'\",\r\n          \"html\": {\r\n            \"default\": \"Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.\",\r\n            \"it\": \"Migrazione automatica di bot singoli. In questo esempio un'organizzazione potrebbe voler eseguire la migrazione di una soluzione di automazione esistente per automatizzare una soluzione di automazione esistente al Power Platform. Il bot distribuito verrà ospitato in una rete virtuale isolata e in un runner di macchine virtuali (VM).\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"migration\",\r\n      \"title\": {\r\n        \"default\": \"Migration Parameters\",\r\n        \"it\": \"Parametri di migrazione\"\r\n      },\r\n      \"visibleIf\": \"{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')\",\r\n      \"elements\": [\r\n        {\r\n          \"name\": \"how-many-bots\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"How many bots to migrate?\",\r\n            \"it\": \"Quanti bot migrare?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"name\": \"attended-percentage\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"Percentage of attended bots?\",\r\n            \"it\": \"Percentuale di bot frequentati?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"expression\",\r\n              \"text\": {\r\n                \"default\": \"A value between 0 and 100\",\r\n                \"it\": \"Un valore compreso tra 0 e 100\"\r\n              },\r\n              \"expression\": \"{attended-percentage} \u003e= 0 \u0026\u0026 {attended-percentage} \u003c= 100\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"unattended-percentage\",\r\n          \"type\": \"text\",\r\n          \"inputType\": \"number\",\r\n          \"title\": {\r\n            \"default\": \"Percentage of unattended bots?\",\r\n            \"it\": \"Percentuale di bot non presidiati?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"validators\": [\r\n            {\r\n              \"type\": \"expression\",\r\n              \"text\": {\r\n                \"default\": \"A value between 0 and 100\",\r\n                \"it\": \"Un valore compreso tra 0 e 100\"\r\n              },\r\n              \"expression\": \"{unattended-percentage} \u003e= 0 \u0026\u0026 {unattended-percentage} \u003c= 100\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-groups\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new group\",\r\n            \"it\": \"Aggiungi nuovo gruppo\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Migration Groups\",\r\n            \"it\": \"Gruppi di migrazione\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"name\",\r\n              \"title\": {\r\n                \"default\": \"Migration Group Name\",\r\n                \"it\": \"Nome del gruppo di migrazione\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            },\r\n            {\r\n              \"name\": \"description\",\r\n              \"title\": {\r\n                \"default\": \"Description\",\r\n                \"it\": \"Descrizione\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"groups\",\r\n          \"type\": \"checkbox\",\r\n          \"title\": {\r\n            \"default\": \"Groups\",\r\n            \"it\": \"Gruppi\"\r\n          },\r\n          \"visibleIf\": \"false\",\r\n          \"choices\": []\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-times\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"it\": \"Aggiungi nuovo elemento\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Duration Plan\",\r\n            \"it\": \"Piano di durata\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"complexity\",\r\n              \"title\": {\r\n                \"default\": \"Complexity\",\r\n                \"it\": \"Complessità\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"inputType\": \"count\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"low\",\r\n                  \"text\": {\r\n                    \"default\": \"Low\",\r\n                    \"it\": \"Basso\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"medium\",\r\n                  \"text\": {\r\n                    \"default\": \"Medium\",\r\n                    \"it\": \"Medio\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"high\",\r\n                  \"text\": {\r\n                    \"default\": \"High\",\r\n                    \"it\": \"Alto\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"group\",\r\n              \"title\": {\r\n                \"default\": \"Group\",\r\n                \"it\": \"Gruppo\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choicesFromQuestion\": \"groups\"\r\n            },\r\n            {\r\n              \"name\": \"percentage\",\r\n              \"title\": {\r\n                \"default\": \"Percentage\",\r\n                \"it\": \"Percentuale\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"Bots\",\r\n              \"title\": {\r\n                \"default\": \"Bots\",\r\n                \"it\": \"Bot\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"botTotal({row})\"\r\n            },\r\n            {\r\n              \"name\": \"botsPerMonth\",\r\n              \"title\": {\r\n                \"default\": \"Bots per month\",\r\n                \"it\": \"Bot al mese\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"total\",\r\n              \"title\": {\r\n                \"default\": \"Total (Business Days)\",\r\n                \"it\": \"Totale (giorni lavorativi)\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"migrationTotal({row})\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"NOTE: The values are for illustration purposes only and Ramp Time, Bots per Month and Total business days for migration will need to be determined for the specific bots being migrated.\",\r\n            \"it\": \"NOTA: i valori sono solo a scopo illustrativo e sarà necessario determinare Tempo di rampa, Bot per mese e Giorni lavorativi totali per la migrazione per i bot specifici di cui viene eseguita la migrazione.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"calc-migration-plan\",\r\n          \"title\": {\r\n            \"default\": \"Automatically calculate possible migration plan?\",\r\n            \"it\": \"Calcolare automaticamente il possibile piano di migrazione?\"\r\n          },\r\n          \"defaultValue\": true\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"migration-plan\",\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"it\": \"Aggiungi nuovo elemento\"\r\n          },\r\n          \"title\": {\r\n            \"default\": \"Migration Plan\",\r\n            \"it\": \"Piano di migrazione\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"name\",\r\n              \"title\": {\r\n                \"default\": \"Name\",\r\n                \"it\": \"Nome\"\r\n              },\r\n              \"cellType\": \"text\"\r\n            },\r\n            {\r\n              \"name\": \"low\",\r\n              \"title\": {\r\n                \"default\": \"Low\",\r\n                \"it\": \"Basso\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"medium\",\r\n              \"title\": {\r\n                \"default\": \"Medium\",\r\n                \"it\": \"Medio\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"high\",\r\n              \"title\": {\r\n                \"default\": \"High\",\r\n                \"it\": \"Alto\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"attended\",\r\n              \"title\": {\r\n                \"default\": \"Attended\",\r\n                \"it\": \"Frequentato\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            },\r\n            {\r\n              \"name\": \"unattended\",\r\n              \"title\": {\r\n                \"default\": \"Unattended\",\r\n                \"it\": \"Incustodito\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"calculation\",\r\n      \"elements\": [\r\n        {\r\n          \"name\": \"tellMeMore\",\r\n          \"type\": \"boolean\",\r\n          \"title\": {\r\n            \"default\": \"Tell me more about each license type\",\r\n            \"it\": \"Ulteriori informazioni su ciascun tipo di licenza\"\r\n          },\r\n          \"defaultValue\": false\r\n        },\r\n        {\r\n          \"name\": \"matrix-image\",\r\n          \"type\": \"image-task\",\r\n          \"visibleIf\": \"{tellMeMore} == true\",\r\n          \"title\": {\r\n            \"default\": \"Select plans you want more information on\",\r\n            \"it\": \"Seleziona i piani su cui desideri maggiori informazioni\"\r\n          },\r\n          \"src\": \"/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2\"\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at \u003ca href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'\u003eBuy Power Automate Licenses\u003c/a\u003e\",\r\n            \"it\": \"Ulteriori dettagli sulle licenze incluse le licenze seed con Microsoft Office 365, Microsoft Dynamics, opzioni Pay as you Go e Windows sono disponibili all'indirizzo \u003ca href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'\u003eAcquista licenze Power Automate\u003c/a\u003e\"\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"retailPrice\",\r\n          \"type\": \"boolean\",\r\n          \"title\": {\r\n            \"default\": \"Use retail price\",\r\n            \"it\": \"Usa il prezzo al dettaglio\"\r\n          },\r\n          \"defaultValue\": true\r\n        },\r\n        {\r\n          \"type\": \"matrixdynamic\",\r\n          \"name\": \"items\",\r\n          \"rowCount\": 1,\r\n          \"minRowCount\": 1,\r\n          \"titleLocation\": \"none\",\r\n          \"addRowText\": {\r\n            \"default\": \"Add new item\",\r\n            \"it\": \"Aggiungi nuovo elemento\"\r\n          },\r\n          \"columns\": [\r\n            {\r\n              \"name\": \"type\",\r\n              \"title\": {\r\n                \"default\": \"Type\",\r\n                \"it\": \"Digitare\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Trial\",\r\n                  \"text\": {\r\n                    \"default\": \"Trial\",\r\n                    \"it\": \"Prova\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"User\",\r\n                  \"text\": {\r\n                    \"default\": \"User\",\r\n                    \"it\": \"Utente\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Flow\",\r\n                  \"text\": {\r\n                    \"default\": \"Flow\",\r\n                    \"it\": \"Fluire\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Extra Flow\",\r\n                  \"text\": {\r\n                    \"default\": \"Extra Flow\",\r\n                    \"it\": \"Flusso extra\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"mode\",\r\n              \"title\": {\r\n                \"default\": \"Mode\",\r\n                \"it\": \"Modo\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"dropdown\",\r\n              \"choices\": [\r\n                {\r\n                  \"value\": \"Attended\",\r\n                  \"text\": {\r\n                    \"default\": \"Attended\",\r\n                    \"it\": \"Frequentato\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Unattended\",\r\n                  \"text\": {\r\n                    \"default\": \"Unattended\",\r\n                    \"it\": \"Incustodito\"\r\n                  }\r\n                },\r\n                {\r\n                  \"value\": \"Cloud\",\r\n                  \"text\": {\r\n                    \"default\": \"Cloud\",\r\n                    \"it\": \"Nuvola\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              \"name\": \"price\",\r\n              \"title\": {\r\n                \"default\": \"Price\",\r\n                \"it\": \"Prezzo\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"getItemPrice()\",\r\n              \"displayStyle\": \"currency\",\r\n              \"visibleIf\": \"{retailPrice} == true\"\r\n            },\r\n            {\r\n              \"name\": \"price-manual\",\r\n              \"title\": {\r\n                \"default\": \"Price\",\r\n                \"it\": \"Prezzo\"\r\n              },\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"displayStyle\": \"currency\",\r\n              \"visibleIf\": \"{retailPrice} == false\"\r\n            },\r\n            {\r\n              \"name\": \"quantity\",\r\n              \"title\": {\r\n                \"default\": \"Quantity\",\r\n                \"it\": \"Quantità\"\r\n              },\r\n              \"isRequired\": true,\r\n              \"cellType\": \"text\",\r\n              \"inputType\": \"number\",\r\n              \"totalType\": \"sum\",\r\n              \"totalFormat\": \"Total services: {0}\",\r\n              \"min\": 1\r\n            },\r\n            {\r\n              \"name\": \"total\",\r\n              \"title\": {\r\n                \"default\": \"Total\",\r\n                \"it\": \"Totale\"\r\n              },\r\n              \"cellType\": \"expression\",\r\n              \"expression\": \"iif({retailPrice},{row.quantity} * {row.price},{row.quantity} * {row.price-manual})\",\r\n              \"displayStyle\": \"currency\",\r\n              \"totalType\": \"sum\",\r\n              \"totalDisplayStyle\": \"currency\",\r\n              \"totalFormat\": \"Total: {0}\"\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"html\": {\r\n            \"default\": \"NOTE: Type \u003cb\u003eFlow\u003c/b\u003e represents minimum order of 5 cloud / RPA flows. Type \u003cb\u003eExtra Flow\u003c/b\u003e represents single flow above the minimum order level of 5 flows.\",\r\n            \"it\": \"NOTA: digitare \u003cb\u003eFluire\u003c/b\u003e rappresenta l'ordine minimo di 5 flussi cloud/RPA. Digitare \u003cb\u003eFlusso extra\u003c/b\u003e rappresenta un singolo flusso al di sopra del livello minimo di ordine di 5 flussi.\"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>JavaScript deve essere abilitato per visualizzare questo contenuto</p>
</noscript>


    
<script>
window.getItemPrice = getItemPrice = function (params) {
  var rowType = !!this.row
    ? this.row.getQuestionByColumnName('type')
    : null;

    var modeType = !!this.row
    ? this.row.getQuestionByColumnName('mode')
    : null;
  // if we can't find a question inside the cell (by row and column name) then return
  if (! rowType || ! modeType) 
    return 0;
  
  // get the selected item/choice
  var selectedType = rowType.selectedItem;

  if ( selectedType == null ) {
    // return 0 if a user did not select the item yet.
    return 0
  }

  var modeType = modeType.selectedItem;

  if ( modeType == null ) {
    // return 0 if a user did not select the item yet.
    return 0
  }

  switch ( selectedType.value ) {
    case "Trial":
        return 0;
    case "User":
        switch ( modeType.value ) {
            case "Attended":
                return 40;
                break;
            case "Unattended":
                return 190;
                break;
            case "Cloud":
                return 15;
            default:
                return "";
        }
        break;
    case "Flow":
        switch ( modeType.value ) {
            case "Attended":
                return "";
                break;
            case "Unattended":
                return (150 * 5) + (5 * 100);
                break;
             case "Cloud":
                return (5 * 100);
                break;
            default:
                return "";
        }
        break
    case "Extra Flow":
        switch ( modeType.value ) {
            case "Attended":
                return "";
                break;
            case "Unattended":
                return 150 + 100;
                break;
             case "Cloud":
                return 100;
                break;
        }
        break;
  }
};
window.botTotal = function(row) {
    if ( row == null || row.length == 0 || row[0] == null || row[0].percentage == null ) {
        return 0;
    }
    let bots =  window.currentSurvey.data['how-many-bots'] + 0;
    return (bots * (row[0].percentage / 100));
}
window.migrationTotal = function(row) {
     if ( row == null || row.length == 0 || row[0] == null || row[0].botsPerMonth == null ) {
      return 0;
    }
    let rowBots = botTotal(row);
    return Math.ceil((rowBots / row[0].botsPerMonth) * 20);
}
window.surveyChanged = function (sender, options) {
    window.currentSurvey = sender;
    var calculateChange = () => {
        let bots = sender.data['how-many-bots'] + 0;
        let percentAttended = sender.data['attended-percentage'] + 0;
        let percentUnattended = sender.data['unattended-percentage'] + 0;
        let attended = bots * ( percentAttended / 100);
        let unattended = bots * ( percentUnattended / 100);
        let items = [];
        if ( attended > 0 ) {
            items.push({service: 'U_RPA_A', quantity: attended})
        }
        if ( unattended > 0 ) {
            items.push({service: 'U_RPA_UA', quantity: unattended})
        }
        sender.setValue('items', items);
        calculatePlan()
    }
    var calculatePlan = () => {
        if ( sender.data['calc-migration-plan'] == false ) {
            return;
        }
        let bots = sender.data['how-many-bots'] + 0;
        let times = sender.data['migration-times']
        let attendedPercentage = sender.data['attended-percentage']
        let unattendedPercentage = sender.data['unattended-percentage']
        let groups = sender.data['migration-groups']
        if ( times == null || groups == null ) {
            return;
        }

        var groupData = {}
        for ( var i = 0; i < groups.length; i++ ) {
            groupData[groups[i].name] = {
                'name': groups[i].name,
                'months': []
            }
        }
        
        for ( var i = 0; i < times.length; i++ ) {
            if ( times[i].group == null || times[i].group.length == 0 ) {
                continue;
            }
            if ( typeof times[i].total === "undefined" ) {
                continue;
            }
            let group = groupData[times[i].group];
            let months = Math.ceil(times[i].total / 20);
           
            while ( months > group.months.length ) {
                group.months.push({
                    'name': group.name + ' ' + (group.months.length + 1),
                    'low': 0,
                    'medium': 0,
                    'high': 0,
                    'attended': 0,
                    'unattended': 0,
                })
            }

            for ( var month = 0; month < months; month++) {
                var botsMigrated = times[i].botsPerMonth
                if (month + 1 == months) {
                    if ( bots > times[i].botsPerMonth ) {
                        botsMigrated = Math.min(botsMigrated, bots - (month * times[i].botsPerMonth));
                    } else {
                        botsMigrated = bots;
                    }
                }
                switch ( times[i].complexity ) {
                    case "low":
                        group.months[month].low += botsMigrated;
                        break;
                    case "medium":
                        group.months[month].medium += botsMigrated;
                        break;
                    case "high":
                        group.months[month].high += botsMigrated;
                        break;
                }
                group.months[month].attended += Math.round(botsMigrated * (attendedPercentage / 100));
                group.months[month].unattended += Math.round(botsMigrated * (unattendedPercentage / 100));
            }
            
        }
        var items = [];
        for ( var i = 0; i < groups.length; i++ ) {
            var group = groupData[groups[i].name]
            for ( var month = 0; month < group.months.length; month++ ) {
                items.push(group.months[month]);
            }
        }
        sender.setValue('migration-plan', items);
    }
    switch ( options.name ) {
        case 'how-many-bots':
        case 'attended-percentage':
        case 'unattended-percentage':
            calculateChange();
            break;
        case 'migration-groups':
            var items = []
            if ( options.value != null ) {
                for ( var i = 0; i < options.value.length;i++ ) {
                    if ( typeof options.value[i].name === "string" && options.value[i].name.length > 0 ) {
                        items.push(options.value[i].name);
                    }
                }
            }
            let groups = sender.getQuestionByName('groups')
            if ( typeof groups !== "undefined") {
                groups.choices = items
            }
            break;
        case 'migration-times':
            calculatePlan();
            break;
        case 'sample-scenario':
            switch ( options.value ) {
                case 'migration-single-unattended':
                    sender.setValue('how-many-bots', 1);
                    sender.setValue('attended-percentage', 0);
                    sender.setValue('unattended-percentage', 100);
                    var groups1 = sender.getQuestionByName('groups')
                    if ( typeof groups1 !== "undefined") {
                        groups1.choices = ['Migration']
                    }
                    sender.clearValue('migration-groups')
                    sender.setValue('migration-groups',[
                        {name: 'Migration', description: "Migrate single bot"}
                    ])
                    sender.clearValue('migration-times')
                    sender.setValue('migration-times', [ 
                        {'complexity':'low', 'service':'U_RPA_UA', 'percentage': 100, group: 'Migration', 'botsPerMonth': 1 }
                    ]);
                    sender.clearValue('items')
                    sender.setValue('items',[{'type':'User', 'mode': 'Unattended', 'quantity':1}]);
                    break;
                case 'migration-200':
                    sender.setValue('how-many-bots', 200);
                    sender.setValue('attended-percentage', 90);
                    sender.setValue('unattended-percentage', 10);
                    sender.setValue('bots-per-month-ramp', 5);
                    sender.setValue('bots-per-month-factory', 20);
                    sender.clearValue('migration-groups')
                    var groups2 = sender.getQuestionByName('groups')
                    if ( typeof groups2 !== "undefined") {
                        groups2.choices = ['Ramp Up', 'Factory']
                    }
                    sender.setValue('migration-groups',[
                        {name: 'Ramp Up', description: "Setup migration patterns and engage business units"},
                        {name: 'Factory', description: "Wave deployment model of bots per month"},
                    ])
                    sender.clearValue('migration-times')
                    sender.setValue('migration-times', [
                        {'complexity':'low', 'percentage': 1, group: 'Ramp Up', botsPerMonth: 2 }, 
                        {'complexity':'low', 'percentage': 59,  group: 'Factory', botsPerMonth: 15 }, 
                        {'complexity':'medium', 'percentage': 30, group: 'Factory', botsPerMonth: 20 },
                        {'complexity':'high', 'percentage': 10, group: 'Factory', botsPerMonth: 2 }
                    ]),
                    sender.clearValue('items')
                    sender.setValue('items',[
                        {'type':'User', 'mode': 'Attended', 'quantity':180},
                        {'type':'User', 'mode': 'Unattended', 'quantity':20}
                    ]);
                    break;
            }
            break;
    }
}
</script>



<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='createConnection'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                            window.open(environment)
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='downloadLink'>Scaricare</a><a id='downloadData' style='display:none'></a></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='sendFeedback'>Completa le domande e invia feedback</a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", 'Invio di feedback')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", 'Impossibile inviare feedback')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", 'Convalidare le domande complete')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La risposta della rete non è stata ok.');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La risposta della rete non è stata ok.');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    function startsWithFunction(params) {
        try {
            return params[0].startsWith(params[1])
        } catch {
            return false
        }
        return false
    }

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.FunctionFactory
            .Instance
            .register("startsWith", startsWithFunction);
        Survey.StylesManager.applyTheme("modern");

        
            var parts = "getItemPrice,botTotal,migrationTotal".split(',');
            for ( var i = 0; i < parts.length; i++) {
                Survey.FunctionFactory.Instance.register(parts[i], window[parts[i]]);
            }            
        

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }
            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons =  true 
        
            
            questionModel.locale = "it"
            
            questionModel.completedHtml = "";

            const targetNode = document.getElementById('preloader');
            const observer = new MutationObserver(() => {
                const element = document.getElementById("topofpage");
                element.scrollIntoView({behavior: 'smooth'})
                element.scrollTop -= 300;
            });
            const config = { attributes: true, childList: true, subtree: true };
            observer.observe(targetNode, config);
            
            $("#questions").Survey({ model: questionModel });

            if ( window.surveyChanged != null ) {
                questionModel.onValueChanged.add(window.surveyChanged)
            }
            if ( window.afterRenderQuestion != null ) {
                questionModel.onAfterRenderQuestion.add(window.afterRenderQuestion)
            }

            questionModel.currentPageNo = 0;

            

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }
            

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('La risposta della rete non è stata ok.');
                })
        }
    });
</script>

    </div>
  </div>
</section>



    
    
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Prodotto</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/it/releases">
                  Rilascia
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/it/frequently-asked-questions">
                  Domande frequenti
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/it/support">
                  Appoggiare
                </a>
              </li>
              <li>
                <a href="https://microsoft.github.io/powercat-automation-kit/it/office-hours">
                  Orario d&#39;ufficio
                </a>
              </li>
              <li>
                <a href="https://aka.ms/automation-kit-learn">
                  Scopri le funzionalità
                </a>
              </li>
              <li>
                <a href="https://aka.ms/ak4pp-issues">
                  Problemi
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
                  Pietre miliari
                </a>
              </li>
              <li>
                <a href="https://github.com/microsoft/powercat-automation-kit/releases">
                  Rilascia
                </a>
              </li>
              <li>
                <a href="https://privacy.microsoft.com/privacystatement">
                  Informativa sulla privacy
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Imparare</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
                  Inizia subito
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
                  Configurare il kit di automazione
                </a>
              </li>
              <li>
                <a href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
                  Utilizzare il kit di automazione
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="column">
          <div class="footer-column">
            <div class="footer-header">
                <h3>Blog</h3>
            </div>
            <ul class="link-list">
              <li>
                <a href="https://aka.ms/automation-kit-blog">
                  Anteprima pubblica
                </a>
              </li>
              <li>
                <a href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
                  Storia del cliente Cineplex
                </a>
              </li>
            </ul>
          </div>
        </div>
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
            <h3></h3>
            <nav class="level is-mobile">
              <div class="level-left">
                <a class="level-item" href="https://github.com/microsoft/powercat-automation-kit">
                  <span class="icon"><i class="fa fa-github"></i></span>
                </a>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

    

    
    <div id="backtotop"><a href="#"></a></div>

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/fresh.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/jquery.panelslider.min.js"></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
  </body>
</html>
