{
  "checkErrorsMode": "onValueChanging",
  "pages": [
    {
      "name": "welcome",
      "title": {
        "default": "Welcome",
        "fr": "Bienvenue"
      },
      "elements": [
        {
          "type": "checkbox",
          "name": "installType",
          "title": {
            "default": "What component(s) are you looking to setup?",
            "fr": "Quel(s) composant(s) cherchez-vous à configurer ?"
          },
          "isRequired": true,
          "colCount": 1,
          "choices": [
            {
              "value": "Main solution",
              "text": {
                "default": "Main solution",
                "fr": "Solution principale"
              }
            },
            {
              "value": "Satellite solution",
              "text": {
                "default": "Satellite solution",
                "fr": "Solution satellite"
              }
            },
            {
              "value": "Security Group Setup",
              "text": {
                "default": "Security Group Setup",
                "fr": "Configuration du groupe de sécurité"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "contains({installType}, 'Main solution')",
          "html": {
            "default": "Will collect connection information for Main solution deployment. The main solution manages and monitors metered Power Automate Desktop solutions. Normally there will be one Main solution deployment per Power Platform tenant",
            "fr": "Collecte des informations de connexion pour le déploiement de la solution principale. La solution principale gère et surveille les solutions Power Automate Desktop mesurées. Normalement, il y aura un déploiement de solution principale par Power Platform locataire"
          }
        },
        {
          "type": "html",
          "visibleIf": "contains({installType}, 'Satellite solution')",
          "html": {
            "default": "Will collect information required to setup a monitored Power Platform environment. Power Automate cloud flows to centralize information with the central main solution Automation Kit environment. Normally there will be multiple satellite solution deployments per Power Platform tenant",
            "fr": "Recueillera les informations nécessaires à la configuration d’un environnement Power Platform surveillé. Power Automate flux cloud pour centraliser les informations avec l’environnement central de la solution principale Automation Kit. Normalement, il y aura plusieurs déploiements de solutions satellites par Power Platform locataire"
          }
        },
        {
          "type": "html",
          "visibleIf": "contains({installType}, 'Security Group Setup')",
          "html": {
            "default": "Configure users / groups that should be assigned to security groups for Administration, Contribution and View permissions for Automation projects",
            "fr": "Configurer les utilisateurs/groupes qui doivent être affectés aux groupes de sécurité pour les autorisations d’administration, de contribution et d’affichage pour les projets Automation"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Main Solution - Prerequisites",
        "fr": "Solution principale - Conditions préalables"
      },
      "name": "prereqTest1",
      "visibleIf": "contains({installType}, 'Main solution')",
      "elements": [
        {
          "type": "checkbox",
          "name": "prereqTest1",
          "title": {
            "default": "Verify that the following has been setup for the environment you will install the Automation Kit Main solution",
            "fr": "Vérifiez que les éléments suivants ont été configurés pour l’environnement dans lequel vous allez installer la solution principale du Kit d’automatisation"
          },
          "choices": [
            {
              "value": "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
              "text": {
                "default": "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
                "fr": "Vous disposez des droits d’administrateur d’environnement afin que nous puissions activer [Fonctionnalité de l’infrastructure des composants PowerApps](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)"
              }
            },
            {
              "value": "I DO NOT have environment administrator rights",
              "text": {
                "default": "I DO NOT have environment administrator rights",
                "fr": "JE N’AI PAS de droits d’administrateur d’environnement"
              }
            },
            {
              "value": "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
              "text": {
                "default": "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
                "fr": "[Installer l’interface de ligne de commande Microsoft Power Platform](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)"
              }
            },
            {
              "value": "The environment DLP policy allows for following connectors [Approvals](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
              "text": {
                "default": "The environment DLP policy allows for following connectors [Approvals](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
                "fr": "La stratégie DLP d’environnement permet les connecteurs suivants [Approbations](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Utilisateurs d’Office 365](https://learn.microsoft.com/en-us/connectors/office365users/) et [Power Platform pour les administrateurs](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)"
              }
            },
            {
              "value": "'Power Apps Per User', 'Per App' or 'Pays as you go' license for users who will be Administrators, Contributors or viewers of Automation Projects",
              "text": {
                "default": "'Power Apps Per User', 'Per App' or 'Pays as you go' license for users who will be Administrators, Contributors or viewers of Automation Projects",
                "fr": "Licence « Power Apps par utilisateur », « Par application » ou « Paiement à l’utilisation » pour les utilisateurs qui seront administrateurs, contributeurs ou utilisateurs de projets d’automatisation"
              }
            },
            {
              "value": "Office E3 license or above for Office 365 Outlook connection used by Cloud Flow",
              "text": {
                "default": "Office E3 license or above for Office 365 Outlook connection used by Cloud Flow",
                "fr": "Licence Office E3 ou supérieure pour la connexion Office 365 Outlook utilisée par Cloud Flow"
              }
            },
            {
              "value": "Download of free [Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/) or [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) to share your dashboard inside your organization",
              "text": {
                "default": "Download of free [Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/) or [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) to share your dashboard inside your organization",
                "fr": "Téléchargement gratuit [Bureau Power BI](https://powerbi.microsoft.com/en-us/desktop/) ou [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) Pour partager votre tableau de bord au sein de votre organisation"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights')",
          "html": {
            "default": "You will need to have have an environment admin enable <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>PowerApps component framework feature</a>. If you have PowerApps component framework feature enabled you do not need environment administrator rights.",
            "fr": "Vous devez avoir un administrateur d’environnement activer <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>Fonctionnalité de l’infrastructure des composants PowerApps</a>. Si la fonctionnalité PowerApps component framework est activée, vous n’avez pas besoin de droits d’administrateur d’environnement."
          }
        },
        {
          "type": "boolean",
          "name": "isSystemCustomizer",
          "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights')",
          "title": {
            "default": "Are you a member of the System Customizer role for the environment?",
            "fr": "Êtes-vous membre du rôle Personnalisateur de système pour l’environnement ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false",
          "html": {
            "default": "You will need need to have a minimum of System Customizer to import the Automation Kit solutions",
            "fr": "Vous aurez besoin d’un minimum de System Customizer pour importer les solutions Automation Kit"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Main Solution",
        "fr": "Solution principale"
      },
      "visibleIf": "contains({installType}, 'Main solution')",
      "elements": [
        {
          "name": "main-instanceUrl",
          "type": "text",
          "title": {
            "default": "Copy instance url",
            "fr": "Copier l’url de l’instance"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid environment instance url like https://contoso.crm.dyanamics.com/",
                "fr": "Doit être une URL d’instance d’environnement valide comme [https://contoso.crm.dyanamics.com/]()"
              },
              "regex": "https://([-a-z0-9].*?)\\.crm(.*?)\\.dynamics\\.com/"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "Get the instance url from <a href='https://make.powerapps.com' target='blank'>http://make.powerapps.com</a> Settings -> Session details dialog",
            "fr": "Obtenir l’URL de l’instance à partir de <a href='https://make.powerapps.com' target='blank'>http://make.powerapps.com</a> Paramètres -> Boîte de dialogue Détails de la session"
          }
        },
        {
          "type": "markdown",
          "title": {
            "default": "Installation home link Notes",
            "fr": "Lien d’accueil de l’installation Remarques"
          },
          "markdown": "Pour obtenir les paramètres de l’environnement d’installation, visitez le site <a href='https://make.powerapps.com' target='blank'>http://make.powerapps.com</a> Sélectionnez l’icône **Icône d’accueil** Pour votre environnement, vous souhaitez installer les principaux composants de la solution"
        },
        {
          "name": "main-installEnvironment",
          "type": "text",
          "title": {
            "default": "Copy Install Environment home link",
            "fr": "Copier le lien d’accueil de l’environnement d’installation"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform environment starting with https://make.powerapps.com",
                "fr": "Doit être un environnement Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^https:\\/(.*?).powerapps.com\\/environments\\/([a-zA-Z0-9\\-].*?)\\/home"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "This environment could be the same environment as the CoE Kit.",
            "fr": "Cet environnement pourrait être le même que le kit CoE."
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_approvals",
          "environment": "main-installEnvironment"
        },
        {
          "name": "main-approvalConnection",
          "type": "text",
          "title": {
            "default": "Copy Approval Connection details page link here",
            "fr": "Copier le lien de la page des détails de connexion d’approbation ici"
          },
          "isRequired": true,
          "startWithNewLine": false,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_approvals/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Approvals connector is used to approve or deny Automation Project requests",
            "fr": "Le connecteur Approbations est utilisé pour approuver ou refuser les demandes de projet d’automatisation"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_commondataserviceforapps",
          "environment": "main-installEnvironment"
        },
        {
          "name": "main-dataverseConnection",
          "type": "text",
          "title": {
            "default": "Copy Microsoft Dataverse Connection details page link here",
            "fr": "Copier le lien de la page de détails de la connexion Microsoft Dataverse ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Dataverse connector is used to store your Automation Kit project and telemetry data",
            "fr": "Le connecteur Dataverse est utilisé pour stocker votre projet Automation Kit et vos données de télémétrie"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_office365",
          "environment": "main-installEnvironment"
        },
        {
          "name": "main-office365OutlookConnection",
          "type": "text",
          "title": {
            "default": "Copy Office 365 Outlook Connection details page link here",
            "fr": "Copier le lien de la page de détails de connexion Office 365 Outlook ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Office 365 connector is used to send emails as part of the Automation Kit management process",
            "fr": "Le connecteur Office 365 est utilisé pour envoyer des e-mails dans le cadre du processus de gestion du Kit d’automatisation"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_office365users",
          "environment": "main-installEnvironment"
        },
        {
          "name": "main-office365UserConnection",
          "type": "text",
          "title": {
            "default": "Copy Office 365 User Connection details page link here",
            "fr": "Copier le lien de la page de détails de connexion utilisateur Office 365 ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Office 365 users connector is used to query user information from the Office 365 graph",
            "fr": "Le connecteur des utilisateurs Office 365 est utilisé pour interroger les informations utilisateur à partir du graphique Office 365"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_powerplatformforadmins",
          "environment": "main-installEnvironment"
        },
        {
          "name": "main-powerPlatformAdminConnection",
          "type": "text",
          "title": {
            "default": "Copy Power Platform for Admins Automation Connection details page link here",
            "fr": "Copier Power Platform pour le lien de la page de détails de la connexion Admins Automation ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Power Platform for Admins Automation connector is used to query information about your deployed solutions",
            "fr": "Le connecteur Power Platform for Admins Automation est utilisé pour interroger des informations sur vos solutions déployées"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Main Solution - Options",
        "fr": "Solution principale - Options"
      },
      "visibleIf": "contains({installType}, 'Main solution')",
      "elements": [
        {
          "type": "boolean",
          "name": "main-installSampleData",
          "isRequired": true,
          "title": {
            "default": "Import sample data after main solution is setup?",
            "fr": "Importer des exemples de données après la configuration de la solution principale ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-installSampleData} == true",
          "html": {
            "default": "Sample Corporate Goals, Automation Projects and telemetry data will be imported",
            "fr": "Des exemples d’objectifs d’entreprise, de projets d’automatisation et de données de télémétrie seront importés"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-installSampleData} == false",
          "html": {
            "default": "On base data required for solution will be imported",
            "fr": "Les données de base requises pour la solution seront importées"
          }
        },
        {
          "type": "boolean",
          "name": "main-enableROIFlow",
          "isRequired": true,
          "title": {
            "default": "Enable Return on Investment (ROI) Power Automate cloud flow?",
            "fr": "Activer le retour sur investissement (ROI) Power Automatiser le flux cloud ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableROIFlow} == true",
          "html": {
            "default": "The ROI cloud flow will be enabled so that complexity and ROI are calculated when Automation Projects are inserted or updated",
            "fr": "Le flux cloud ROI sera activé afin que la complexité et le ROI soient calculés lorsque les projets d’automatisation sont insérés ou mis à jour"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableROIFlow} == false",
          "html": {
            "default": "You can enable the ROI cloud flow after update",
            "fr": "Vous pouvez activer le flux cloud ROI après la mise à jour"
          }
        },
        {
          "type": "boolean",
          "name": "main-enableApprovalFlow",
          "isRequired": true,
          "title": {
            "default": "Enable Approval Power Automate cloud flow?",
            "fr": "Activer Approval Power Automatiser le flux cloud ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableApprovalFlow} == true",
          "html": {
            "default": "The Approval cloud flow will be enabled so that approval requests are sent to approvers",
            "fr": "Le flux de nuage d’approbation sera activé afin que les demandes d’approbation soient envoyées aux approbateurs"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableApprovalFlow} == false",
          "html": {
            "default": "You can enable the Approval cloud flow after update",
            "fr": "Vous pouvez activer le flux cloud d’approbation après la mise à jour"
          }
        },
        {
          "type": "boolean",
          "name": "main-enableSyncFlow",
          "isRequired": true,
          "title": {
            "default": "Enable Synchronization of Automation Kit data between environments?",
            "fr": "Activer la synchronisation des données du Kit d’automatisation entre les environnements ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableSyncFlow} == true",
          "html": {
            "default": "The Synchronization cloud flow will be enabled so data is sychronized with satellite environments",
            "fr": "Le flux de nuage de synchronisation sera activé afin que les données soient synchronisées avec les environnements satellitaires"
          }
        },
        {
          "type": "html",
          "visibleIf": "{main-enableSyncFlow} == false",
          "html": {
            "default": "You can enable the Synchronization cloud flow after update",
            "fr": "Vous pouvez activer le flux cloud de synchronisation après la mise à jour"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Main Solution - Security Group Setup",
        "fr": "Solution principale - Configuration du groupe de sécurité"
      },
      "visibleIf": "contains({installType}, 'Main solution') and contains({installType}, 'Security Group Setup')",
      "elements": [
        {
          "type": "paneldynamic",
          "name": "main-administrators",
          "title": {
            "default": "Please add Automation Kit members for the Automation Administrators Security Group",
            "fr": "Ajouter des membres du Kit Automation pour le groupe de sécurité Automation Administrators"
          },
          "templateElements": [
            {
              "name": "user",
              "type": "text",
              "inputMask": "email",
              "title": {
                "default": "User or group email address",
                "fr": "Adresse e-mail de l’utilisateur ou du groupe"
              },
              "isRequired": true,
              "validators": [
                {
                  "type": "email",
                  "text": {
                    "default": "Value must be a valid email address",
                    "fr": "La valeur doit être une adresse e-mail valide"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paneldynamic",
          "name": "main-contributors",
          "title": {
            "default": "Please add Automation Kit contributors that can view and edit Automation Projects",
            "fr": "Veuillez ajouter des contributeurs au Kit d’automatisation qui peuvent afficher et modifier les projets d’automatisation"
          },
          "templateElements": [
            {
              "name": "user",
              "type": "text",
              "inputMask": "email",
              "title": {
                "default": "User or group email address",
                "fr": "Adresse e-mail de l’utilisateur ou du groupe"
              },
              "isRequired": true,
              "validators": [
                {
                  "type": "email",
                  "text": {
                    "default": "Value must be a valid email address",
                    "fr": "La valeur doit être une adresse e-mail valide"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paneldynamic",
          "name": "main-viewers",
          "title": {
            "default": "Please add Automation Kit contributors that can review and view Automation Projects",
            "fr": "Veuillez ajouter des contributeurs au Kit d’automatisation qui peuvent consulter et afficher les projets d’automatisation"
          },
          "templateElements": [
            {
              "name": "user",
              "type": "text",
              "title": {
                "default": "User or group email address",
                "fr": "Adresse e-mail de l’utilisateur ou du groupe"
              },
              "isRequired": true,
              "inputMask": "email",
              "validators": [
                {
                  "type": "email",
                  "text": {
                    "default": "Value must be a valid email address",
                    "fr": "La valeur doit être une adresse e-mail valide"
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "visibleIf": "contains({installType}, 'Main solution')",
      "elements": [
        {
          "type": "html",
          "html": {
            "default": "Use the download button below to obtain your main configuration file that will be used to customize your deployment",
            "fr": "Utilisez le bouton de téléchargement ci-dessous pour obtenir votre fichier de configuration principal qui sera utilisé pour personnaliser votre déploiement"
          }
        },
        {
          "type": "download-task",
          "title": {
            "default": "Download results",
            "fr": "Télécharger les résultats"
          },
          "text": {
            "default": "Download",
            "fr": "Télécharger"
          },
          "name": "downloadResults",
          "fileName": "automation-kit-main-install.json",
          "filter": "main"
        }
      ]
    },
    {
      "title": {
        "default": "Satellite Solution - Prerequisites",
        "fr": "Solution satellite - Prérequis"
      },
      "visibleIf": "contains({installType}, 'Satellite solution')",
      "elements": [
        {
          "type": "checkbox",
          "name": "prereqTest2",
          "title": {
            "default": "Verify that the following has been setup for the environment you will install the Automation Kit Satellite solution",
            "fr": "Vérifiez que les éléments suivants ont été configurés pour l’environnement dans lequel vous allez installer la solution Automation Kit Satellite"
          },
          "choices": [
            {
              "value": "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
              "text": {
                "default": "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
                "fr": "Vous disposez des droits d’administrateur d’environnement afin que nous puissions activer [Fonctionnalité de l’infrastructure des composants PowerApps](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)"
              }
            },
            {
              "value": "I DO NOT have environment administrator rights",
              "text": {
                "default": "I DO NOT have environment administrator rights",
                "fr": "JE N’AI PAS de droits d’administrateur d’environnement"
              }
            },
            {
              "value": "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
              "text": {
                "default": "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
                "fr": "[Installer l’interface de ligne de commande Microsoft Power Platform](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)"
              }
            },
            {
              "value": "The environment DLP policy allows for the following connectors [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (Legacy)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/), [Power Automate Management](https://learn.microsoft.com/en-us/connectors/flowmanagement/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
              "text": {
                "default": "The environment DLP policy allows for the following connectors [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (Legacy)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/), [Power Automate Management](https://learn.microsoft.com/en-us/connectors/flowmanagement/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
                "fr": "La stratégie DLP d’environnement autorise les connecteurs suivants [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (hérité)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Utilisateurs d’Office 365](https://learn.microsoft.com/en-us/connectors/office365users/), [Gestion Power Automate](https://learn.microsoft.com/en-us/connectors/flowmanagement/) et [Power Platform pour les administrateurs](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)"
              }
            },
            {
              "value": "A Azure Application Registration",
              "text": {
                "default": "A Azure Application Registration",
                "fr": "Inscription d’une application Azure"
              }
            },
            {
              "value": "Configured Azure Application API Permissions",
              "text": {
                "default": "Configured Azure Application API Permissions",
                "fr": "Autorisations d’API d’application Azure configurées"
              }
            },
            {
              "value": "Configured Azure Application ClientId and Secret",
              "text": {
                "default": "Configured Azure Application ClientId and Secret",
                "fr": "Configurer l’ID client et le secret de l’application Azure"
              }
            },
            {
              "value": "An Azure Key Vault to store the ClientId, Secret and Tenant Id",
              "text": {
                "default": "An Azure Key Vault to store the ClientId, Secret and Tenant Id",
                "fr": "Un coffre de clés Azure pour stocker l’ID ClientId, le secret et l’ID de locataire"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights')",
          "html": {
            "default": "You will need to have have an environment admin enable <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>PowerApps component framework feature</a>. If you have PowerApps component framework feature enabled you do not need environment administrator rights.",
            "fr": "Vous devez avoir un administrateur d’environnement activer <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>Fonctionnalité de l’infrastructure des composants PowerApps</a>. Si la fonctionnalité PowerApps component framework est activée, vous n’avez pas besoin de droits d’administrateur d’environnement."
          }
        },
        {
          "type": "boolean",
          "name": "isSystemCustomizer",
          "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights')",
          "title": {
            "default": "Are you a member of the System Customizer role for the environment?",
            "fr": "Êtes-vous membre du rôle Personnalisateur de système pour l’environnement ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false",
          "html": {
            "default": "You will need need to have a minimum of System Customizer to import the Automation Kit solutions",
            "fr": "Vous aurez besoin d’un minimum de System Customizer pour importer les solutions Automation Kit"
          }
        },
        {
          "type": "html",
          "html": {
            "default": "Read more in <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='blank'>Automation Kit Prerequisites</a>",
            "fr": "Lire la suite dans <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='blank'>Conditions préalables du kit d’automatisation</a>"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Satellite Solution - Connections",
        "fr": "Solution satellite - Connexions"
      },
      "visibleIf": "contains({installType}, 'Satellite solution')",
      "elements": [
        {
          "type": "html",
          "html": {
            "default": "For the install environment visit <a href='https://make.powerapps.com' target='blank'>make.powerapps.com</a> select the home icon for your environment you want to install the Automation Kit components into",
            "fr": "Pour l’environnement d’installation, visitez <a href='https://make.powerapps.com' target='blank'>make.powerapps.com</a> sélectionnez l’icône d’accueil de votre environnement dans lequel vous souhaitez installer les composants du Kit d’automatisation"
          }
        },
        {
          "name": "satellite-installEnvironment",
          "type": "text",
          "title": {
            "default": "Copy Install Environment home link",
            "fr": "Copier le lien d’accueil de l’environnement d’installation"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform environment starting with https://make.powerapps.com",
                "fr": "Doit être un environnement Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/home)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "<b>NOTE:</b> This environment MUST be the different than the main environment.",
            "fr": "<b>NOTE:</b> Cet environnement DOIT être différent de l’environnement principal."
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_commondataservice",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-dataverseLegacyConnection",
          "type": "text",
          "title": {
            "default": "Copy Microsoft Dataverse (Legacy) Connection details page link here",
            "fr": "Copier le lien de la page des détails de connexion Microsoft Dataverse (hérité) ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataservice/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Dataverse Legacy connector is used to connect to your main Dataverse environment",
            "fr": "Le connecteur Dataverse Legacy est utilisé pour se connecter à votre environnement Dataverse principal"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_commondataserviceforapps",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-dataverseConnection",
          "type": "text",
          "title": {
            "default": "Copy Microsoft Dataverse Connection details page link here",
            "fr": "Copier le lien de la page de détails de la connexion Microsoft Dataverse ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Dataverse connector is used to store your Automation Kit project and telemetry data",
            "fr": "Le connecteur Dataverse est utilisé pour stocker votre projet Automation Kit et vos données de télémétrie"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_flowmanagement",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-flowManagementConnection",
          "type": "text",
          "title": {
            "default": "Copy Flow Management Connection details page link here",
            "fr": "Copier le lien de la page de détails de la connexion de gestion des flux ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_flowmanagement/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Flow Management connector is used to query Power Automate flows in the environment",
            "fr": "Le connecteur Flow Management est utilisé pour interroger les flux Power Automate dans l’environnement"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_office365",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-office365OutlookConnection",
          "type": "text",
          "title": {
            "default": "Copy Office 365 Outlook Connection details page link here",
            "fr": "Copier le lien de la page de détails de connexion Office 365 Outlook ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Office 365 connector is used to send emails as part of the Automation Kit management process",
            "fr": "Le connecteur Office 365 est utilisé pour envoyer des e-mails dans le cadre du processus de gestion du Kit d’automatisation"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_office365users",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-office365UserConnection",
          "type": "text",
          "title": {
            "default": "Copy Office 365 User Connection details page link here",
            "fr": "Copier le lien de la page de détails de connexion utilisateur Office 365 ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Office 365 users connector is used to query user information from the Office 365 graph",
            "fr": "Le connecteur des utilisateurs Office 365 est utilisé pour interroger les informations utilisateur à partir du graphique Office 365"
          }
        },
        {
          "type": "create-connection",
          "title": {
            "default": "Create",
            "fr": "Créer"
          },
          "connector": "shared_powerplatformforadmins",
          "environment": "satellite-installEnvironment"
        },
        {
          "name": "satellite-powerPlatformAdminConnection",
          "type": "text",
          "title": {
            "default": "Copy Power Platform for Admins Automation Connection details page link here",
            "fr": "Copier Power Platform pour le lien de la page de détails de la connexion Admins Automation ici"
          },
          "startWithNewLine": false,
          "isRequired": true,
          "validators": [
            {
              "type": "regex",
              "text": {
                "default": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                "fr": "Doit être un lien de connexion Power Platform valide commençant par [https://make.powerapps.com]()"
              },
              "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "The Power Platform for Admins Automation connector is used to query information about your deployed solutions",
            "fr": "Le connecteur Power Platform for Admins Automation est utilisé pour interroger des informations sur vos solutions déployées"
          }
        }
      ]
    },
    {
      "title": {
        "default": "Satellite Solution - Environment Variables",
        "fr": "Solution satellite - Variables d’environnement"
      },
      "visibleIf": "contains({installType}, 'Satellite solution')",
      "elements": [
        {
          "type": "html",
          "html": {
            "default": "Follow [Environment Variable Setup Guide](https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/environment-variables) to obtain the values for the items below",
            "fr": "Suivre [Guide de configuration des variables d’environnement](https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/environment-variables) Pour obtenir les valeurs des éléments ci-dessous"
          }
        },
        {
          "name": "satellite-azureKeyVaultClientId",
          "type": "text",
          "title": {
            "default": "AKV Client Id Secret",
            "fr": "Clé secrète de l’ID client AKV"
          },
          "isRequired": true
        },
        {
          "name": "satellite-azureKeyVaultClientSecret",
          "type": "text",
          "title": {
            "default": "AKV Client Secret Secret",
            "fr": "AKV Client Secret Secret"
          },
          "isRequired": true
        },
        {
          "name": "satellite-azureKeyVaultTenantIdSecret",
          "type": "text",
          "title": {
            "default": "AKV Tenant Id Secret",
            "fr": "Secret d’identification de locataire AKV"
          },
          "isRequired": true
        },
        {
          "name": "satellite-automationCoEAlertEmailRecipient",
          "type": "text",
          "title": {
            "default": "Automation CoE Alert Email Recipient",
            "fr": "Destinataire de l’e-mail d’alerte CoE Automation"
          },
          "isRequired": true
        },
        {
          "name": "satellite-automationProjectAppId",
          "type": "text",
          "title": {
            "default": "Automation Project app Id",
            "fr": "ID de l’application Automation Project"
          },
          "isRequired": true
        },
        {
          "name": "satellite-desktopFlowsBaseUrl",
          "type": "text",
          "title": {
            "default": "Desktop Flows Base URL",
            "fr": "Desktop Flows Base URL"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentId",
          "type": "text",
          "title": {
            "default": "Environment Id",
            "fr": "ID d’environnement"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentName",
          "type": "text",
          "title": {
            "default": "Environment Name",
            "fr": "Nom de l’environnement"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentRegion",
          "type": "text",
          "title": {
            "default": "Environment Region",
            "fr": "Région de l’environnement"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentUniqueName",
          "type": "text",
          "title": {
            "default": "Environment Unique Name",
            "fr": "Nom unique de l’environnement"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentUniqueNameMain",
          "type": "text",
          "title": {
            "default": "Environment Unique Name (Automation Kit Main)",
            "fr": "Nom unique de l’environnement (principal du kit d’automatisation)"
          },
          "isRequired": true
        },
        {
          "name": "satellite-environmentUrl",
          "type": "text",
          "title": {
            "default": "Environment Url",
            "fr": "URL de l’environnement"
          },
          "isRequired": true
        },
        {
          "name": "satellite-flowSessionTraceRecordOwnerId",
          "type": "text",
          "title": {
            "default": "Flow Session Trace Record Owner Id",
            "fr": "ID du propriétaire de l’enregistrement de suivi de session de flux"
          },
          "isRequired": true
        }
      ]
    },
    {
      "title": {
        "default": "Satellite Solution - Options",
        "fr": "Satellite Solution - Options"
      },
      "visibleIf": "contains({installType}, 'Satellite solution')",
      "elements": [
        {
          "type": "boolean",
          "name": "satellite-storeExtractScript",
          "isRequired": true,
          "title": {
            "default": "Store the extracted Power Automate Desktop script in Dataverse?",
            "fr": "Stocker le script Power Automate Desktop extrait dans Dataverse ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{satellite-storeExtractScript} == true",
          "html": {
            "default": "Will <b>store</b> Desktop flows definition script inside the Desktop Flow Definition table. This field could contain sensitive information",
            "fr": "Volonté <b>boutique</b> Script de définition de flux de bureau dans la table Desktop Flow Definition. Ce champ peut contenir des informations sensibles"
          }
        },
        {
          "type": "html",
          "visibleIf": "{satellite-storeExtractScript} == false",
          "html": {
            "default": "Will <b>NOT</b> Desktop flows definition script inside the Desktop Flow Definition table. NOTE: This field could contain sensitive information",
            "fr": "Volonté <b>NON</b> Script de définition de flux de bureau dans la table Desktop Flow Definition. Remarque : Ce champ peut contenir des informations sensibles"
          }
        },
        {
          "type": "boolean",
          "name": "satellite-enableFlows",
          "isRequired": true,
          "title": {
            "default": "Enable satellite flows?",
            "fr": "Activer les flux satellitaires ?"
          }
        },
        {
          "type": "html",
          "visibleIf": "{satellite-enableFlows} == true",
          "html": {
            "default": "Will enable Cloud flows that are included in the Automation Kit Satellite solution",
            "fr": "Activera les flux Cloud inclus dans la solution Automation Kit Satellite"
          }
        }
      ]
    },
    {
      "visibleIf": "contains({installType}, 'Satellite solution')",
      "elements": [
        {
          "type": "html",
          "html": {
            "default": "Use the download button below to obtain your satellite configuration file that will be used to customize your deployment",
            "fr": "Utilisez le bouton de téléchargement ci-dessous pour obtenir votre fichier de configuration satellite qui sera utilisé pour personnaliser votre déploiement"
          }
        },
        {
          "type": "download-task",
          "title": {
            "default": "Download results",
            "fr": "Télécharger les résultats"
          },
          "text": {
            "default": "Download",
            "fr": "Télécharger"
          },
          "name": "downloadResults",
          "fileName": "automation-kit-satellite-install.json",
          "filter": "satellite"
        }
      ]
    }
  ]
}