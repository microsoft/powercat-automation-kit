<!doctype html>
<html lang="en-us">
    <head>
        

<meta property="og:title" content="Localisation" />
<meta property="og:description" content="Kit d’automatisation - Localisation" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/fr/localization/" /><meta property="article:section" content="" />





<meta name="description" content="Kit d’automatisation pour Power Platform site de démarrage. Définissez et mesurez le retour sur investissement de Power Automate Desktop, établissez des liens vers du contenu d’apprentissage et des témoignages clients." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

        <title>Automation Kit for Power Platform</title>
        
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.900ac3346e02b249eca52c9ae838525e38bee9dc718fb9fd6cc0fbcfa923b149.css" integrity="sha256-kArDNG4CsknspSya6DhSXji&#43;6dxxj7n9bMD7z6kjsUk=">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script type="module" src="https://unpkg.com/@fluentui/web-components"></script>

    </head>
    <body>
    

    
<nav class="navbar navbar-expand-lg navbar-dark bg-gray">
    <div class="container d-flex justify-content-between">
        <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/fr/">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="56">
        </a>
        <span class="my-1 title text-black">Kit d’automatisation pour Power Platform</span>
    </div>
</nav>
<div id="topOfPage"></div>
<article>
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Localisation</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      <p><strong>Statut:</strong> 





<img src="https://microsoft.github.io/powercat-automation-kit/1f6a7_7505262936797633741_hua137f8314abe64f9b0db7024ac7d60e8_0_16x16_resize_box_3.png" alt="Construction Icon"/> Travaux en cours - Expérimentaux</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#promotion-de-linclusion-et-de-la-diversité-dans-le-kit-dautomatisation-à-laide-de-la-localisation">Promotion de l’inclusion et de la diversité dans le kit d’automatisation à l’aide de la localisation</a></li>
    <li><a href="#buts">Buts</a></li>
    <li><a href="#état-actuel">État actuel</a></li>
    <li><a href="#feuille-de-route">Feuille de route</a></li>
    <li><a href="#questions-et-réponses">Questions et réponses</a>
      <ul>
        <li><a href="#question-le-contenu-localisé-est-il-traduit-par-des-professionnels-"><strong>Question:</strong> Le contenu localisé est-il traduit par des professionnels ?</a></li>
        <li><a href="#question-comment-puis-je-améliorer-la-traduction-de-ma-langue-"><strong>Question:</strong> Comment puis-je améliorer la traduction de ma langue ?</a></li>
        <li><a href="#question-quelle-est-la-relation-avec-le-contenu-microsoft-learn-"><strong>Question:</strong> Quelle est la relation avec le contenu Microsoft Learn ?</a></li>
        <li><a href="#question-dautres-langues-peuvent-elles-être-ajoutées-"><strong>Question:</strong> D’autres langues peuvent-elles être ajoutées ?</a></li>
      </ul>
    </li>
    <li><a href="#fournir-des-commentaires">Fournir des commentaires</a></li>
  </ul>
</nav>
<h2 id="promotion-de-linclusion-et-de-la-diversité-dans-le-kit-dautomatisation-à-laide-de-la-localisation">Promotion de l’inclusion et de la diversité dans le kit d’automatisation à l’aide de la localisation</h2>
<style>
    .outerBorder {
        border: 1px;
        color: black;
        border-style: solid;
        margin-bottom: 10px;
    }

    .outerBorder > center {
        padding: 5px;
    }
</style>
<div class="outerBorder">
    <center>

    <img src="https://microsoft.github.io/powercat-automation-kit/images/automation-kit-localization.png" alt="Localisation de kits d’automatisation">

    </center>
</div>

<p>Il est estimé par le <a href="https://hr.un.org/unhq/languages/english">Organisation des Nations unies</a> que 1,5 milliard de personnes parlent anglais. Cependant, étant donné que la population mondiale est estimée à <a href="https://www.un.org/en/desa/world-population-reach-8-billion-15-november-2022">8 milliards</a> d’ici novembre 2022, cela présente un besoin évident de prendre en charge d’autres langues.</p>
<p>L’équipe du Kit d’automatisation Power Platform travaille par défaut avec l’anglais américain, pour le contenu qui ne fait pas partie de la plateforme Microsoft Learn. Pour aider à répondre aux besoins des non-anglophones, nous expérimentons un processus automatisé qui convertit le contenu qui fait partie de notre expérience de démarrage Automation. En utilisant cette approche, nous visons à nous étendre à une communauté plus large.</p>
<p>Ce qui nous aide en tant qu’équipe, c’est d’obtenir <a href="https://microsoft.github.io/powercat-automation-kit/fr#provide-feedback">rétroaction</a> de notre communauté d’utilisateurs sur l’importance de la localisation pour vous. Bien que cette approche ne remplace pas un processus de traduction professionnel, nous serions heureux de recevoir vos commentaires sur l’expérience que la localisation vous offre pour démarrer et utiliser le kit d’automatisation. Nous sommes impatients de voir comment nous pouvons soutenir un ensemble d’expériences plus large et plus diversifié à mesure que nous expérimentons et nous améliorons continuellement au fil du temps.</p>
<p>Nous visons à utiliser ces apprentissages et à les appliquer aux tableaux de bord et aux applications que nous produisons dans le cadre du kit. L’utilisation du processus de traduction automatique nous permettra de produire du contenu que vous pourrez importer dans votre organisation afin que vous puissiez soutenir et favoriser l’adoption multilingue de projets d’automatisation à travers le monde.</p>
<h2 id="buts">Buts</h2>
<p>L’un des principaux objectifs du Kit d’automatisation pour Power Platform est de soutenir l’inclusion via la localisation du contenu. Pour atteindre cet objectif, les conditions suivantes s’appliquent :</p>
<ul>
<li>
<p>Contenu hébergé sur <a href="https://aka.ms/ak4pp/starter">Site de démarrage</a> fournit une traduction automatique via Azure Cognitive Services et des mappages personnalisés.</p>
</li>
<li>
<p>L’équipe de contenu du site de démarrage de base travaillera dans en-us et transformera le contenu dans les langues suivantes:</p>
<ul>
<li><a href="https://microsoft.github.io/powercat-automation-kit/da/">Danois</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/nl/">Néerlandais</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/fr/">Français</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/de/">Allemand</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/it/">Italien</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/ko/">Coréen</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/ja/">Japonais</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/nb/">Norvégien</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/pl/">Polonais</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/zh-hans">Chinois simplifié</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/es/">Espagnol</a></li>
<li><a href="https://microsoft.github.io/powercat-automation-kit/sv/">Suédois</a></li>
</ul>
</li>
<li>
<p>Fournir un mécanisme de rétroaction pour permettre d’améliorer le contenu généré automatiquement au fil du temps.</p>
</li>
<li>
<p>Résoudre les problèmes de localisation tôt afin que le contenu soit déplacé vers <a href="https://aka.ms/AutomationCoE">Apprendre le contenu Automation CoE</a> Le contenu est déjà disponible dans des formats localisés.</p>
</li>
<li>
<p>Utilisez les enseignements tirés du contenu du site de démarrage pour améliorer d’autres ressources du Kit telles que les rapports ou les applications de modèle de tableau de bord.</p>
</li>
<li>
<p>Permettre un modèle de contributions « crowd source » qui permet d’améliorer la transformation linguistique.</p>
</li>
<li>
<p>Utilisez les apprentissages pour autoriser le contenu « Hub de communication » spécifique à la langue pour le Kit d’automatisation qui peut être importé dans votre organisation.</p>
</li>
</ul>
<h2 id="état-actuel">État actuel</h2>
<ul>
<li>
<p>La prise en charge de l’anglais américain vers l’anglais britannique n’a pas encore été mise en œuvre</p>
</li>
<li>
<p>Traduction de texte Azure Cognitive Service prête à l’emploi par défaut du contexte pour les langues d’évaluation ci-dessus</p>
</li>
</ul>
<h2 id="feuille-de-route">Feuille de route</h2>
<p>Nous prévoyons d’utiliser ces apprentissages et de les appliquer aux tableaux de bord Power BI et aux Power Apps que nous utilisons afin que notre équipe puisse évoluer vers les traductions automatiques avec une boucle de rétroaction qui nous permet de fournir une couverture multilingue plus large au fil du temps.</p>
<p>Vous pouvez consulter notre backlog de localisation sur notre <a href="https://github.com/microsoft/powercat-automation-kit/issues?q=is%3Aopen+is%3Aissue+label%3Alocalization">GitHub Site</a>.</p>
<h2 id="questions-et-réponses">Questions et réponses</h2>
<h3 id="question-le-contenu-localisé-est-il-traduit-par-des-professionnels-"><strong>Question:</strong> Le contenu localisé est-il traduit par des professionnels ?</h3>
<p>Non, le contenu par défaut est créé en anglais (États-Unis) et automatiquement traduit dans d’autres langues à l’aide d’Azure Cognitive Services et de termes de mappage.</p>
<h3 id="question-comment-puis-je-améliorer-la-traduction-de-ma-langue-"><strong>Question:</strong> Comment puis-je améliorer la traduction de ma langue ?</h3>
<p>Envisagez de nous faire part de vos commentaires ou de nous aider à améliorer votre version linguistique localisée.</p>
<h3 id="question-quelle-est-la-relation-avec-le-contenu-microsoft-learn-"><strong>Question:</strong> Quelle est la relation avec le contenu Microsoft Learn ?</h3>
<p>Le contenu du site de démarrage est géré par le Kit d’automatisation pour Power Platform Équipe et contributeurs uniquement. Lorsque le contenu migre vers la plateforme Microsoft Learn, il passe par un processus distinct de révision et de localisation du contenu.</p>
<h3 id="question-dautres-langues-peuvent-elles-être-ajoutées-"><strong>Question:</strong> D’autres langues peuvent-elles être ajoutées ?</h3>
<p>Oui, si la langue est prise en charge par <a href="https://learn.microsoft.com/azure/cognitive-services/language-support">Prise en charge linguistique d’Azure Cognitive Service</a> Ensuite, il pourrait être ajouté.</p>
<h2 id="fournir-des-commentaires">Fournir des commentaires</h2>
<p>Que fournir des commentaires sur le processus de localisation ?</p>













<script>
    
    
    data = "{\r\n  \"triggers\": [\r\n    {\r\n      \"type\": \"setvalue\",\r\n      \"expression\": \"{send-results} = true\",\r\n      \"setToName\": \"code\",\r\n      \"setValue\": \"Localization-Feedback\"\r\n    }\r\n  ],\r\n  \"pages\": [\r\n    {\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"localization-useful\",\r\n          \"title\": {\r\n            \"default\": \"Is localization of the starter content useful to you?\",\r\n            \"fr\": \"La localisation du contenu de démarrage vous est-elle utile ?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"not-useful\",\r\n          \"title\": {\r\n            \"default\": \"Why was the localized content not useful for you?\",\r\n            \"fr\": \"Pourquoi le contenu localisé ne vous a-t-il pas été utile ?\"\r\n          },\r\n          \"visibleIf\": \"{localization-useful} = false\"\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"important-languages\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 9\",\r\n          \"title\": {\r\n            \"default\": \"What language(s) are most important to you for your to assist using the Automation Kit?\",\r\n            \"fr\": \"Quelle(s) langue(s) est (sont) la (les) plus importante(s) pour vous aider à utiliser le kit d’automatisation ?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"Danish\",\r\n              \"text\": {\r\n                \"default\": \"Danish\",\r\n                \"fr\": \"Danois\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Dutch\",\r\n              \"text\": {\r\n                \"default\": \"Dutch\",\r\n                \"fr\": \"Néerlandais\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"English\",\r\n              \"text\": {\r\n                \"default\": \"English\",\r\n                \"fr\": \"Anglais\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"French\",\r\n              \"text\": {\r\n                \"default\": \"French\",\r\n                \"fr\": \"Français\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Italian\",\r\n              \"text\": {\r\n                \"default\": \"Italian\",\r\n                \"fr\": \"Italien\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Korean\",\r\n              \"text\": {\r\n                \"default\": \"Korean\",\r\n                \"fr\": \"Coréen\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Japanese\",\r\n              \"text\": {\r\n                \"default\": \"Japanese\",\r\n                \"fr\": \"Japonais\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Norwegian\",\r\n              \"text\": {\r\n                \"default\": \"Norwegian\",\r\n                \"fr\": \"Norvégien\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Polish\",\r\n              \"text\": {\r\n                \"default\": \"Polish\",\r\n                \"fr\": \"Polonais\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Simplified Chinese\",\r\n              \"text\": {\r\n                \"default\": \"Simplified Chinese\",\r\n                \"fr\": \"Chinois simplifié\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Spanish\",\r\n              \"text\": {\r\n                \"default\": \"Spanish\",\r\n                \"fr\": \"Espagnol\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Swedish\",\r\n              \"text\": {\r\n                \"default\": \"Swedish\",\r\n                \"fr\": \"Suédois\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"rating\",\r\n          \"name\": \"nps_score\",\r\n          \"title\": {\r\n            \"default\": \"On a scale of zero to ten, how satisfied with the translation to your language(s)?\",\r\n            \"fr\": \"Sur une échelle de zéro à dix, dans quelle mesure êtes-vous satisfait de la traduction dans votre (vos) langue(s) ?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"rateMin\": 0,\r\n          \"rateMax\": 10,\r\n          \"minRateDescription\": \"(Most unsatisfied)\",\r\n          \"maxRateDescription\": \"(Most satisfied)\"\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"promoter_features\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 9\",\r\n          \"title\": {\r\n            \"default\": \"Which of the following did you value the most?\",\r\n            \"fr\": \"Lequel des éléments suivants avez-vous le plus apprécié?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"That a localization was available\",\r\n              \"text\": {\r\n                \"default\": \"That a localization was available\",\r\n                \"fr\": \"Qu’une localisation était disponible\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to support my teams across the world\",\r\n              \"text\": {\r\n                \"default\": \"The ability to support my teams across the world\",\r\n                \"fr\": \"La capacité de soutenir mes équipes à travers le monde\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to engage with content, as English is not my first language\",\r\n              \"text\": {\r\n                \"default\": \"The ability to engage with content, as English is not my first language\",\r\n                \"fr\": \"La capacité de m’engager avec le contenu, car l’anglais n’est pas ma langue maternelle\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The approach could be used to improve the Power BI dashboards and applications that are included in the Automation Kit\",\r\n              \"text\": {\r\n                \"default\": \"The approach could be used to improve the Power BI dashboards and applications that are included in the Automation Kit\",\r\n                \"fr\": \"L’approche peut être utilisée pour améliorer les tableaux de bord et les applications Power BI inclus dans le Kit d’automatisation\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The approach provides me an example of how we can support automated localization of content\",\r\n              \"text\": {\r\n                \"default\": \"The approach provides me an example of how we can support automated localization of content\",\r\n                \"fr\": \"L’approche me fournit un exemple de la façon dont nous pouvons prendre en charge la localisation automatisée du contenu\"\r\n              }\r\n            }\r\n          ],\r\n          \"otherText\": \"Other features:\"\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"passive_experience\",\r\n          \"visibleIf\": \"{nps_score} \u003e= 7  and {nps_score} \u003c= 8\",\r\n          \"title\": {\r\n            \"default\": \"What can we do to make the localized content more satisfying?\",\r\n            \"fr\": \"Que pouvons-nous faire pour rendre le contenu localisé plus satisfaisant ?\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"disappointing_experience\",\r\n          \"visibleIf\": \"{nps_score} \u003c= 6\",\r\n          \"title\": {\r\n            \"default\": \"Please let us know why you had such a disappointing experience with the localized content\",\r\n            \"fr\": \"S’il vous plaît laissez-nous savoir pourquoi vous avez eu une expérience si décevante avec le contenu localisé\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"products\",\r\n          \"title\": {\r\n            \"default\": \"What is most important to you?\",\r\n            \"fr\": \"Qu’est-ce qui est le plus important pour vous?\"\r\n          },\r\n          \"isRequired\": false,\r\n          \"colCount\": 1,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"English content is good enough, I do not need a localized version\",\r\n              \"text\": {\r\n                \"default\": \"English content is good enough, I do not need a localized version\",\r\n                \"fr\": \"Le contenu anglais est assez bon, je n’ai pas besoin d’une version localisée\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"I would rather wait until localized content is on Microsoft Learn platform\",\r\n              \"text\": {\r\n                \"default\": \"I would rather wait until localized content is on Microsoft Learn platform\",\r\n                \"fr\": \"Je préfère attendre que le contenu localisé soit sur la plateforme Microsoft Learn\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to contribute to improve localizations\",\r\n              \"text\": {\r\n                \"default\": \"Being able to contribute to improve localizations\",\r\n                \"fr\": \"Pouvoir contribuer à améliorer les localisations\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to support ability to load localized content into my organization using the same approach\",\r\n              \"text\": {\r\n                \"default\": \"Being able to support ability to load localized content into my organization using the same approach\",\r\n                \"fr\": \"Être capable de prendre en charge la capacité de charger du contenu localisé dans mon organisation en utilisant la même approche\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Being able to customize the content for my organization and add content that is relevant to our organization\",\r\n              \"text\": {\r\n                \"default\": \"Being able to customize the content for my organization and add content that is relevant to our organization\",\r\n                \"fr\": \"Pouvoir personnaliser le contenu de mon organisation et ajouter du contenu pertinent pour notre organisation\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Localized images and diagrams\",\r\n              \"text\": {\r\n                \"default\": \"Localized images and diagrams\",\r\n                \"fr\": \"Images et diagrammes localisés\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Using learnings to apply localization to Power BI dashboard\",\r\n              \"text\": {\r\n                \"default\": \"Using learnings to apply localization to Power BI dashboard\",\r\n                \"fr\": \"Utilisation des apprentissages pour appliquer la localisation au tableau de bord Power BI\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Using learnings to apply localization to Power Power Apps\",\r\n              \"text\": {\r\n                \"default\": \"Using learnings to apply localization to Power Power Apps\",\r\n                \"fr\": \"Utilisation des apprentissages pour appliquer la localisation à Power Apps\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to have content also available as Power Point in my language so I can present it to my team\",\r\n              \"text\": {\r\n                \"default\": \"The ability to have content also available as Power Point in my language so I can present it to my team\",\r\n                \"fr\": \"La possibilité d’avoir du contenu également disponible sous forme de Power Point dans ma langue afin que je puisse le présenter à mon équipe\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"other-feedback\",\r\n          \"title\": {\r\n            \"default\": \"Any other feedback?\",\r\n            \"fr\": \"D’autres commentaires?\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"send-results\",\r\n          \"title\": {\r\n            \"default\": \"Do you want to send the results of the your feedback so that the Core Automation Kit team can tailor the localization based on your responses\",\r\n            \"fr\": \"Souhaitez-vous envoyer les résultats de vos commentaires afin que l’équipe Core Automation Kit puisse adapter la localisation en fonction de vos réponses\"\r\n          },\r\n          \"label\": {\r\n            \"default\": \"Send results?\",\r\n            \"fr\": \"Envoyer des résultats ?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results} = false\",\r\n          \"html\": {\r\n            \"default\": \"We hope these questions will help you determine an idea of topics or questions if you attend\",\r\n            \"fr\": \"Nous espérons que ces questions vous aideront à déterminer une idée des sujets ou des questions si vous assistez\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results} = true\",\r\n          \"html\": {\r\n            \"default\": \"We look forward to getting your feedback. As a core Automation Kit team we use the feedback to improve the overview.\",\r\n            \"fr\": \"Nous sommes impatients de recevoir vos commentaires. En tant qu’équipe de base du kit d’automatisation, nous utilisons les commentaires pour améliorer la vue d’ensemble.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"feedback-task\",\r\n          \"name\": \"send-results\",\r\n          \"title\": {\r\n            \"default\": \"Send your feedback now?\",\r\n            \"fr\": \"Envoyer vos commentaires maintenant?\"\r\n          },\r\n          \"destination\": \"https://aka.ms/ak4pp-feedback2\",\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results-status.length} \u003e 0\",\r\n          \"html\": {\r\n            \"default\": \"Status: {send-results-status}\",\r\n            \"fr\": \"Statut: \"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
    .sv-btn {
        border-radius: 0.3em;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>JavaScript doit être activé pour afficher ce contenu</p>
</noscript>



<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='createConnection'></fluent-button></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).closest(".sv-question").parent().attr("style","")
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            if ( typeof environment !== "undefined" && environment.length > 0 ) {
                                environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                                window.open(environment)
                            }
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='downloadLink'>Télécharger</fluent-button><a id='downloadData' style='display:none'></a></div>",
               activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='sendFeedback'>Répondez aux questions et envoyez des commentaires</a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", 'Envoi de commentaires')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", 'Impossible d’envoyer des commentaires')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", 'Valider que les questions sont complètes')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La réponse du réseau n’était pas correcte.');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La réponse du réseau n’était pas correcte.');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    function startsWithFunction(params) {
        try {
            return params[0].startsWith(params[1])
        } catch {
            return false
        }
        return false
    }

    function ceilingFunction(params) {
        try {
            return Math.ceil(params[0])
        } catch {
            return ''
        }
    }

    function parseIntFunction(params) {
        try {
            return parseInt(params[0])
        } catch {
            return ''
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.FunctionFactory
            .Instance
            .register("startsWith", startsWithFunction);

        Survey.FunctionFactory
            .Instance
            .register("int", parseIntFunction)

        Survey.FunctionFactory
            .Instance
            .register("ceil", ceilingFunction)

        Survey.StylesManager.applyTheme("modern");
        
        

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }
            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons = "false"
        
            
            questionModel.locale = "fr"
            
            questionModel.completedHtml = "Merci d’avoir répondu aux questions";

            
            
            
            
            
            
            
            
            
            $("#questions").Survey({ model: questionModel });

            if ( window.surveyChanged != null ) {
                questionModel.onValueChanged.add(window.surveyChanged)
            }
            if ( window.afterRenderQuestion != null ) {
                questionModel.onAfterRenderQuestion.add(window.afterRenderQuestion)
            }

            questionModel.currentPageNo = 0;

            

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }
            

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('La réponse du réseau n’était pas correcte.');
                })
        }
    });
</script>


    </div>
  </div>
</article>

    
    
    <footer class="d-print-none">
    <nav class="navbar navbar-light bg-light d-flex justify-content-around">
  <div class="container pt-3">
    <div class="row d-flex justify-content-center">
      <div class="col-lg-2 col-md-6">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Produit</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/fr/releases">
              Versions
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/fr/frequently-asked-questions">
              FAQ
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/fr/support">
              Soutien
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/fr/office-hours">
              Heures d’ouverture
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-learn">
              Découvrir les fonctionnalités
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/ak4pp-issues">
              Questions
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
              Étapes
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/releases">
              Versions
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://privacy.microsoft.com/privacystatement">
              Politique de confidentialité
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Apprendre</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
              Démarrer
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
              Configurer le kit d’automatisation
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
              Utiliser le kit d’automatisation
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Blog</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-blog">
              Préversion publique
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
              Témoignage client Cineplex
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
          <h3></h3>
          <nav class="level is-mobile">
            <div class="level-left">
              <a class="level-item" rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit">
                <span class="icon"><i class="fa fa-github"></i></span>
              </a>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>

    </nav>
</footer>
    

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
</html>