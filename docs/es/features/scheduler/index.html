<!doctype html>
<html lang="en-us">
    <a id="topOfPage"></a>
    <head>
        

<meta property="og:title" content="Programador" />
<meta property="og:description" content="Kit de automatización - Programador" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/powercat-automation-kit/es/features/scheduler/" /><meta property="article:section" content="features" />





<meta name="description" content="Kit de automatización para Power Platform sitio de inicio. Defina y mida el retorno de la inversión de Power Automate Desktop, vincule contenido de aprendizaje e historias de clientes." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="og:image" content="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.png" />
<meta name="og:image:alt" content="Automation Kit Logo" />

        <title>Automation Kit for Power Platform</title>
        
<link rel="icon" type="image/png" href="https://microsoft.github.io/powercat-automation-kit/images/favicon.png" />
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/style.min.900ac3346e02b249eca52c9ae838525e38bee9dc718fb9fd6cc0fbcfa923b149.css" integrity="sha256-kArDNG4CsknspSya6DhSXji&#43;6dxxj7n9bMD7z6kjsUk=">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" type="text/css" href="https://microsoft.github.io/powercat-automation-kit/css/icons.css">
<link href="https://microsoft.github.io/powercat-automation-kit/css/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script type="module" src="https://unpkg.com/@fluentui/web-components"></script>

    </head>
    <body>
    

    
<nav class="navbar navbar-expand-lg navbar-dark bg-gray">
    <div class="container d-flex justify-content-between">
        <a class="navbar-item" href="https://microsoft.github.io/powercat-automation-kit/es/">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg" alt="" width="112" height="56">
        </a>
        <span class="my-1 title text-black">Kit de automatización para Power Platform</span>
    </div>
</nav>
<article>
  <a id="topofpage"></a>
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Programador</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>

    <div class="content">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#flujos-de-nube">Flujos de nube</a></li>
    <li><a href="#vistas-de-calendario">Vistas de calendario</a></li>
    <li><a href="#vistas-de-día-semana-mes">Vistas de día, semana, mes</a>
      <ul>
        <li><a href="#horario">Horario</a></li>
      </ul>
    </li>
    <li><a href="#ejecutar-ahora">Ejecutar ahora</a>
      <ul>
        <li><a href="#cambios-planificados">Cambios planificados</a></li>
        <li><a href="#comportamiento-de-solo-lectura-de-flujos-programados">Comportamiento de solo lectura de flujos programados</a></li>
      </ul>
    </li>
    <li><a href="#mensajes-de-error">Mensajes de error</a>
      <ul>
        <li><a href="#mensaje-de-error-invalidargument---no-se-puede-encontrar-una-conexión-válida-asociada-con-la-referencia-de-conexión-proporcionada">Mensaje de error: &ldquo;InvalidArgument - No se puede encontrar una conexión válida asociada con la referencia de conexión proporcionada&rdquo;.</a></li>
      </ul>
    </li>
    <li><a href="#notas">Notas</a></li>
    <li><a href="#instalar">Instalar</a></li>
    <li><a href="#hoja-de-ruta">Hoja de ruta</a></li>
    <li><a href="#retroalimentación">Retroalimentación</a></li>
  </ul>
</nav>
<h2 id="introducción">Introducción</h2>
<p>El Programador del kit de automatización permite ver la programación de flujos recurrentes de Power Automate Cloud dentro de Soluciones que incluyen llamadas a flujos de Power Automate Desktop.</p>
<p>Esta característica se actualizó como parte de la <a href="https://microsoft.github.io/powercat-automation-kit/es/releases/march-2023">Marzo 2023</a>, las versiones posteriores continuarán mejorando y aumentando la funcionalidad del programador.</p>
<style>
    .outerBorder {
        border: 1px;
        color: black;
        border-style: solid;
        margin-bottom: 10px;
    }

    .outerBorder > center {
        padding: 5px;
    }
</style>
<div class="outerBorder">
    <center>

    <img src="https://microsoft.github.io/powercat-automation-kit/images/schedule.png" alt="Programador">

    </center>
</div>

<p>Las características clave del programador son:</p>
<ul>
<li>La capacidad de ver la programación de flujos de nube recurrentes</li>
<li>Programación de filtros por máquina y grupos de máquinas</li>
<li>Ejecutar un flujo de Power Automate Desktop</li>
<li>Ver programación por día, semana, mes y vista de programación</li>
<li>Ver el estado de los flujos programados (correctos, fallidos o programados)</li>
<li>Ver la duración de una ejecución de Cloud Flow</li>
<li>Ver los detalles de cualquier error.</li>
</ul>
<h2 id="flujos-de-nube">Flujos de nube</h2>
<p>Como se señaló anteriormente, solo los flujos de nube que se incluyen como parte de una solución. El reciente <a href="https://powerautomate.microsoft.com/vi-vn/blog/more-manageable-cloud-flows-with-dataverse-solutions-by-default/">https://powerautomate.microsoft.com/blog/more-manageable-cloud-flows-with-dataverse-solutions-by-default/</a> incluye información sobre cómo usar la nueva versión preliminar de &ldquo;Soluciones de Dataverse de forma predeterminada&rdquo; para ayudar a garantizar que los flujos de nube se incluyan en las soluciones. El uso de esta función puede ayudar a los usuarios a garantizar que los flujos de nube programados que se crean sean visibles en el programador.</p>
<h2 id="vistas-de-calendario">Vistas de calendario</h2>
<h2 id="vistas-de-día-semana-mes">Vistas de día, semana, mes</h2>
<p>Las vistas de día, semana y mes muestran información sobre las ejecuciones de flujo de Desktop Cloud que se han ejecutado o están programadas para ejecutarse.</p>
<p>Los elementos están codificados por colores de la siguiente manera:</p>
<ul>
<li>
<p>El verde indica que la ejecución se ha ejecutado correctamente</p>
</li>
<li>
<p>El rojo indica que se ha producido un error de ejecución</p>
</li>
<li>
<p>El azul indica una ejecución futura programada.</p>
</li>
</ul>
<p>La información de estado y ejecución está disponible con un toque prolongado o pasar el mouse sobre el evento.</p>
<h3 id="horario">Horario</h3>
<style>
    .outerBorder {
        border: 1px;
        color: black;
        border-style: solid;
        margin-bottom: 10px;
    }

    .outerBorder > center {
        padding: 5px;
    }
</style>
<div class="outerBorder">
    <center>

    <img src="https://microsoft.github.io/powercat-automation-kit/images/scheduler-schedule-view.png" alt="Programador - Ejecutar ahora">

    </center>
</div>

<p>La vista de programación incluye un conjunto de flujos de nube basados en el tiempo de la hora actual y los flujos programados futuros en los próximos días.</p>
<h2 id="ejecutar-ahora">Ejecutar ahora</h2>
<style>
    .outerBorder {
        border: 1px;
        color: black;
        border-style: solid;
        margin-bottom: 10px;
    }

    .outerBorder > center {
        padding: 5px;
    }
</style>
<div class="outerBorder">
    <center>

    <img src="https://microsoft.github.io/powercat-automation-kit/images/scheduler-run-now.png" alt="Programador - Ejecutar ahora">

    </center>
</div>

<p>La versión actual de Ejecutar ahora ejecutará el escritorio de Power Automate. Se supone que no hay parámetros necesarios para ejecutar el flujo de escritorio. La información adicional de ejecución está disponible en la información de última ejecución del escritorio.</p>
<h3 id="cambios-planificados">Cambios planificados</h3>
<p>En futuras versiones, se considerarán nuevas características las siguientes:</p>
<ol>
<li>
<p>Ejecute el flujo de nube en lugar del flujo de escritorio. Esto incluirá el historial de ejecución del flujo de nube y la ejecución de cualquier acción y parámetros adicionales de flujo de nube que se pasen al flujo de escritorio.</p>
</li>
<li>
<p>Abra las páginas de ejecución de flujo de escritorio y nube.</p>
</li>
</ol>
<h3 id="comportamiento-de-solo-lectura-de-flujos-programados">Comportamiento de solo lectura de flujos programados</h3>
<p>De forma predeterminada, cuando un flujo se programa para su ejecución futura, se establece en modo de solo lectura y se deshabilita para su ejecución inmediata. Esto significa que los usuarios no pueden modificar o ejecutar el flujo hasta que haya pasado la fecha y hora programadas. Este comportamiento está diseñado para proporcionar una mejor experiencia de usuario y evitar la ejecución accidental de flujos antes de que se pretenda ejecutar.
Hay varios beneficios para este enfoque, incluyendo:</p>
<ul>
<li>
<p>Prevención de la ejecución accidental: al deshabilitar la ejecución inmediata de flujos programados para ejecución futura, es menos probable que los usuarios ejecuten accidentalmente un flujo antes de que se pretenda que se ejecute.</p>
</li>
<li>
<p>Previsibilidad mejorada: Al establecer los flujos en modo de solo lectura cuando están programados para su ejecución futura, los usuarios pueden predecir más fácilmente cuándo se ejecutarán los flujos y asegurarse de que tienen listas las entradas y los recursos necesarios.</p>
</li>
<li>
<p>Experiencia de usuario coherente: al estandarizar el comportamiento de los flujos programados, puede proporcionar una experiencia de usuario coherente y predecible en todas las instancias de Flow.</p>
</li>
<li>
<p>Para modificar o ejecutar un flujo programado, los usuarios pueden editar el flujo y actualizar la fecha y hora programadas. Una vez que se haya establecido la nueva programación, el flujo se deshabilitará una vez más para su ejecución inmediata y se establecerá en modo de solo lectura hasta que la nueva programación haya pasado.</p>
</li>
</ul>
<h2 id="mensajes-de-error">Mensajes de error</h2>
<p>Posibles mensajes de error que podrían producirse al ejecutar el flujo de ejecución.</p>
<h3 id="mensaje-de-error-invalidargument---no-se-puede-encontrar-una-conexión-válida-asociada-con-la-referencia-de-conexión-proporcionada">Mensaje de error: &ldquo;InvalidArgument - No se puede encontrar una conexión válida asociada con la referencia de conexión proporcionada&rdquo;.</h3>
<h4 id="descripción">Descripción</h4>
<p>Este mensaje de error normalmente indica que hay un problema con la referencia de conexión proporcionada en el código o la configuración. El sistema no puede localizar una conexión válida asociada a la referencia, lo que le impide ejecutar la acción solicitada.</p>
<h4 id="causas">Causas</h4>
<p>Hay varias causas potenciales para este mensaje de error, incluyendo:</p>
<ul>
<li>
<p>Referencia de conexión incorrecta o no válida: la referencia de conexión proporcionada puede ser inválida o incorrecta, lo que puede provocar que el sistema no encuentre una conexión válida asociada a ella.</p>
</li>
<li>
<p>Conexión eliminada o cambiada: Si la conexión utilizada en el código o la configuración se ha eliminado o modificado, puede provocar que el sistema no pueda localizar una conexión válida asociada con la referencia.</p>
</li>
<li>
<p>Problema de permisos: es posible que la cuenta de usuario que ejecuta el código o la configuración no tenga los permisos necesarios para acceder a la conexión o a los recursos asociados a ella.</p>
</li>
</ul>
<h4 id="resolución">Resolución</h4>
<p>Para resolver este problema, puede realizar los pasos siguientes:</p>
<ul>
<li>
<p>Verifique la referencia de conexión: compruebe la referencia de conexión proporcionada en el código o la configuración y asegúrese de que es válida y correcta.</p>
</li>
<li>
<p>Eliminar conexiones existentes y volver a crear: Si el Comprobador de flujo advierte que no se ha utilizado una referencia de conexión, puede utilizar el Comprobador de flujo para eliminar las conexiones existentes. Una vez eliminadas las conexiones, puede volver a crear referencias de conexión al equipo o grupo de máquinas para permitir que se ejecute el flujo.</p>
</li>
</ul>
<h2 id="notas">Notas</h2>
<p>Para la versión actual, se aplican las siguientes notas</p>
<ol>
<li>Solo se muestran las soluciones Power Automate Desktop y Power Automate incluidas en una solución</li>
<li>Se ha registrado y ejecutado al menos un Power Automate Desktop</li>
</ol>
<h2 id="instalar">Instalar</h2>
<p>Para instalar la solución del programador, puede hacer lo siguiente:</p>
<ol>
<li>Asegúrese de que el marco de componentes de Power Apps esté habilitado <a href="https://learn.microsoft.com/en-us/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature" target="_blank">Leer más</a></li>
<li>Has instalado Creator Kit en el entorno de destino. <a href="https://appsource.microsoft.com/en-us/product/dynamics-365/microsoftpowercatarch.creatorkit1" target="_blank">Instalar desde el origen de la aplicación</a></li>
<li>Ha descargado el archivo AutomationKit.zip desde la sección Activos de la última versión <a href="https://github.com/microsoft/powercat-automation-kit/releases" target="_blank">Versión de GitHub</a></li>
<li>Ha importado la versión más reciente de AutomationKitScheduler_*_administrado.zip archivo usando. <a href='https://learn.microsoft.com/en-us/power-apps/maker/data-platform/import-update-export-solutions' target="_blank">Leer más</a></li>
</ol>
<h2 id="hoja-de-ruta">Hoja de ruta</h2>
<p>Puedes visitar nuestro <a href="https://github.com/microsoft/powercat-automation-kit/issues?q=is%3Aissue+is%3Aopen+label%3Ascheduler" target="_blank">Problemas de GitHub</a> para ver las nuevas características propuestas.</p>
<p>Puede agregar un nuevo <a href="https://github.com/microsoft/powercat-automation-kit/issues/new?assignees=&labels=automation-kit%2Cenhancement%2Cscheduler&template=2-automation-kit-feature.yml&title=%5BAutomation+Kit+-+Feature%5D%3A+FEATURE+TITLE" target="_blank">Solicitud de característica del programador</a></p>
<h2 id="retroalimentación">Retroalimentación</h2>













<script>
    
    
    data = "{\r\n  \"triggers\": [\r\n    {\r\n      \"type\": \"setvalue\",\r\n      \"expression\": \"{send-results} = true\",\r\n      \"setToName\": \"code\",\r\n      \"setValue\": \"Feedback-AK4PP-Scheduler\"\r\n    }\r\n  ],\r\n  \"pages\": [\r\n    {\r\n      \"name\": \"welcome\",\r\n      \"elements\": [\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"features\",\r\n          \"title\": {\r\n            \"default\": \"Which of the following is most useful for your related to Scheduler functionality?\",\r\n            \"es\": \"¿Cuál de las siguientes opciones es más útil para su relación con la funcionalidad del Programador?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"colCount\": 1,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"The ability to view schedules by day\",\r\n              \"text\": {\r\n                \"default\": \"The ability to view schedules by day\",\r\n                \"es\": \"La capacidad de ver los horarios por día\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to view schedules by week\",\r\n              \"text\": {\r\n                \"default\": \"The ability to view schedules by week\",\r\n                \"es\": \"La capacidad de ver los horarios por semana\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to view schedules by month\",\r\n              \"text\": {\r\n                \"default\": \"The ability to view schedules by month\",\r\n                \"es\": \"La capacidad de ver los horarios por mes\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to run a flow\",\r\n              \"text\": {\r\n                \"default\": \"The ability to run a flow\",\r\n                \"es\": \"La capacidad de ejecutar un flujo\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"See the results of runs\",\r\n              \"text\": {\r\n                \"default\": \"See the results of runs\",\r\n                \"es\": \"Ver los resultados de las carreras\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"checkbox\",\r\n          \"name\": \"new-features\",\r\n          \"title\": {\r\n            \"default\": \"What new features would you like added to the Scheduler functionality?\",\r\n            \"es\": \"¿Qué nuevas características le gustaría agregar a la funcionalidad del Programador?\"\r\n          },\r\n          \"isRequired\": true,\r\n          \"colCount\": 1,\r\n          \"hasOther\": true,\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"The ability to filter by status (Success, Fail, Scheduled)\",\r\n              \"text\": {\r\n                \"default\": \"The ability to filter by status (Success, Fail, Scheduled)\",\r\n                \"es\": \"La capacidad de filtrar por estado (Correcto, Fallido, Programado)\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"The ability to filter by machine / machine group\",\r\n              \"text\": {\r\n                \"default\": \"The ability to filter by machine / machine group\",\r\n                \"es\": \"La capacidad de filtrar por máquina / grupo de máquinas\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Define alerts for failed runs\",\r\n              \"text\": {\r\n                \"default\": \"Define alerts for failed runs\",\r\n                \"es\": \"Definir alertas para ejecuciones fallidas\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Restart / Stop flow execution\",\r\n              \"text\": {\r\n                \"default\": \"Restart / Stop flow execution\",\r\n                \"es\": \"Reiniciar / Detener la ejecución del flujo\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Define dependencies between flow runs\",\r\n              \"text\": {\r\n                \"default\": \"Define dependencies between flow runs\",\r\n                \"es\": \"Definir dependencias entre ejecuciones de flujo\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"See the results of runs\",\r\n              \"text\": {\r\n                \"default\": \"See the results of runs\",\r\n                \"es\": \"Ver los resultados de las carreras\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"boolean\",\r\n          \"name\": \"send-results\",\r\n          \"label\": {\r\n            \"default\": \"Do you want to send the feedback on Scheduler?\",\r\n            \"es\": \"¿Desea enviar los comentarios en Scheduler?\"\r\n          },\r\n          \"isRequired\": true\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results} = true\",\r\n          \"html\": {\r\n            \"default\": \"We look forward to getting your feedback. As a core Automation Kit team we use the feedback to improving our guidance and roadmap\",\r\n            \"es\": \"Esperamos recibir sus comentarios. Como equipo central de Automation Kit, utilizamos los comentarios para mejorar nuestra orientación y hoja de ruta.\"\r\n          }\r\n        },\r\n        {\r\n          \"type\": \"text\",\r\n          \"name\": \"optional-name\",\r\n          \"title\": {\r\n            \"default\": \"You name (optional)\",\r\n            \"es\": \"Su nombre (opcional)\"\r\n          },\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"text\",\r\n          \"name\": \"optional-name\",\r\n          \"title\": {\r\n            \"default\": \"You name (optional)\",\r\n            \"es\": \"Su nombre (opcional)\"\r\n          },\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"text\",\r\n          \"name\": \"optional-organization\",\r\n          \"title\": {\r\n            \"default\": \"You organization (optional)\",\r\n            \"es\": \"Su organización (opcional)\"\r\n          },\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"dropdown\",\r\n          \"name\": \"optional-role\",\r\n          \"title\": {\r\n            \"default\": \"Role (optional)\",\r\n            \"es\": \"Rol (opcional)\"\r\n          },\r\n          \"choices\": [\r\n            {\r\n              \"value\": \"COE Administrator\",\r\n              \"text\": {\r\n                \"default\": \"COE Administrator\",\r\n                \"es\": \"Administrador del COE\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Automation Engineer\",\r\n              \"text\": {\r\n                \"default\": \"Automation Engineer\",\r\n                \"es\": \"Ingeniero de Automatización\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Business User\",\r\n              \"text\": {\r\n                \"default\": \"Business User\",\r\n                \"es\": \"Usuario empresarial\"\r\n              }\r\n            },\r\n            {\r\n              \"value\": \"Other\",\r\n              \"text\": {\r\n                \"default\": \"Other\",\r\n                \"es\": \"Otro\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"text\",\r\n          \"name\": \"optional-role-other\",\r\n          \"title\": {\r\n            \"default\": \"You role\",\r\n            \"es\": \"Tu rol\"\r\n          },\r\n          \"visibleIf\": \"{optional-role} = 'Other'\"\r\n        },\r\n        {\r\n          \"type\": \"text\",\r\n          \"name\": \"optional-contact\",\r\n          \"title\": {\r\n            \"default\": \"You contact details (optional)\",\r\n            \"es\": \"Sus datos de contacto (opcional)\"\r\n          },\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"comment\",\r\n          \"name\": \"other-feedback\",\r\n          \"title\": {\r\n            \"default\": \"Did you have any other feedback?\",\r\n            \"es\": \"¿Tenías algún otro comentario?\"\r\n          },\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"feedback-task\",\r\n          \"name\": \"send-results\",\r\n          \"title\": {\r\n            \"default\": \"Send your feedback now?\",\r\n            \"es\": \"¿Enviar sus comentarios ahora?\"\r\n          },\r\n          \"destination\": \"https://aka.ms/ak4pp-feedback2\",\r\n          \"visibleIf\": \"{send-results} = true\"\r\n        },\r\n        {\r\n          \"type\": \"html\",\r\n          \"visibleIf\": \"{send-results-status.length} \u003e 0\",\r\n          \"html\": {\r\n            \"default\": \"Status: {send-results-status}\",\r\n            \"es\": \"Estado: \"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
    
</script>

<style>
    #questions {
        margin-bottom: 20px;
    }
    .sv-btn {
        border-radius: 0.3em;
    }
</style>

<div id="questions">
</div>

<noscript>
    <p>JavaScript debe estar habilitado para ver este contenido</p>
</noscript>



<script>
    class QuestionExtensions {
        constructor() {
            this.feedbackTask();
            this.importTask();
            this.imageTask();
            this.downloadTask();
            this.handoffTask();
            this.createConnection();
            this.markdown();
        }

        markdown() {
            var widget = {
                name: "markdown",
                title: "Markdown",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "markdown";
                },
                isDefaultRender: false,
                htmlTemplate: "<div id='markdownContent'></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "markdown", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "markdown",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#markdownContent").attr('id', question.name)
                        const converter = new showdown.Converter();
                        $("#" + question.name).html(converter.makeHtml(question.markdown));
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        createConnection() {
            var widget = {
                name: "create-connection",
                title: "Create Connection",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "create-connection";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='createConnection'></fluent-button></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "create-connection", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "title",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "connector",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "environment",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#createConnection").attr('id', question.name)
                        $("#" + question.name).closest(".sv-question").parent().attr("style","")
                        $("#" + question.name).html(question.title);
                        $("#" + question.name).on("click", function() {
                            let environment = question.survey.data[question.environment]
                            if ( typeof environment !== "undefined" && environment.length > 0 ) {
                                environment = environment.replaceAll("/home", "/connections/available?apiName=" + question.connector)
                                window.open(environment)
                            }
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        downloadTask() {
            var widget = {
                name: "download-task",
                title: "Download Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "download-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='downloadLink'>Descargar</fluent-button><a id='downloadData' style='display:none'></a></div>",
               activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "download-task", [
                        {
                            name: "name",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "filter",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "fileName",
                            type: "text",
                            default: "results.json"
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#downloadLink").html(question.text);
                        $("#downloadLink").on("click", function() {
                            var data = question.survey.data;
                            if ( question.filter.length > 0 ) {
                                var newData = {}
                                for (const key in data) {
                                    if (data.hasOwnProperty(key) && key.startsWith(question.filter + "-")) {
                                        newData[key] = data[key]
                                    }
                                }
                                data = newData;
                            }
                            var jsonString = JSON.stringify(data);
                            var blob = new Blob([jsonString], { type: 'application/json' });
                            var anchor = document.getElementById('downloadData');
                            anchor.download = question.fileName;
                            anchor.href = window.URL.createObjectURL(blob);
                            anchor.dataset.downloadUrl = [ 'application/json', anchor.download, anchor.href].join(':');
                            anchor.click()
                        });
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        handoffTask() {
            var widget = {
                name: "handoff-task",
                title: "Handoff Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "handoff-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><a class='button cta rounded primary-btn raised' id='handoff'></a>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "handoff-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "text",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        question.survey.setValue(question.name + '_loaded', true)
                        $("#handoff").html(question.text);
                        $("#handoff").on("click", function() {
                            const parameterRegularExpression = new RegExp("\{([^}]+)\}","g")
                            var matches = question.destination.match(parameterRegularExpression)
                            var destination = question.destination
                            for ( var i = 0; i < matches.length; i++) {
                                let name = matches[i].replaceAll("{","").replaceAll("}","")
                                destination = destination.replaceAll(matches[i], question.survey.data[name])
                            }
                            window.location = destination;
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        feedbackTask() {
            var widget = {
                name: "feedback-task",
                title: "Feedback Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "feedback-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div><fluent-button appearance='accent' id='sendFeedback'>Complete preguntas y envíe comentarios</fluent-button>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "feedback-task", [
                        {
                            name: "destination",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        $("#sendFeedback").on("click", function() {
                            if ( question.survey.completeLastPage() ) {
                                question.survey.setValue(question.name + "-status", 'Envío de comentarios')

                                $.ajax({
                                        type: "GET",
                                        url: question.destination,
                                        success: function (response) {
                                            $.ajax
                                            ({
                                                type: "POST",
                                                url: response.url,
                                                dataType: 'json',
                                                async: false,
                                                cors: true,
                                                data: JSON.stringify(question.survey.data),
                                                success: function (result) {
                                                    question.survey.setValue(question.name + "-status", result.status)
                                                },
                                                error: function() {
                                                    question.survey.setValue(question.name + "-status", 'No se pueden enviar comentarios')
                                                }
                                            });
                                            }
                                    });
                            } else {
                                question.survey.setValue(question.name + "-status", 'Validar que las preguntas estén completas')
                            }
                        })  
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };
            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        importTask() {
            var widget = {
                name: "importTask",
                title: "Import Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "import-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "import-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        },
                        {
                            name: "mode",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    function initWidget() {
                        console.log('Loading')
                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La respuesta de la red no fue correcta.');
                            })
                            .then(function (jsonContent) {
                                question.survey[question.name + '_loaded'] = true;
                                var importSurvey = new Model(jsonContent);
                                if (question.hasOwnProperty('mode')) {
                                    switch (question.mode) {
                                        case 'merge':
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                for (var q = 0; q < question.survey.pages.length; q++) {
                                                    if (question.survey.pages[q].name === importSurvey.pages[i].name) {
                                                        for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                            question.survey.pages[q].elements.push(importSurvey.pages[i].elements[e])
                                                        }
                                                    }
                                                }
                                            }
                                            break;
                                        case 'insert':
                                        case 'replace':
                                            var selectedPage = question.survey.currentPageNo;
                                            var newPages = [];
                                            
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                newPages.push(newPages)
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                                
                                                question.survey.pages.splice(selectedPage + i + 1, 0, question.survey.pages.splice(question.survey.pages.length - 1, 1)[0]);
                                                question.survey.runConditions();
                                                question.survey.updateVisibleIndexes();
                                            }
                                            if (question.mode == 'replace') {
                                                question.survey.removePage(question.survey.pages[selectedPage]);
                                            }
                                            question.survey.currentPageNo = selectedPage;
                                            break;
                                        default:
                                            for (var i = 0; i < importSurvey.pages.length; i++) {
                                                var newPage = question.survey.addNewPage(importSurvey.pages[i].name);
                                                for (var e = 0; e < importSurvey.pages[i].elements.length; e++) {
                                                    newPage.elements.push(importSurvey.pages[i].elements[e])
                                                }
                                                newPage.title = importSurvey.pages[i].title;
                                                newPage.visibleIf = importSurvey.pages[i].visibleIf;
                                            }
                                    }
                                }
                            })
                    };
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        imageTask() {
            var self = this;
            var widget = {
                name: "imageTask",
                title: "Image Task",
                iconName: "",
                widgetIsLoaded: function () {
                    return true;
                },
                defaultJSON: {

                },
                isFit: function (question) {
                    return question.getType() === "image-task";
                },
                isDefaultRender: false,
                htmlTemplate: "<div></div>",
                activatedByChanged: function (activatedBy) {
                    Survey.JsonObject.metaData.addClass(
                        "image-task", [
                        {
                            name: "src",
                            type: "text",
                            default: ""
                        }
                    ], null, "empty");
                },
                afterRender: function (question, el) {
                    if (!question.survey[question.name + '_loaded']) {
                        initWidget();
                    }

                    question.valueChangedCallback = initWidget;
                    question.readOnlyChangedCallback = initWidget;

                    function initWidget() {
                        if (question.survey[question.name + '_loaded']) {
                            return;
                        }

                        fetch(question.src)
                            .then(function (response) {
                                if (response.ok) {
                                    return response.text();
                                }
                                throw new Error('La respuesta de la red no fue correcta.');
                            })
                            .then(function (svgContent) {
                                el.innerHTML = svgContent;
                                if (typeof self !== "undefined") {
                                    self.componentSelect(question.survey, question, el);
                                }
                            })
                    }
                },
                willUnmount: function (question, el) {
                    el.innerHTML = null;
                    question.readOnlyChangedCallback = null;
                }
            };

            Survey.CustomWidgetCollection.Instance.addCustomWidget(widget, "customtype");
        }

        componentSelect(survey, question, element) {
        console.log('Component Loaded')
        var itemSelected =  ''
        var groupSelected = ''
        var itemUnselected =  ''
        var groupUnselected = ''

        var requiredQuestions = []
        
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("template://") )  {
                var rect = this.findRect(a);
                if (rect == null) {
                    var rect = this.findPath(a);
                }

                if (rect != null)
                {
                    var classVal = rect.getAttribute("class");
                    switch ( a.href.baseVal ) {
                        case "template://group/selected":
                            groupSelected = classVal;
                            break;
                        case "template://group/unselected":
                            groupUnselected = classVal;
                            break;
                        case "template://item/selected":
                            itemSelected = classVal;
                            break;
                        case "template://item/unselected":
                            itemUnselected = classVal;
                            break;
                    }
                }
            }

            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                if ( requiredQuestions.indexOf(requiredQuestionId) == -1) {
                    requiredQuestions.push(requiredQuestionId)
                }
            }
        }

        this.updateComplete(survey, question, requiredQuestions, element)

        for (const a of element.querySelectorAll("a")) {        
            if ( typeof a.href !== "undefined" ) {
                var handled = false;
                if (a.href.baseVal.startsWith("question://") || a.href.baseVal.startsWith("option://")) {
                    console.log('Found question ' + a.href.baseVal )
                    this.setupQuestion(survey, a.href.baseVal, a, itemSelected)

                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                        var aLink = this.findLink(event.target);
                        if ( aLink !== null) {
                            var rect = this.findRect(aLink);
                            if (rect == null) {
                                var rect = this.findPath(aLink);
                            }

                            var newClass = itemSelected;
                            if (rect.getAttribute("class") == itemSelected) {
                                newClass = itemUnselected
                            }
                            this.selectQuestion(survey, a.href.baseVal, newClass == itemSelected, element, itemUnselected, () => {
                                this.updateComplete(survey, question, requiredQuestions, element)
                            });

                            if (rect != null) {
                                rect.setAttribute("class", newClass)
                            }
                        }
                    })
                    handled = true;
                }

                if (a.href.baseVal.startsWith("navigate://")) {
                    console.log('Found navigation link ' + a.href.baseVal )
                    a.addEventListener("click", (event) => {
                        event.preventDefault();

                        var parts = a.href.baseVal.split('/');
                    
                        survey.currentPageNo = parseInt(parts[parts.length-1]) - 1;
                    });
                    handled = true;
                }

                if (a.href.baseVal.startsWith("popup://")) {
                    console.log('Found popup link ' + a.href.baseVal )
                    
                    
                    handled = true;
                }

                if (!handled) {
                    a.addEventListener("click", (event) => {
                        event.preventDefault();
                    });
                }
            }
        }
    }
    
    unique(arr) {
        var a = arr.concat();
        for(var i=0; i<a.length; ++i) {
            for(var j=i+1; j<a.length; ++j) {
                if(a[i] === a[j])
                    a.splice(j--, 1);
            }
        }

        return a;
    };

    findQuestion(survey, questionId) {
        var questionMatch = null;
        for ( var p = 0; p < survey.pages.length; p++ ) {
            for ( var q = 0; q < survey.pages[p].questions.length; q++ ) 
            {
                if ( survey.pages[p].questions[q].name == questionId )
                {
                    questionMatch = survey.pages[p].questions[q];
                    break;
                }
            }
        }
        return questionMatch;
    }

    updateComplete(survey, question, requiredList, element) {
        var requiredMatch = 0;
        for (const a of element.querySelectorAll("a")) {
            if ( typeof a.href !== "undefined" && a.href.baseVal.startsWith("required://") )  {
                var parts = a.href.baseVal.split('/')
                var requiredQuestionId = parts[parts.length -1]
                var hasValue = false;
                if (
                    typeof survey.data[requiredQuestionId] !== "undefined" && 
                    (typeof survey.data[requiredQuestionId].length === "number" && survey.data[requiredQuestionId].length > 0)
                ) {
                    requiredMatch++;
                    hasValue = true;
                }

                var path = this.findPath(a);
                if (path != null) {
                    if (hasValue) {
                        path.setAttribute('style', 'display:none')
                    } else {
                        path.setAttribute('style', '')
                    }
                }
            }
        }

        if (typeof question.name === "string") {
            if (requiredMatch == requiredList.length) {
                survey.setValue(question.name, 'complete')
            } else {
                survey.clearValue(question.name)
            }
        } 
    }

    setupQuestion(survey, questionId, element, itemSelected) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        
        var currentVal = survey.data[question];

        if ( typeof currentVal === "undefined") {
            return;
        }

        var newClass = '';

        if ( questionId.startsWith('option://') ) {
            if ( val === currentVal ) {
                newClass = itemSelected;
            }
        }

        if ( questionId.startsWith('question://') && currentVal.indexOf(val) >= 0 ) {
            newClass = itemSelected;
        }

        if ( newClass.length > 0)
        {
        var rect = this.findRect(element);
        if (rect == null) {
            var rect = this.findPath(element);
        }
        
        rect.setAttribute('class', newClass)
        }
    }

    selectQuestion(survey, questionId, selected, element, itemUnselected, callback) {
        var parts = questionId.split('/');
        var val = parts[parts.length - 1];
        var question = parts[parts.length - 2];
        var group = parts[parts.length - 3];

        if ( questionId.startsWith('option://') ) {
            this.unselectGroup(element, group, question, itemUnselected);
        }

        if ( questionId.startsWith('option://') && !selected ) {
            survey.clearValue(question);
            if (typeof callback === "function") {
                callback()
            }
            return;
        }

        var newVal = val;

        var currentVal = survey.data[question];
        if ( typeof currentVal === "undefined") {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
            }
        }
        else
        {
            if ( questionId.startsWith('question://') ) {
                newVal = selected ? [ val ] : [];
                newVal = this.unique(currentVal.concat(newVal));
                if ( !selected ) {
                    
                    var index = newVal.indexOf(val);
                    if (index > -1) {
                        newVal.splice(index, 1);
                    }
                }
            }
        }

        survey.setValue(question, newVal);

        if (typeof callback === "function") {
            callback()
        }
    }

    unselectGroup(element, group, question, classToApply) {
        var items = this.findOptions(element, group, question);

        items.forEach( item => {
            var rect = this.findRect(item);
            if (rect == null) {
                var rect = this.findPath(item);
            }

            if (rect != null) {
                rect.setAttribute('class', classToApply)
            }
        });
    }

    findOptions(element, group, question) {
        var options = []
        this.findChildLink(element, 'option://' + group + "/" + question, options)
        return options;
    }

    findLink(element, startsWith) {
        if (typeof element !== "undefined") {
            if ( typeof element.href !== "undefined" ) {
                if ( typeof startsWith !== "undefined") {
                    if ( element.href.baseVal.startsWith(startsWith) ) {
                        return element;
                    }

                    if ( typeof element.parentElement !== "undefined" ) {
                        return this.findLink(element.parentElement, startsWith)
                    }
                } else {
                    return element
                }
            }

            if ( typeof element.parentElement !== "undefined" ) {
                return this.findLink(element.parentElement, startsWith)
            }
        }
    
        return null;
    }

    findChildLink(element, startsWith, matches) {
        if ( typeof element === "undefined" ) {
            return null;
        }

        if ( typeof element.href !== "undefined" && typeof element.href.baseVal !== "undefined") {
            if ( element.href.baseVal.startsWith(startsWith) ) {
                if ( startsWith !== "undefined" && element.href.baseVal.startsWith(startsWith) ) {
                    matches.push(element);
                }
            }
        }

        if ( typeof element.childNodes !== "undefined" ) {
            for (let child of element.childNodes) {
                if ( typeof startsWith === "string" && typeof child.href !== "undefined" && typeof child.href.baseVal !== "undefined") {
                    if ( child.href.baseVal.startsWith(startsWith) ) {
                        matches.push(child);
                    }
                }
                
                this.findChildLink(child, startsWith, matches);
            }
        }
    }

    findRect(element) {
        for (const rect of element.querySelectorAll("rect")) {
            return rect;
        }
        return null;
    }

    findPath(element) {
        for (const item of element.querySelectorAll("path")) {
            return item;
        }
        return null;
    }
    }

    function contains(params) {
        try {
            if (Array.isArray(params[0]) && Array.isArray(params[1])) {
                for (var i = 0; i < params[1].length; i++) {
                    if (params[0].includes(params[1][i])) {
                        return true
                    }
                }
            }

            if (Array.isArray(params[0]) && !Array.isArray(params[1])) {
                return params[0].includes(params[1]);
            }
        } catch {
            return false
        }
        return false
    }

    function stringLength(params) {
        try {
            return params[0].length
        } catch {
            return false
        }
        return false
    }

    function startsWithFunction(params) {
        try {
            return params[0].startsWith(params[1])
        } catch {
            return false
        }
        return false
    }

    function ceilingFunction(params) {
        try {
            return Math.ceil(params[0])
        } catch {
            return ''
        }
    }

    function parseIntFunction(params) {
        try {
            return parseInt(params[0])
        } catch {
            return ''
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        
        Survey.FunctionFactory
            .Instance
            .register("contains", contains);
        Survey.FunctionFactory
            .Instance
            .register("len", stringLength);
        Survey.FunctionFactory
            .Instance
            .register("startsWith", startsWithFunction);

        Survey.FunctionFactory
            .Instance
            .register("int", parseIntFunction)

        Survey.FunctionFactory
            .Instance
            .register("ceil", ceilingFunction)

        Survey.StylesManager.applyTheme("modern");
        
        

        const converter = new showdown.Converter();
        new QuestionExtensions();

        function loadData(loaded) {
            const questionModel = new Survey.Model(loaded);
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            for (let key of url_param.keys()) {
                if ( key == "q" )
                {
                    continue;
                }
                const value = url_param.get(key);
                questionModel.setValue(key, value)
            }
            questionModel.onStarted.add(() => {
                console.log('called')
            })
            questionModel.onProcessHtml.add((survey, options) => {
                if ( typeof options.html == "string" ) {
                    options.html = converter.makeHtml(options.html);
                }
            })
            questionModel.onTextMarkdown.add(function (survey, options) {
                
                let str = converter.makeHtml(options.text);
                if (options.hasOwnProperty('markdown')) {
                    console.log(options.markdown)
                    str = converter.makeHtml(options.markdown);
                }
                
                str = str.substring(3);
                str = str.substring(0, str.length - 4);
                
                options.html = str;
            });
            questionModel.showNavigationButtons = "false"
        
            
            questionModel.locale = "es"
            
            questionModel.completedHtml = "Gracias por proporcionar comentarios";
            questionModel.focusFirstQuestionAutomatic = false;
            
            $("#questions").Survey({ model: questionModel });

            if ( window.surveyChanged != null ) {
                questionModel.onValueChanged.add(window.surveyChanged)
            }
            if ( window.afterRenderQuestion != null ) {
                questionModel.onAfterRenderQuestion.add(window.afterRenderQuestion)
            }

            questionModel.currentPageNo = 0;

            

            return questionModel;
        }

        if ( data != null) {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const q = url_param.get('q');
            var code = ''
            newData = JSON.parse(data)
            if ( q && q.length > 0 ) {
                try {
                    var questions = JSON.parse(atob(q));
                    code = questions.code;
                    var allowed = ["radiogroup", "checkbox"];
                    if ( Array.isArray(questions.add) ) {
                       for ( var i = questions.add.length - 1; i >= 0; i--) {
                        if ( allowed.indexOf(questions.add[i].type) >= 0) {
                            newData.pages[0].elements = [questions.add[i]].concat(newData.pages[0].elements)
                        }
                       }
                    }
                } catch (ex) {
                    console.log(ex)

                }     
            }
            

            data = JSON.stringify(newData)
            let result = loadData(data)
            if ( code.length > 0 ) {
                result.setValue('code', code)
            }
        }
        else {
            const get_url = window.location.search;
            const url_param = new URLSearchParams(get_url);
            const source = url_param.get('source');
            fetch('/powercat-automation-kit/' + source + ".json")
                .then(async function (response) {
                    if (response.ok) {
                        loadData(await response.text());
                    }
                    throw new Error('La respuesta de la red no fue correcta.');
                })
        }
    });
</script>


    </div>
  </div>
</article>

    
    
    <footer class="d-print-none">
    <nav class="navbar navbar-light bg-light d-flex justify-content-around">
  <div class="container pt-3">
    <div class="row d-flex justify-content-center">
      <div class="col-lg-2 col-md-6">
        <div class="footer-logo">
          <img src="https://microsoft.github.io/powercat-automation-kit/images/logos/automation-kit.svg">
        </div>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Producto</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/es/releases">
              Libera
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/es/frequently-asked-questions">
              Preguntas más frecuentes
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/es/support">
              Apoyo
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://microsoft.github.io/powercat-automation-kit/es/office-hours">
              Horario de oficina
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-learn">
              Descubre las características
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/ak4pp-issues">
              Cuestiones
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/milestones?status=open">
              Hitos
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit/releases">
              Libera
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://privacy.microsoft.com/privacystatement">
              Política de privacidad
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Aprender</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites">
              Comenzar
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit">
              Configurar el kit de automatización
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit">
              Usar el kit de automatización
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
            <h3>Blog</h3>
        </div>
        <ul class="link-list">
          <li>
            <a rel="noopener" target="_blank" href="https://aka.ms/automation-kit-blog">
              Vista previa pública
            </a>
          </li>
          <li>
            <a rel="noopener" target="_blank" href="https://powerautomate.microsoft.com/blog/cineplex-digital-transformation-with-power-automate-rpa-led-by-citizen-developers/">
              Historia de cliente de Cineplex
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-2 col-md-6">
        <div class="footer-header">
          <h3></h3>
          <nav class="level is-mobile">
            <div class="level-left">
              <a class="level-item" rel="noopener" target="_blank" href="https://github.com/microsoft/powercat-automation-kit">
                <span class="icon"><i class="fa fa-github"></i></span>
              </a>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>

    </nav>
</footer>
    

    

    

    <script src="https://microsoft.github.io/powercat-automation-kit/js/jquery/3.6.1/jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/feather-icons/4.29.0/feather.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/modernizr/2.8.3/modernizr.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/survey-jquery/1.9.55/survey.jquery.min.js" ></script>
<script src="https://microsoft.github.io/powercat-automation-kit/js/showdown/2.1.0/showdown.min.js" ></script>
</html>