{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "visibleIf": "{preview} = true",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "en-gb": "What scenario are you trying to calculate?"
          },
          "choices": [
            {
              "value": "calculator",
              "text": {
                "default": "Power Automate / Power Automate Desktop license cost",
                "en-gb": "Power Automate / Power Automate Desktop license cost"
              }
            },
            {
              "value": "migration-planner",
              "text": {
                "default": "Migration planner",
                "en-gb": "Migration planner"
              }
            },
            {
              "value": "samples",
              "text": {
                "default": "Sample scenarios",
                "en-gb": "Sample scenarios"
              }
            }
          ]
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "en-gb": "What sample scenario did you want to explore?"
          },
          "choices": [
            {
              "value": "migration-single-unattended",
              "text": {
                "default": "Migration of a single unattended bot running isolated from other bot process",
                "en-gb": "Migration of a single unattended bot running isolated from other bot process"
              }
            },
            {
              "value": "migration-200",
              "text": {
                "default": "Migration of hundreds of bots",
                "en-gb": "Migration of hundreds of bots"
              }
            },
            {
              "value": "process-mining",
              "text": {
                "default": "Using Process Advisor to identify Process automation",
                "en-gb": "Using Process Advisor to identify Process automation"
              }
            },
            {
              "value": "task-mining",
              "text": {
                "default": "Using Process Advisor task mining to analyze and improve bot reliability",
                "en-gb": "Using Process Advisor task mining to analyze and improve bot reliability"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "en-gb": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner."
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "en-gb": "Migration Parameters"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-automation-projects",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many automation projects to migrate?",
            "en-gb": "How many automation projects to migrate?"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended automation projects?",
            "en-gb": "Percentage of attended automation projects?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "en-gb": "A value between 0 and 100"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended automation projects?",
            "en-gb": "Percentage of unattended automation projects?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "en-gb": "A value between 0 and 100"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new group",
            "en-gb": "Add new group"
          },
          "title": {
            "default": "Migration Groups",
            "en-gb": "Migration Groups"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "en-gb": "Migration Group Name"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "en-gb": "Description"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "en-gb": "Groups"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "en-gb": "Add new item"
          },
          "title": {
            "default": "Duration Plan",
            "en-gb": "Duration Plan"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "en-gb": "Complexity"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": [
                {
                  "value": "low",
                  "text": {
                    "default": "Low",
                    "en-gb": "Low"
                  }
                },
                {
                  "value": "medium",
                  "text": {
                    "default": "Medium",
                    "en-gb": "Medium"
                  }
                },
                {
                  "value": "high",
                  "text": {
                    "default": "High",
                    "en-gb": "High"
                  }
                }
              ]
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "en-gb": "Group"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "en-gb": "Percentage"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "projects",
              "title": {
                "default": "Projects",
                "en-gb": "Projects"
              },
              "cellType": "expression",
              "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
            },
            {
              "name": "projectsPerMonth",
              "title": {
                "default": "Projects per month",
                "en-gb": "Projects per month"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "en-gb": "Total (Business Days)"
              },
              "cellType": "expression",
              "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.",
            "en-gb": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated."
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "en-gb": "Automatically calculate possible migration plan?"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "en-gb": "Add new item"
          },
          "title": {
            "default": "Migration Plan",
            "en-gb": "Migration Plan"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "en-gb": "Name"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "en-gb": "Low"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "en-gb": "Medium"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "en-gb": "High"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "en-gb": "Attended"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "en-gb": "Unattended"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "en-gb": "Tell me more about each license type"
          },
          "defaultValue": true
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "en-gb": "Select plans you want more information on"
          },
          "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "en-gb": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>"
          }
        },
        {
          "name": "includeCurrentCost",
          "title": {
            "default": "Include current costs",
            "en-gb": "Include current costs"
          },
          "isRequired": true,
          "type": "boolean",
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "currentItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "en-gb": "Add new item"
          },
          "visibleIf": "{includeCurrentCost}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "en-gb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Makers",
                  "text": {
                    "default": "Makers",
                    "en-gb": "Makers"
                  }
                },
                {
                  "value": "Licenses",
                  "text": {
                    "default": "Licenses",
                    "en-gb": "Licenses"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "en-gb": "Infrastructure"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "en-gb": "Amount"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "cost",
              "title": {
                "default": "Cost",
                "en-gb": "Cost"
              },
              "isRequired": true,
              "displayStyle": "currency",
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "en-gb": "Monthly"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": false,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "currentTotal",
              "title": {
                "default": "Total",
                "en-gb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Power Platform license costs monthly",
            "en-gb": "Power Platform license costs monthly"
          },
          "labelTrue": "Retail price",
          "labelFalse": "Custom price",
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "en-gb": "Add new item"
          },
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "en-gb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Trial",
                  "text": {
                    "default": "Trial",
                    "en-gb": "Trial"
                  }
                },
                {
                  "value": "User",
                  "text": {
                    "default": "User",
                    "en-gb": "User"
                  }
                },
                {
                  "value": "Flow",
                  "text": {
                    "default": "Flow",
                    "en-gb": "Flow"
                  }
                },
                {
                  "value": "Extra Flow",
                  "text": {
                    "default": "Extra Flow",
                    "en-gb": "Extra Flow"
                  }
                }
              ]
            },
            {
              "name": "mode",
              "title": {
                "default": "Mode",
                "en-gb": "Mode"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Attended",
                  "text": {
                    "default": "Attended",
                    "en-gb": "Attended"
                  }
                },
                {
                  "value": "Unattended",
                  "text": {
                    "default": "Unattended",
                    "en-gb": "Unattended"
                  }
                },
                {
                  "value": "Cloud",
                  "text": {
                    "default": "Cloud",
                    "en-gb": "Cloud"
                  }
                }
              ]
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "en-gb": "Price"
              },
              "cellType": "expression",
              "expression": "getItemPrice()",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "customPrice",
              "title": {
                "default": "Price",
                "en-gb": "Price"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "en-gb": "Quantity"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "en-gb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows.",
            "en-gb": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows."
          }
        },
        {
          "type": "expression",
          "name": "powerPlatformCost",
          "title": {
            "default": "Power Platform license cost yearly",
            "en-gb": "Power Platform license cost yearly"
          },
          "expression": "{items-total.total}*12",
          "displayStyle": "currency"
        },
        {
          "name": "otherCosts",
          "type": "boolean",
          "title": {
            "default": "Include other costs",
            "en-gb": "Include other costs"
          },
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "otherItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "en-gb": "Add new item"
          },
          "visibleIf": "{otherCosts}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "en-gb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Migration",
                  "text": {
                    "default": "Migration",
                    "en-gb": "Migration"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "en-gb": "Infrastructure"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "en-gb": "Amount"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "en-gb": "Monthly"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": true,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "otherTotal",
              "title": {
                "default": "Total",
                "en-gb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "expression",
          "title": {
            "default": "Difference yearly",
            "en-gb": "Difference yearly"
          },
          "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}