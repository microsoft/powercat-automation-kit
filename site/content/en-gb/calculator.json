{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "en-gb": "What scenario are you trying to calculate?"
          },
          "choices": []
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "en-gb": "What sample scenario did you want to explore?"
          },
          "choices": []
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "en-gb": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner."
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "en-gb": "Migration Parameters"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-bots",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many bots to migrate?",
            "en-gb": "How many bots to migrate?"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended bots?",
            "en-gb": "Percentage of attended bots?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "en-gb": "A value between 0 and 100"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended bots?",
            "en-gb": "Percentage of unattended bots?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "en-gb": "A value between 0 and 100"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": "Add new group",
          "title": {
            "default": "Migration Groups",
            "en-gb": "Migration Groups"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "en-gb": "Migration Group Name"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "en-gb": "Description"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "en-gb": "Groups"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": "Add new item",
          "title": {
            "default": "Duration Plan",
            "en-gb": "Duration Plan"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "en-gb": "Complexity"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": []
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "en-gb": "Group"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "en-gb": "Percentage"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "Bots",
              "title": {
                "default": "Bots",
                "en-gb": "Bots"
              },
              "cellType": "expression",
              "expression": "botTotal({row})"
            },
            {
              "name": "botsPerMonth",
              "title": {
                "default": "Bots per month",
                "en-gb": "Bots per month"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "en-gb": "Total (Business Days)"
              },
              "cellType": "expression",
              "expression": "migrationTotal({row})"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Bots per Month and Total business days for migration will need to be determined for the specific bots being migrated.",
            "en-gb": "NOTE: The values are for illustration purposes only and Ramp Time, Bots per Month and Total business days for migration will need to be determined for the specific bots being migrated."
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "en-gb": "Automatically calculate possible migration plan?"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": "Add new item",
          "title": {
            "default": "Migration Plan",
            "en-gb": "Migration Plan"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "en-gb": "Name"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "en-gb": "Low"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "en-gb": "Medium"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "en-gb": "High"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "en-gb": "Attended"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "en-gb": "Unattended"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "en-gb": "Tell me more about each license type"
          },
          "defaultValue": false
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "en-gb": "Select plans you want more information on"
          },
          "src": "/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "en-gb": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>"
          }
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Use retail price",
            "en-gb": "Use retail price"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": "Add new item",
          "columns": [
            {
              "name": "service",
              "title": {
                "default": "Service",
                "en-gb": "Service"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "totalFormat": "Items count: {0}",
              "choices": []
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "en-gb": "Price"
              },
              "cellType": "expression",
              "expression": "getItemPrice('service')",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "price-manual",
              "title": {
                "default": "Price",
                "en-gb": "Price"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "en-gb": "Quantity"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "en-gb": "Total"
              },
              "cellType": "expression",
              "expression": "iif({retailPrice},{row.quantity} * {row.price},{row.quantity} * {row.price-manual})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "total",
          "type": "expression",
          "title": {
            "default": "Total",
            "en-gb": "Total"
          },
          "expression": "{orderList-total.total}",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}