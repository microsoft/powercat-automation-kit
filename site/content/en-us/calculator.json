{
    "showQuestionNumbers": "off",
    "pages": [
        {
            "name": "welcome",
            "visibleIf": "{preview} = true",
            "elements": [
                {
                    "type": "radiogroup",
                    "name": "scenario",
                    "title": "What scenario are you trying to calculate?",
                    
                    "choices": [
                        {
                            "value": "calculator",
                            "text": "Power Automate / Power Automate Desktop license cost"
                        },
                        {
                            "value": "migration-planner",
                            "text": "Migration planner"
                        },
                        {
                            "value": "samples",
                            "text": "Sample scenarios"
                        }
                    ]
                },
                {
                    "type": "radiogroup",
                    "name": "sample-scenario",
                    "visibleIf": "{scenario} = 'samples'",
                    "title": "What sample scenario did you want to explore?",
                    "choices": [
                        {
                            "value": "migration-single-unattended",
                            "text": "Migration of a single unattended bot running isolated from other bot process"
                        },
                        {
                            "value": "migration-200",
                            "text": "Migration of hundreds of bots"
                        },
                        {
                            "value": "process-mining",
                            "text": "Using Process Advisor to identify Process automation"
                        },
                        {
                            "value": "task-mining",
                            "text": "Using Process Advisor task mining to analyze and improve bot reliability"
                        }
                    ]
                },
                {
                    "type": "html",
                    "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
                    "html": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner."
                }
            ]
        },
        {
            "name": "migration",
            "title": "Migration Parameters",
            "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
            "elements": [
                {
                    "name": "how-many-automation-projects",
                    "type": "text",
                    "inputType": "number",
                    "title": "How many automation projects to migrate?",
                    "isRequired": true
                },
                {
                    "name": "attended-percentage",
                    "type": "text",
                    "inputType": "number",
                    "title": "Percentage of attended automation projects?",
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "expression",
                            "text": "A value between 0 and 100",
                            "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
                        }
                    ]
                },
                {
                    "name": "unattended-percentage",
                    "type": "text",
                    "inputType": "number",
                    "title": "Percentage of unattended automation projects?",
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "expression",
                            "text": "A value between 0 and 100",
                            "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
                        }
                    ]
                },
                {
                    "type": "matrixdynamic",
                    "name": "migration-groups",
                    "titleLocation": "none",
                    "addRowText": "Add new group",
                    "title": "Migration Groups",
                    "columns": [
                        {
                            "name": "name",
                            "title": "Migration Group Name",
                            "cellType": "text"
                        },
                        {
                            "name": "description",
                            "title": "Description",
                            "cellType": "text"
                        }
                    ]
                },
                {
                    "name": "groups",
                    "type": "checkbox",
                    "title": "Groups",
                    "visibleIf": "false",
                    "choices": []
                },
                {
                    "type": "matrixdynamic",
                    "name": "migration-times",
                    "titleLocation": "none",
                    "addRowText": "Add new item",
                    "title": "Duration Plan",
                    "columns": [
                        {
                            "name": "complexity",
                            "title": "Complexity",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "inputType": "count",
                            "choices": [
                                {
                                    "value": "low",
                                    "text": "Low"
                                },
                                {
                                    "value": "medium",
                                    "text": "Medium"
                                },
                                {
                                    "value": "high",
                                    "text": "High"
                                }
                            ]
                        },
                        {
                            "name": "group",
                            "title": "Group",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "choicesFromQuestion": "groups"
                        },
                        {
                            "name": "percentage",
                            "title": "Percentage",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "projects",
                            "title": "Projects",
                            "cellType": "expression",
                            "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
                        },
                        {
                            "name": "projectsPerMonth",
                            "title": "Projects per month",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "total",
                            "title": "Total (Business Days)",
                            "cellType": "expression",
                            "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated."
                },
                {
                    "type": "boolean",
                    "name": "calc-migration-plan",
                    "title": "Automatically calculate possible migration plan?",
                    "defaultValue": true
                },
                {
                    "type": "matrixdynamic",
                    "name": "migration-plan",
                    "titleLocation": "none",
                    "addRowText": "Add new item",
                    "title": "Migration Plan",
                    "columns": [
                        {
                            "name": "name",
                            "title": "Name",
                            "cellType": "text"
                        },
                        {
                            "name": "low",
                            "title": "Low",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "medium",
                            "title": "Medium",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "high",
                            "title": "High",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "attended",
                            "title": "Attended",
                            "cellType": "text",
                            "inputType": "number"
                        },
                        {
                            "name": "unattended",
                            "title": "Unattended",
                            "cellType": "text",
                            "inputType": "number"
                        }
                    ]
                }
            ]
        },
        {
            "name": "calculation",
            "elements": [
                {
                    "name": "tellMeMore",
                    "type": "boolean",
                    "title": "Tell me more about each license type",
                    "defaultValue": true
                },
                {
                    "name": "matrix-image",
                    "type": "image-task",
                    "visibleIf": "{tellMeMore} == true",
                    "title": "Select plans you want more information on",
                    "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
                },
                {
                    "type": "html",
                    "html": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>"
                },
                {
                    "name": "includeCurrentCost",
                    "title": "Include current costs",
                    "isRequired": true,
                    "type": "boolean",
                    "defaultValue": false
                },
                {
                    "type": "matrixdynamic",
                    "name": "currentItems",
                    "rowCount": 1,
                    "minRowCount": 1,
                    "titleLocation": "none",
                    "addRowText": "Add new item",
                    "visibleIf": "{includeCurrentCost}",
                    "columns": [
                        {
                            "name": "type",
                            "title": "Type",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "choices": [
                                "Makers",
                                "Licenses",
                                "Infrastructure"
                            ]
                        },
                        {
                            "name": "amount",
                            "title": "Amount",
                            "isRequired": true,
                            "cellType": "text",
                            "inputType": "number",
                            "min": 1
                        },
                        {
                            "name": "cost",
                            "title": "Cost",
                            "isRequired": true,
                            "displayStyle": "currency",
                            "cellType": "text",
                            "inputType": "number",
                            "min": 1
                        },
                        {
                            "name": "monthly",
                            "title": "Monthly",
                            "isRequired": true,
                            "cellType": "boolean",
                            "defaultValue": false,
                            "labelTrue": "Monthly",
                            "labelFalse": "Yearly"
                        },
                        {
                            "name": "currentTotal",
                            "title": "Total",
                            "cellType": "expression",
                            "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
                            "displayStyle": "currency",
                            "totalType": "sum",
                            "totalDisplayStyle": "currency",
                            "totalFormat": "Total: {0}"
                        }
                    ]
                },
                {
                    "name": "retailPrice",
                    "type": "boolean",
                    "title": "Power Platform license costs monthly",
                    "labelTrue": "Retail price",
                    "labelFalse": "Custom price",
                    "defaultValue": true
                },
                {
                    "type": "matrixdynamic",
                    "name": "items",
                    "rowCount": 1,
                    "minRowCount": 1,
                    "titleLocation": "none",
                    "addRowText": "Add new item",
                    "columns": [
                        {
                            "name": "type",
                            "title": "Type",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "choices": [
                                "Trial",
                                "User",
                                "Flow",
                                "Extra Flow"
                            ]
                        },
                        {
                            "name": "mode",
                            "title": "Mode",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "choices": [
                                "Attended",
                                "Unattended",
                                "Cloud"
                            ]
                        },
                        {
                            "name": "price",
                            "title": "Price",
                            "cellType": "expression",
                            "expression": "getItemPrice()",
                            "displayStyle": "currency",
                            "visibleIf": "{retailPrice} == true"
                        },
                        {
                            "name": "customPrice",
                            "title": "Price",
                            "cellType": "text",
                            "inputType": "number",
                            "displayStyle": "currency",
                            "visibleIf": "{retailPrice} == false"
                        },
                        {
                            "name": "quantity",
                            "title": "Quantity",
                            "isRequired": true,
                            "cellType": "text",
                            "inputType": "number",
                            "totalType": "sum",
                            "totalFormat": "Total services: {0}",
                            "min": 1
                        },
                        {
                            "name": "total",
                            "title": "Total",
                            "cellType": "expression",
                            "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
                            "displayStyle": "currency",
                            "totalType": "sum",
                            "totalDisplayStyle": "currency",
                            "totalFormat": "Total: {0}"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows."
                },
                {
                    "type": "expression",
                    "name": "powerPlatformCost",
                    "title": "Power Platform license cost yearly",
                    "expression": "{items-total.total}*12",
                    "displayStyle": "currency"
                },
                {
                    "name": "otherCosts",
                    "type": "boolean",
                    "title": "Include other costs",
                    "defaultValue": false
                },
                {
                    "type": "matrixdynamic",
                    "name": "otherItems",
                    "rowCount": 1,
                    "minRowCount": 1,
                    "titleLocation": "none",
                    "addRowText": "Add new item",
                    "visibleIf": "{otherCosts}",
                    "columns": [
                        {
                            "name": "type",
                            "title": "Type",
                            "isRequired": true,
                            "cellType": "dropdown",
                            "choices": [
                                "Migration",
                                "Infrastructure"
                            ]
                        },
                        {
                            "name": "amount",
                            "title": "Amount",
                            "isRequired": true,
                            "cellType": "text",
                            "inputType": "number",
                            "min": 1
                        },
                        {
                            "name": "monthly",
                            "title": "Monthly",
                            "isRequired": true,
                            "cellType": "boolean",
                            "defaultValue": true,
                            "labelTrue": "Monthly",
                            "labelFalse": "Yearly"
                        },
                        {
                            "name": "otherTotal",
                            "title": "Total",
                            "cellType": "expression",
                            "expression": "{row.amount} * iif({row.monthly},12,1)",
                            "displayStyle": "currency",
                            "totalType": "sum",
                            "totalDisplayStyle": "currency",
                            "totalFormat": "Total: {0}"
                        }
                    ]
                },
                {
                    "type": "expression",
                    "title": "Difference yearly",
                    "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
                    "displayStyle": "currency"
                }
            ]
        }
    ]
}