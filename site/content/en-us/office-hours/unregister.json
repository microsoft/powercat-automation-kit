{
    "checkErrorsMode": "onValueChanging",
    "completedHtml": "Thank you for completing unregistration",
    "triggers": [
        {
            "type": "setvalue",
            "expression": "{register-email.length} > 0",
            "setToName": "code",
            "setValue": "Office-Hours-Unregister"
        }
    ],
    "pages": [
        {
            "elements": [
                {
                    "type": "checkbox",
                    "name": "reason",
                    "title": "(Optional) Your feedback helps us improve. Which of the following are reason(s) that you are unregistering?",
                    "isRequired": false,
                    "hasOther": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "Not sure",
                            "text": "Not sure"
                        },
                        "The time does not work",
                        "No longer relevant",
                        "Too technical",
                        "Not enough business focus"
                    ]
                },
                {
                    "type": "text",
                    "name": "register-name",
                    "title": "The name that you registered with"
                },
                {
                    "type": "text",
                    "inputMask": "email",
                    "name": "register-email",
                    "title": "The email address your registered with",
                    "isRequired": true,
                    "validators": [  
                        {  
                            "type": "email"  
                        }  
                    ] 
                },                
                {
                    "type": "feedback-task",
                    "name": "send-results",
                    "title": "Send your unregistration now?",
                    "destination": "https://aka.ms/ak4pp-feedback2"
                },
                {
                    "type": "html",
                    "visibleIf": "{send-results-status.length} > 0",
                    "html": "Status: {send-results-status}"
                }
            ]
        }
    ]
}