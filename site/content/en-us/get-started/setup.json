{
    "showQuestionNumbers": "off",
    "checkErrorsMode": "onValueChanging",
    "pages": [
        {
            "name": "welcome",
            "title": "Welcome",
            "elements": [
                {
                    "type": "checkbox",
                    "name": "installType",
                    "title": "What component(s) are you looking to setup?",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        "Main solution",
                        "Satellite solution",
                        "Security Group Setup"
                    ]
                },
                {
                    "type": "html",
                    "visibleIf": "contains({installType}, 'Main solution')",
                    "html": "Will collect connection information for Main solution deployment. The main solution manages and monitors metered Power Automate Desktop solutions. Normally there will be one Main solution deployment per Power Platform tenant"
                },
                {
                    "type": "html",
                    "visibleIf": "contains({installType}, 'Satellite solution')",
                    "html": "Will collect information required to setup a monitored Power Platform environment. Power Automate cloud flows to centralize information with the central main solution Automation Kit environment. Normally there will be multiple satellite solution deployments per Power Platform tenant"
                },
                {
                    "type": "html",
                    "visibleIf": "contains({installType}, 'Security Group Setup')",
                    "html": "Configure users / groups that should be assigned to security groups for Administration, Contribution and View permissions for Automation projects"
                }
            ]
        },
        {
            "title": "Main Solution - Prerequisites",
            "name": "prereqTest1",
            "visibleIf": "contains({installType}, 'Main solution')",
            "elements": [
                {
                    "type": "checkbox",
                    "name": "prereqTest1",
                    "title": "Verify that the following has been setup for the environment you will install the Automation Kit Main solution",
                    "choices": [
                        "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
                        "I DO NOT have environment administrator rights",
                        "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
                        "The environment DLP policy allows for following connectors [Approvals](https://learn.microsoft.com/en-us/connectors/approvals/), [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
                        "'Power Apps Per User', 'Per App' or 'Pays as you go' license for users who will be Administrators, Contributors or viewers of Automation Projects",
                        "Office E3 license or above for Office 365 Outlook connection used by Cloud Flow",
                        "Download of free [Power BI Desktop](https://powerbi.microsoft.com/en-us/desktop/) or [Power BI Premium](https://powerbi.microsoft.com/en-us/power-bi-premium/) to share your dashboard inside your organization"
                    ]
                },
                {
                    "type": "html",
                    "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights')",
                    "html": "You will need to have have an environment admin enable <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>PowerApps component framework feature</a>. If you have PowerApps component framework feature enabled you do not need environment administrator rights."
                },
                {
                    "type": "boolean",
                    "name": "isSystemCustomizer",
                    "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights')",
                    "title": "Are you a member of the System Customizer role for the environment?"
                },
                {
                    "type": "html",
                    "visibleIf": "contains({prereqTest1}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false",
                    "html": "You will need need to have a minimum of System Customizer to import the Automation Kit solutions"
                }
            ]
            
        },
        {
            "title": "Main Solution",
            "visibleIf": "contains({installType}, 'Main solution')",
            "elements": [
                {
                    "name": "main-instanceUrl",
                    "type": "text",
                    "title": "Copy instance url",
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid environment instance url like https://contoso.crm.dyanamics.com/",
                            "regex": "https://([-a-z0-9].*?)\\.crm(.*?)\\.dynamics\\.com/"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "Get the instance url from <a href='https://make.powerapps.com' target='blank'>http://make.powerapps.com</a> Settings -> Session details dialog"
                },
                {
                    "type": "markdown",
                    "title": "Installation home link Notes",
                    "markdown": "To obtain the the install environment parameters, visit <a href='https://make.powerapps.com' target='blank'>http://make.powerapps.com</a> select the **home icon** for your environment you want to install main solution components into"
                },
                {
                    "name": "main-installEnvironment",
                    "type": "text",
                    "title": "Copy Install Environment home link",
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform environment starting with https://make.powerapps.com",
                            "regex": "^https:\\/(.*?).powerapps.com\\/environments\\/([a-zA-Z0-9\\-].*?)\\/home"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "This environment could be the same environment as the CoE Kit."
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_approvals",
                    "environment": "main-installEnvironment"
                },
                {
                    "name": "main-approvalConnection",
                    "type": "text",
                    "title": "Copy Approval Connection details page link here",
                    "isRequired": true,
                    "startWithNewLine": false,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_approvals/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Approvals connector is used to approve or deny Automation Project requests"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_commondataserviceforapps",
                    "environment": "main-installEnvironment"
                },
                {
                    "name": "main-dataverseConnection",
                    "type": "text",
                    "title": "Copy Microsoft Dataverse Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Dataverse connector is used to store your Automation Kit project and telemetry data"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_office365",
                    "environment": "main-installEnvironment"
                },
                {
                    "name": "main-office365OutlookConnection",
                    "type": "text",
                    "title": "Copy Office 365 Outlook Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Office 365 connector is used to send emails as part of the Automation Kit management process"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_office365users",
                    "environment": "main-installEnvironment"
                },
                {
                    "name": "main-office365UserConnection",
                    "type": "text",
                    "title": "Copy Office 365 User Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Office 365 users connector is used to query user information from the Office 365 graph"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_powerplatformforadmins",
                    "environment": "main-installEnvironment"
                },
                {
                    "name": "main-powerPlatformAdminConnection",
                    "type": "text",
                    "title": "Copy Power Platform for Admins Automation Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Power Platform for Admins Automation connector is used to query information about your deployed solutions"
                }
            ]
        },
        {
            "title": "Main Solution - Options",
            "visibleIf": "contains({installType}, 'Main solution')",
            "elements": [
                {
                    "type": "text",
                    "name": "main-businessApprover",
                    "isRequired": true,
                    "inputMask": "email",
                    "title": "What is the email address of the default approver?",
                    "validators": [
                        {
                          "type": "email"
                        }
                    ]
                },
                {
                    "type": "boolean",
                    "name": "main-installSampleData",
                    "isRequired": true,
                    "title": "Import sample data after main solution is setup?"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-installSampleData} == true",
                    "html": "Sample Corporate Goals, Automation Projects and telemetry data will be imported"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-installSampleData} == false",
                    "html": "Only base data required for solution will be imported"
                },
                {
                    "type": "boolean",
                    "name": "main-enableROIFlow",
                    "isRequired": true,
                    "title": "Enable Return on Investment (ROI) Power Automate cloud flow?"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableROIFlow} == true",
                    "html": "The ROI cloud flow will be enabled so that complexity and ROI are calculated when Automation Projects are inserted or updated"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableROIFlow} == false",
                    "html": "You can enable the ROI cloud flow after update"
                },
                {
                    "type": "boolean",
                    "name": "main-enableApprovalFlow",
                    "isRequired": true,
                    "title": "Enable Approval Power Automate cloud flow?"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableApprovalFlow} == true",
                    "html": "The Approval cloud flow will be enabled so that approval requests are sent to approvers"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableApprovalFlow} == false",
                    "html": "You can enable the Approval cloud flow after update"
                },
                {
                    "type": "boolean",
                    "name": "main-enableSyncFlow",
                    "isRequired": true,
                    "title": "Enable Synchronization of Automation Kit data between environments?"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableSyncFlow} == true",
                    "html": "The Synchronization cloud flow will be enabled so data is sychronized with satellite environments"
                },
                {
                    "type": "html",
                    "visibleIf": "{main-enableSyncFlow} == false",
                    "html": "You can enable the Synchronization cloud flow after update"
                }
            ]
        },
        {
            "title": "Main Solution - Security Group Setup",
            "visibleIf": "contains({installType}, 'Main solution') and contains({installType}, 'Security Group Setup')",
            "elements": [
                {
                    "type": "paneldynamic",
                    "name": "main-administrators",
                    "title": "Please add Automation Kit members for the Automation Administrators Security Group",
                    "templateElements": [
                        {
                            "name": "user",
                            "type": "text",
                            "inputMask": "email",
                            "title": "User or group email address",
                            "isRequired": true,
                            "validators": [
                                {
                                    "type": "email",
                                    "text": "Value must be a valid email address"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paneldynamic",
                    "name": "main-contributors",
                    "title": "Please add Automation Kit contributors that can view and edit Automation Projects",
                    "templateElements": [
                        {
                            "name": "user",
                            "type": "text",
                            "inputMask": "email",
                            "title": "User or group email address",
                            "isRequired": true,
                            "validators": [
                                {
                                    "type": "email",
                                    "text": "Value must be a valid email address"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paneldynamic",
                    "name": "main-viewers",
                    "title": "Please add Automation Kit contributors that can review and view Automation Projects",
                    "templateElements": [
                        {
                            "name": "user",
                            "type": "text",
                            "title": "User or group email address",
                            "isRequired": true,
                            "inputMask": "email",
                            "validators": [
                                {
                                    "type": "email",
                                    "text": "Value must be a valid email address"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "visibleIf": "contains({installType}, 'Main solution')",
            "elements": [
                {
                    "type": "html",
                    "html": "Use the download button below to obtain your main configuration file that will be used to customize your deployment"
                },
                {
                    "type": "download-task",
                    "title": "Download results",
                    "text": "Download",
                    "name": "downloadResults",
                    "fileName": "automation-kit-main-install.json",
                    "filter": "main"
                }
            ]
        },
        {
            "title": "Satellite Solution - Prerequisites",
            "visibleIf": "contains({installType}, 'Satellite solution')",
            "elements": [
                {
                    "type": "checkbox",
                    "name": "prereqTest2",
                    "title": "Verify that the following has been setup for the environment you will install the Automation Kit Satellite solution",
                    "choices": [
                        "You have have environment administrator rights so we can enable [PowerApps component framework feature](https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature)",
                        "I DO NOT have environment administrator rights",
                        "[Install Microsoft Power Platform CLI](https://learn.microsoft.com/power-platform/developer/cli/introduction#install-microsoft-power-platform-cli)",
                        "The environment DLP policy allows for the following connectors [Microsoft Dataverse](https://learn.microsoft.com/en-us/connectors/commondataserviceforapps/), [Microsoft Dataverse (Legacy)](https://learn.microsoft.com/en-us/connectors/commondataservice/), [Office 365 Outlook](https://learn.microsoft.com/en-us/connectors/office365/), [Office 365 Users](https://learn.microsoft.com/en-us/connectors/office365users/), [Power Automate Management](https://learn.microsoft.com/en-us/connectors/flowmanagement/) and [Power Platform for Admins](https://learn.microsoft.com/en-us/connectors/powerplatformforadmins/)",
                        "A Azure Application Registration",
                        "Configured Azure Application API Permissions",
                        "Configured Azure Application ClientId and Secret",
                        "An Azure Key Vault to store the ClientId, Secret and Tenant Id"
                    ]
                },
                {
                    "type": "html",
                    "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights')",
                    "html": "You will need to have have an environment admin enable <a href='https://learn.microsoft.com/power-apps/developer/component-framework/component-framework-for-canvas-apps#enable-the-power-apps-component-framework-feature' target='blank'>PowerApps component framework feature</a>. If you have PowerApps component framework feature enabled you do not need environment administrator rights."
                },
                {
                    "type": "boolean",
                    "name": "isSystemCustomizer",
                    "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights')",
                    "title": "Are you a member of the System Customizer role for the environment?"
                },
                {
                    "type": "html",
                    "visibleIf": "contains({prereqTest2}, 'I DO NOT have environment administrator rights') and {isSystemCustomizer} = false",
                    "html": "You will need need to have a minimum of System Customizer to import the Automation Kit solutions"
                },
                {
                    "type": "html",
                    "html": "Read more in <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='blank'>Automation Kit Prerequisites</a>"
                }
            ]
        },
        {
            "title": "Satellite Solution - Connections",
            "visibleIf": "contains({installType}, 'Satellite solution')",
            "elements": [
                {
                    "type": "html",
                    "html": "For the install environment visit <a href='https://make.powerapps.com' target='blank'>make.powerapps.com</a> select the home icon for your environment you want to install the Automation Kit components into"
                },
                {
                    "name": "satellite-installEnvironment",
                    "type": "text",
                    "title": "Copy Install Environment home link",
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform environment starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/home)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "<b>NOTE:</b> This environment MUST be the different than the main environment."
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_commondataservice",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-dataverseLegacyConnection",
                    "type": "text",
                    "title": "Copy Microsoft Dataverse (Legacy) Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataservice/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Dataverse Legacy connector is used to connect to your main Dataverse environment"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_commondataserviceforapps",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-dataverseConnection",
                    "type": "text",
                    "title": "Copy Microsoft Dataverse Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_commondataserviceforapps/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Dataverse connector is used to store your Automation Kit project and telemetry data"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_flowmanagement",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-flowManagementConnection",
                    "type": "text",
                    "title": "Copy Flow Management Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_flowmanagement/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Flow Management connector is used to query Power Automate flows in the environment"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_office365",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-office365OutlookConnection",
                    "type": "text",
                    "title": "Copy Office 365 Outlook Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Office 365 connector is used to send emails as part of the Automation Kit management process"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_office365users",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-office365UserConnection",
                    "type": "text",
                    "title": "Copy Office 365 User Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_office365users/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Office 365 users connector is used to query user information from the Office 365 graph"
                },
                {
                    "type": "create-connection",
                    "title": "Create",
                    "connector": "shared_powerplatformforadmins",
                    "environment": "satellite-installEnvironment"
                },
                {
                    "name": "satellite-powerPlatformAdminConnection",
                    "type": "text",
                    "title": "Copy Power Platform for Admins Automation Connection details page link here",
                    "startWithNewLine": false,
                    "isRequired": true,
                    "validators": [
                        {
                            "type": "regex",
                            "text": "Must be a valid Power Platform connection link starting with https://make.powerapps.com",
                            "regex": "^(https://(.*?).powerapps.com/environments/)([a-zA-Z0-9\\-].*?)(/connections/shared_powerplatformforadmins/)[a-zA-Z0-9]{32,32}(/details.*)"
                        }
                    ]
                },
                {
                    "type": "html",
                    "html": "The Power Platform for Admins Automation connector is used to query information about your deployed solutions"
                }
            ]
        },
        {
            "title": "Satellite Solution - Environment Variables",
            "visibleIf": "contains({installType}, 'Satellite solution')",
            "elements": [
                {
                    "type": "html",
                    "html": "Follow [Environment Variable Setup Guide](https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/environment-variables) to obtain the values for the items below"
                },
                {
                    "name": "satellite-azureKeyVaultClientId",
                    "type": "text",
                    "title": "AKV Client Id Secret",
                    "isRequired": true
                },
                {
                    "name": "satellite-azureKeyVaultClientSecret",
                    "type": "text",
                    "title": "AKV Client Secret Secret",
                    "isRequired": true
                },
                {
                    "name": "satellite-azureKeyVaultTenantIdSecret",
                    "type": "text",
                    "title": "AKV Tenant Id Secret",
                    "isRequired": true
                },
                {
                    "name": "satellite-automationCoEAlertEmailRecipient",
                    "type": "text",
                    "title": "Automation CoE Alert Email Recipient",
                    "isRequired": true
                },
                {
                    "name": "satellite-automationProjectAppId",
                    "type": "text",
                    "title": "Automation Project app Id",
                    "isRequired": true
                },
                {
                    "name": "satellite-desktopFlowsBaseUrl",
                    "type": "text",
                    "title": "Desktop Flows Base URL",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentId",
                    "type": "text",
                    "title": "Environment Id",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentName",
                    "type": "text",
                    "title": "Environment Name",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentRegion",
                    "type": "text",
                    "title": "Environment Region",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentUniqueName",
                    "type": "text",
                    "title": "Environment Unique Name",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentUniqueNameMain",
                    "type": "text",
                    "title": "Environment Unique Name (Automation Kit Main)",
                    "isRequired": true
                },
                {
                    "name": "satellite-environmentUrl",
                    "type": "text",
                    "title": "Environment Url",
                    "isRequired": true
                },
                {
                    "name": "satellite-flowSessionTraceRecordOwnerId",
                    "type": "text",
                    "title": "Flow Session Trace Record Owner Id",
                    "isRequired": true
                }
            ]
        },
        {
            "title": "Satellite Solution - Options",
            "visibleIf": "contains({installType}, 'Satellite solution')",
            "elements": [
                {
                    "type": "boolean",
                    "name": "satellite-storeFlowScript",
                    "isRequired": true,
                    "valueTrue": "Yes",
                    "valueFalse": "No",
                    "title": "Store the extracted Power Automate Desktop script in Dataverse?"
                },
                {
                    "type": "html",
                    "visibleIf": "{satellite-storeFlowScript} == true",
                    "html": "Will <b>store</b> Desktop flows definition script inside the Desktop Flow Definition table. This field could contain sensitive information"
                },
                {
                    "type": "html",
                    "visibleIf": "{satellite-storeFlowScript} == false",
                    "html": "Will <b>NOT</b> Desktop flows definition script inside the Desktop Flow Definition table. NOTE: This field could contain sensitive information"
                },
                {
                    "type": "boolean",
                    "name": "satellite-activateAllCloudFlows",
                    "isRequired": true,
                    "title": "Enable satellite flows?"
                },
                {
                    "type": "html",
                    "visibleIf": "{satellite-activateAllCloudFlows} == true",
                    "html": "Will enable Cloud flows that are included in the Automation Kit Satellite solution"
                },
                {
                    "type": "text",
                    "name": "satellite-azureAppId",
                    "isRequired": true,
                    "title": "What is the Azure Application Id to register as Application User?"
                }
            ]
        },
        {
            "visibleIf": "contains({installType}, 'Satellite solution')",
            "elements": [
                {
                    "type": "html",
                    "html": "Use the download button below to obtain your satellite configuration file that will be used to customize your deployment"
                },
                {
                    "type": "download-task",
                    "title": "Download results",
                    "text": "Download",
                    "name": "downloadResults",
                    "fileName": "automation-kit-satellite-install.json",
                    "filter": "satellite"
                }
            ]
        }
    ]
}