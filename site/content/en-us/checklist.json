{
    "triggers": [
        {
            "type": "setvalue",
            "expression": "contains({roles},['All', 'Center Of Excellence']) = false",
            "setToName": "non-technical",
            "setValue": true
        },
        {
            "type": "setvalue",
            "expression": "{send-results} = true",
            "setToName": "code",
            "setValue": "Feedback-Get-Started-Checklist"
        }
    ],
    "pages": [
        {
            "name": "welcome",
            "elements": [
                {
                    "type": "checkbox",
                    "name": "roles",
                    "title": "Which of the following role(s) are the best match for you?",
                    "isRequired": true,
                    "colCount": 2,
                    "choices": [
                        "Goal Setter",
                        "Process Owner",
                        "Reviewer",
                        "Center Of Excellence",
                        "Administrator",
                        "Compliance",
                        "Information Security",
                        "Audit",
                        "All"
                    ]
                },
                {
                    "name": "roleNotSure",
                    "type": "boolean",
                    "title": "Not sure of roles, tell me more about selected items",
                    "defaultValue": false
                },
                {
                    "type": "html",
                    "html": "<b>Goal Setter</b> - This could be a Corporate or Department decision maker role <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#automation-lifecycle' target='_blank'>Learn More</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Goal Setter','All'])"
                },
                {
                    "type": "html",
                    "html": "<b>Process Owner</b> - Creates the Automation Projects in the system <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#automation-lifecycle' target='_blank'>Learn More</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Process Owner','All'])"
                },
                {
                    "type": "html",
                    "html": "<b>Reviewer</b> - Validates idea to approve that the idea should be implemented and is justifiable <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#automation-lifecycle' target='_blank'>Learn More</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Reviewer','All'])"
                },
                {
                    "type": "html",
                    "html": "<b>Center Of Excellence</b> - Sets up and maps solution to a specific environment <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#automation-lifecycle' target='_blank'>Learn More</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Center Of Excellence','All'])"
                },
                {
                    "type": "html",
                    "html": "<b>Administrator</b> - May set Power Platform environment management and creation of Data Loss Prevention (DLP) policies that need to be put in place for the organization to scale <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#power-platform-and-microsoft-365-coes' target='_blank'>Learn More</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Administrator','All'])"
                },
                {
                    "type": "html",
                    "html": "<b>Compliance, Information Security, Audit</b> - Set the corporate rules, regulations, cyber-security, data privacy, and auditing requirements as part of <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/overview/automation-coe-strategy#corporate-automation-strategy' target='_blank'>Corporate automation strategy</a>",
                    "visibleIf": "({roleNotSure} = true) and contains({roles},['Compliance', 'Information Security', 'Audit','All'])"
                },
                {
                    "type": "radiogroup",
                    "name": "checkInstalled",
                    "title": "Does you organization have the Automation Kit for Power Platform installed?",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        "Yes",
                        "No",
                        "Not Sure"
                    ],
                    "visibleIf": "{roles} notempty"
                },
                {
                    "type": "html",
                    "html": "Great you can review the <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/use-automation-kit' target='_blank'>Use the Automation Kit</a> for more information",
                    "visibleIf": "{checkInstalled}='Yes'"
                },
                {
                    "type": "checkbox",
                    "name": "technicalNotInstalled",
                    "title": "Ok the Automation Kit is not installed, what technical task do you need help with?",
                    "isRequired": true,
                    "colCount": 4,
                    "choices": [
                        "Help with install",
                        "Setup instructions",
                        "Further support"
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "checkbox",
                    "name": "otherNotInstalled",
                    "title": "Ok the Automation Kit is not installed, what do you need help with?",
                    "isRequired": true,
                    "colCount": 4,
                    "choices": [
                        "Help with install",
                        "Further support"
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = false"
                },
                {
                    "type": "html",
                    "html": "Start by reviewing the install <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/prerequisites' target='_blank'>prerequisites</a> for more information",
                    "visibleIf": "contains({technicalNotInstalled},['Help with install', 'Setup instructions']) and contains({roles},['Center Of Excellence','All'])"
                },
                {
                    "type": "html",
                    "html": "Contact your Center of Excellence to install or check if Automation Kit is installed",
                    "visibleIf": "contains({otherNotInstalled},['Help with install'])"
                },
                {
                    "type": "html",
                    "html": "If you are looking to trial the Automation Kit to determine how it works and what value it can provide you could try a Non production install using the <a href='/get-started/install-checklist' target='_blank'>Install checklist</a> to rapidly get started",
                    "visibleIf": "contains({otherNotInstalled},['Help with install'])"
                },
                {
                    "type": "html",
                    "html": "Review walkthrough install videos <a href='https://github.com/microsoft/powercat-automation-kit/blob/main/docs/walkthrough.md' target='_blank'>learn more</a>",
                    "visibleIf": "contains({technicalNotInstalled},['Help with install'])"
                },
                {
                    "type": "html",
                    "html": "Review our <a href='/support' target='_blank'>support</a> page for more information",
                    "visibleIf": "contains({technicalNotInstalled},['Further support']) or contains({otherNotInstalled},['Further support'])"
                },
                {
                    "type": "checkbox",
                    "name": "technical-Azure",
                    "title": "Check the best Azure option(s) that apply to you",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "aad",
                            "text": "I have rights to create Azure Active Directory application"
                        },
                        {
                            "value": "azure-create",
                            "text": "I can create Azure resources (For example Azure Key Vault)"
                        },
                        {
                            "value": "azure-delegate",
                            "text": "I need to work with Azure team to create resources for me"
                        },
                        {
                            "value": "azure-contributor-aad",
                            "text": "I have owner or contributor rights Azure Active Directory App"
                        },
                        {
                            "value": "azure-contributor-kv",
                            "text": "I have owner or contributor rights Azure Key Vault"
                        }
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "html",
                    "html": "Azure pre-requistes met",
                    "visibleIf": "contains({technical-Azure},['azure-create','azure-contributor-aad','azure-contributor-kv','azure-delegate']) and contains({technical-Azure},['aad','azure-contributor-aad']) and contains({technical-Azure},['azure-create','azure-contributor-kv'])"
                },
                {
                    "type": "html",
                    "html": "Refer your Azure team to <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/setup/satellite' target='_blank'>Set up satellites</a> to create Azure App registration and Azure KeyVault Secrets",
                    "visibleIf": "contains({technical-Azure},['azure-delegate'])"
                },
                {
                    "type": "checkbox",
                    "name": "technical-O365",
                    "title": "Check the best Office 365 option(s) that apply for you",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "lic",
                            "text": "I have Office 365 E3 "
                        },
                        {
                            "value": "not-sure",
                            "text": "Not sure"
                        }
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "html",
                    "html": "Office 365 pre-requistes met",
                    "visibleIf": "contains({technical-O365},['lic'])"
                },
                {
                    "type": "checkbox",
                    "name": "technical-PP",
                    "title": "Check the best Power Platform option(s) that apply for you",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "pp-tenant-admin",
                            "text": "I have Power Platform tenant admin rights"
                        },
                        {
                            "value": "pp-environment-admin",
                            "text": "I have Power Platform environment admin right"
                        },
                        {
                            "value": "power-bi-pro",
                            "text": "I have Power BI professional licenses available"
                        }
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "html",
                    "html": "Power Platform pre-requistes met",
                    "visibleIf": "contains({technical-PP},['pp-tenant-admin','pp-environment-admin']) and contains({technical-PP},['power-bi-pro'])"
                },
                {
                    "type": "radiogroup",
                    "name": "technical-ALM",
                    "title": "Check the best ALM option(s) that apply for you for your Power Automation Desktop Deployments",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "manual",
                            "text": "We will manual import / export solutions between environments"
                        },
                        {
                            "value": "alm-setup",
                            "text": "We need to setup ALM process for deployment"
                        }
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "html",
                    "html": "Review <a href='https://learn.microsoft.com/power-platform/guidance/coe/almacceleratorpowerplatform-components' target='_blank'>ALM Accelerator</a> for ALM automation install and setup documentation",
                    "visibleIf": "{technical-ALM} = 'alm-setup'"
                },
                {
                    "type": "radiogroup",
                    "name": "technical-data",
                    "title": "Check the best data setup option(s) that apply",
                    "isRequired": true,
                    "colCount": 1,
                    "choices": [
                        {
                            "value": "manual",
                            "text": "We will follow documents to setup and configure Automation Kit data"
                        },
                        {
                            "value": "import",
                            "text": "We would like to import pre-packaged sample data sets"
                        }
                    ],
                    "visibleIf": "({checkInstalled}='No' or {checkInstalled}='Not Sure') and contains({roles},['All', 'Center Of Excellence']) = true"
                },
                {
                    "type": "html",
                    "html": "Review <a href='https://learn.microsoft.com/power-automate/guidance/automation-kit/configure-automation-kit' target='_blank'>Configure automation kit</a> learning content",
                    "visibleIf": "{technical-data} = 'manual'"
                },
                {
                    "type": "html",
                    "html": "Watch <a href='https://github.com/microsoft/powercat-automation-kit/issues/19' target='_blank'>Sample Import</a> issue for progress",
                    "visibleIf": "{technical-data} = 'import'"
                },
                
                {
                    "name": "haveQuestionsHelped",
                    "type": "boolean",
                    "title": "Have these questions helped?"
                },
                {
                    "type": "html",
                    "html": "Review our <a href='/frequently-asked-questions' target='_blank'>frequently asked questions</a> page for other common Question and Answers",
                    "visibleIf": "{haveQuestionsHelped}=False"
                },
                {
                    "type": "html",
                    "html": "Consider giving feedback below on how we can improve",
                    "visibleIf": "{haveQuestionsHelped}=False"
                },
                {
                    "type": "html",
                    "html": "Consider giving feedback below or create a <a href='https://github.com/microsoft/powercat-automation-kit/issues/new/choose' target='_blank'>New Kudos</a> or comment on an <a href='https://github.com/microsoft/powercat-automation-kit/issues?q=is%3Aopen+is%3Aissue+label%3Akudos' target='_blank'>existing Kudos</a> to provide feedback",
                    "visibleIf": "{haveQuestionsHelped}=True"
                },
                {
                    "type": "boolean",
                    "name": "send-results",
                    "label": "Do you want to send the results of the your check list so that the Core Automation Kit team can gather your feedback to improve the process?",
                    "isRequired": true
                },
                {
                    "type": "html",
                    "visibleIf": "{send-results} = true",
                    "html": "We look forward to getting your feedback. As a core Automation Kit team we use the feedback to improving our getting started guidance"
                },
                {
                    "type": "comment",
                    "name": "other-feedback",
                    "title": "Did you have any other feedback?",
                    "visibleIf": "{send-results} = true"
                },
                {
                    "type": "feedback-task",
                    "name": "send-results",
                    "title": "Send your feedback now?",
                    "destination": "https://aka.ms/ak4pp-feedback2",
                    "visibleIf": "{send-results} = true"
                },
                {
                    "type": "html",
                    "visibleIf": "{send-results-status.length} > 0",
                    "html": "Status: {send-results-status}"
                }
            ]
        }
    ]
}