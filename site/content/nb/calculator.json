{
  "showQuestionNumbers": "off",
  "pages": [
    {
      "name": "welcome",
      "visibleIf": "{preview} = true",
      "elements": [
        {
          "type": "radiogroup",
          "name": "scenario",
          "title": {
            "default": "What scenario are you trying to calculate?",
            "nb": "Hvilket scenario prøver du å beregne?"
          },
          "choices": [
            {
              "value": "calculator",
              "text": {
                "default": "Power Automate / Power Automate Desktop license cost",
                "nb": "Kostnad for Power Automate / Power Automate Desktop"
              }
            },
            {
              "value": "migration-planner",
              "text": {
                "default": "Migration planner",
                "nb": "Migrasjonsplanlegger"
              }
            },
            {
              "value": "samples",
              "text": {
                "default": "Sample scenarios",
                "nb": "Eksempel på scenarier"
              }
            }
          ]
        },
        {
          "type": "radiogroup",
          "name": "sample-scenario",
          "visibleIf": "{scenario} = 'samples'",
          "title": {
            "default": "What sample scenario did you want to explore?",
            "nb": "Hvilket eksempelscenario ønsket du å utforske?"
          },
          "choices": [
            {
              "value": "migration-single-unattended",
              "text": {
                "default": "Migration of a single unattended bot running isolated from other bot process",
                "nb": "Overføring av én enkelt uovervåket robot som kjører isolert fra en annen robotprosess"
              }
            },
            {
              "value": "migration-200",
              "text": {
                "default": "Migration of hundreds of bots",
                "nb": "Migrering av hundrevis av roboter"
              }
            },
            {
              "value": "process-mining",
              "text": {
                "default": "Using Process Advisor to identify Process automation",
                "nb": "Bruke Process Advisor til å identifisere prosessautomatisering"
              }
            },
            {
              "value": "task-mining",
              "text": {
                "default": "Using Process Advisor task mining to analyze and improve bot reliability",
                "nb": "Bruke Process Advisor oppgaveutvinning til å analysere og forbedre robotpåliteligheten"
              }
            }
          ]
        },
        {
          "type": "html",
          "visibleIf": "{sample-scenario} = 'migration-single-unattended'",
          "html": {
            "default": "Single unattended bot migration. In this example an organization may want to migrate an existing automate an existing automation solution to the Power Platform. The deployed bot will be hosted in an isolated virtual network and Virtual Machine (VM) runner.",
            "nb": "Enkel uovervåket robotoverføring. I dette eksemplet vil kanskje en organisasjon overføre en eksisterende automatisere en eksisterende automatiseringsløsning til Power Platform. Den distribuerte roboten vil bli driftet i et isolert virtuelt nettverk og Virtual Machine (VM)-løper."
          }
        }
      ]
    },
    {
      "name": "migration",
      "title": {
        "default": "Migration Parameters",
        "nb": "Parametere for overføring"
      },
      "visibleIf": "{scenario} = 'migration-planner' || startsWith({sample-scenario}, 'migration-')",
      "elements": [
        {
          "name": "how-many-automation-projects",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "How many automation projects to migrate?",
            "nb": "Hvor mange automatiseringsprosjekter skal migreres?"
          },
          "isRequired": true
        },
        {
          "name": "attended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of attended automation projects?",
            "nb": "Prosentandel av overvåkede automatiseringsprosjekter?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "nb": "En verdi mellom 0 og 100"
              },
              "expression": "{attended-percentage} >= 0 && {attended-percentage} <= 100"
            }
          ]
        },
        {
          "name": "unattended-percentage",
          "type": "text",
          "inputType": "number",
          "title": {
            "default": "Percentage of unattended automation projects?",
            "nb": "Prosentandel av uovervåkede automatiseringsprosjekter?"
          },
          "isRequired": true,
          "validators": [
            {
              "type": "expression",
              "text": {
                "default": "A value between 0 and 100",
                "nb": "En verdi mellom 0 og 100"
              },
              "expression": "{unattended-percentage} >= 0 && {unattended-percentage} <= 100"
            }
          ]
        },
        {
          "type": "matrixdynamic",
          "name": "migration-groups",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new group",
            "nb": "Legg til ny gruppe"
          },
          "title": {
            "default": "Migration Groups",
            "nb": "Migrasjonsgrupper"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Migration Group Name",
                "nb": "Navn på overføringsgruppe"
              },
              "cellType": "text"
            },
            {
              "name": "description",
              "title": {
                "default": "Description",
                "nb": "Beskrivelse"
              },
              "cellType": "text"
            }
          ]
        },
        {
          "name": "groups",
          "type": "checkbox",
          "title": {
            "default": "Groups",
            "nb": "Grupper"
          },
          "visibleIf": "false",
          "choices": []
        },
        {
          "type": "matrixdynamic",
          "name": "migration-times",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "nb": "Legge til nytt element"
          },
          "title": {
            "default": "Duration Plan",
            "nb": "Varighet Plan"
          },
          "columns": [
            {
              "name": "complexity",
              "title": {
                "default": "Complexity",
                "nb": "Kompleksitet"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "inputType": "count",
              "choices": [
                {
                  "value": "low",
                  "text": {
                    "default": "Low",
                    "nb": "Lav"
                  }
                },
                {
                  "value": "medium",
                  "text": {
                    "default": "Medium",
                    "nb": "Middels"
                  }
                },
                {
                  "value": "high",
                  "text": {
                    "default": "High",
                    "nb": "Høy"
                  }
                }
              ]
            },
            {
              "name": "group",
              "title": {
                "default": "Group",
                "nb": "Gruppe"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choicesFromQuestion": "groups"
            },
            {
              "name": "percentage",
              "title": {
                "default": "Percentage",
                "nb": "Prosent"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "projects",
              "title": {
                "default": "Projects",
                "nb": "Prosjekter"
              },
              "cellType": "expression",
              "expression": "ceil(getNumber('how-many-automation-projects')*({row.percentage}/ 100))"
            },
            {
              "name": "projectsPerMonth",
              "title": {
                "default": "Projects per month",
                "nb": "Prosjekter per måned"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "total",
              "title": {
                "default": "Total (Business Days)",
                "nb": "Totalt (virkedager)"
              },
              "cellType": "expression",
              "expression": "ceil({row.projects} / {row.projectsPerMonth} * 20)"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: The values are for illustration purposes only and Ramp Time, Projects per Month and Total business days for migration will need to be determined for the specific projects being migrated.",
            "nb": "MERK: Verdiene er bare ment som illustrasjoner, og rampetid, prosjekter per måned og totale virkedager for overføring må bestemmes for de spesifikke prosjektene som overføres."
          }
        },
        {
          "type": "boolean",
          "name": "calc-migration-plan",
          "title": {
            "default": "Automatically calculate possible migration plan?",
            "nb": "Automatisk beregne mulig migreringsplan?"
          },
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "migration-plan",
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "nb": "Legge til nytt element"
          },
          "title": {
            "default": "Migration Plan",
            "nb": "Overføringsplan"
          },
          "columns": [
            {
              "name": "name",
              "title": {
                "default": "Name",
                "nb": "Navn"
              },
              "cellType": "text"
            },
            {
              "name": "low",
              "title": {
                "default": "Low",
                "nb": "Lav"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "medium",
              "title": {
                "default": "Medium",
                "nb": "Middels"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "high",
              "title": {
                "default": "High",
                "nb": "Høy"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "attended",
              "title": {
                "default": "Attended",
                "nb": "Deltok"
              },
              "cellType": "text",
              "inputType": "number"
            },
            {
              "name": "unattended",
              "title": {
                "default": "Unattended",
                "nb": "Uten tilsyn"
              },
              "cellType": "text",
              "inputType": "number"
            }
          ]
        }
      ]
    },
    {
      "name": "calculation",
      "elements": [
        {
          "name": "tellMeMore",
          "type": "boolean",
          "title": {
            "default": "Tell me more about each license type",
            "nb": "Fortell meg mer om hver lisenstype"
          },
          "defaultValue": true
        },
        {
          "name": "matrix-image",
          "type": "image-task",
          "visibleIf": "{tellMeMore} == true",
          "title": {
            "default": "Select plans you want more information on",
            "nb": "Velg planer du vil ha mer informasjon om"
          },
          "src": "https://microsoft.github.io/powercat-automation-kit/images/illustrations/LicenseMatrix.svg?v=2"
        },
        {
          "type": "html",
          "html": {
            "default": "Further details on licenses included seeded licenses with Microsoft Office 365, Microsoft Dynamics, Pay as you Go options and Windows is available at <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Buy Power Automate Licenses</a>",
            "nb": "Ytterligere detaljer om lisenser inkluderte seedede lisenser med Microsoft Office 365, Microsoft Dynamics, Go og Windows er tilgjengelig på <a href='https://learn.microsoft.com/power-platform/admin/power-automate-licensing/buy-licenses' target='blank'>Kjøp Power Automate-lisenser</a>"
          }
        },
        {
          "name": "includeCurrentCost",
          "title": {
            "default": "Include current costs",
            "nb": "Inkluder løpende kostnader"
          },
          "isRequired": true,
          "type": "boolean",
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "currentItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "nb": "Legge til nytt element"
          },
          "visibleIf": "{includeCurrentCost}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "nb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Makers",
                  "text": {
                    "default": "Makers",
                    "nb": "Beslutningstakere"
                  }
                },
                {
                  "value": "Licenses",
                  "text": {
                    "default": "Licenses",
                    "nb": "Lisenser"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "nb": "Infrastruktur"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "nb": "Beløp"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "cost",
              "title": {
                "default": "Cost",
                "nb": "Kostnad"
              },
              "isRequired": true,
              "displayStyle": "currency",
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "nb": "Månedlig"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": false,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "currentTotal",
              "title": {
                "default": "Total",
                "nb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * {row.cost} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "name": "retailPrice",
          "type": "boolean",
          "title": {
            "default": "Power Platform license costs monthly",
            "nb": "Power Platform lisensen koster månedlig"
          },
          "labelTrue": "Retail price",
          "labelFalse": "Custom price",
          "defaultValue": true
        },
        {
          "type": "matrixdynamic",
          "name": "items",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "nb": "Legge til nytt element"
          },
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "nb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Trial",
                  "text": {
                    "default": "Trial",
                    "nb": "Rettergang"
                  }
                },
                {
                  "value": "User",
                  "text": {
                    "default": "User",
                    "nb": "Bruker"
                  }
                },
                {
                  "value": "Flow",
                  "text": {
                    "default": "Flow",
                    "nb": "Flyte"
                  }
                },
                {
                  "value": "Extra Flow",
                  "text": {
                    "default": "Extra Flow",
                    "nb": "Ekstra flyt"
                  }
                }
              ]
            },
            {
              "name": "mode",
              "title": {
                "default": "Mode",
                "nb": "Modus"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Attended",
                  "text": {
                    "default": "Attended",
                    "nb": "Deltok"
                  }
                },
                {
                  "value": "Unattended",
                  "text": {
                    "default": "Unattended",
                    "nb": "Uten tilsyn"
                  }
                },
                {
                  "value": "Cloud",
                  "text": {
                    "default": "Cloud",
                    "nb": "Sky"
                  }
                }
              ]
            },
            {
              "name": "price",
              "title": {
                "default": "Price",
                "nb": "Pris"
              },
              "cellType": "expression",
              "expression": "getItemPrice()",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == true"
            },
            {
              "name": "customPrice",
              "title": {
                "default": "Price",
                "nb": "Pris"
              },
              "cellType": "text",
              "inputType": "number",
              "displayStyle": "currency",
              "visibleIf": "{retailPrice} == false"
            },
            {
              "name": "quantity",
              "title": {
                "default": "Quantity",
                "nb": "Kvantitet"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "totalType": "sum",
              "totalFormat": "Total services: {0}",
              "min": 1
            },
            {
              "name": "total",
              "title": {
                "default": "Total",
                "nb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.quantity} * iif({retailPrice},{row.price},{row.customPrice})",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "html",
          "html": {
            "default": "NOTE: Type <b>Flow</b> represents minimum order of 5 cloud / RPA flows. Type <b>Extra Flow</b> represents single flow above the minimum order level of 5 flows.",
            "nb": "MERK: Type <b>Flyte</b> representerer minimumsbestilling på 5 sky-/RPA-flyter. Type <b>Ekstra flyt</b> representerer enkeltflyt over minimumsordrenivået på 5 flyter."
          }
        },
        {
          "type": "expression",
          "name": "powerPlatformCost",
          "title": {
            "default": "Power Platform license cost yearly",
            "nb": "Power Platform lisenskostnaden årlig"
          },
          "expression": "{items-total.total}*12",
          "displayStyle": "currency"
        },
        {
          "name": "otherCosts",
          "type": "boolean",
          "title": {
            "default": "Include other costs",
            "nb": "Inkluder andre kostnader"
          },
          "defaultValue": false
        },
        {
          "type": "matrixdynamic",
          "name": "otherItems",
          "rowCount": 1,
          "minRowCount": 1,
          "titleLocation": "none",
          "addRowText": {
            "default": "Add new item",
            "nb": "Legge til nytt element"
          },
          "visibleIf": "{otherCosts}",
          "columns": [
            {
              "name": "type",
              "title": {
                "default": "Type",
                "nb": "Type"
              },
              "isRequired": true,
              "cellType": "dropdown",
              "choices": [
                {
                  "value": "Migration",
                  "text": {
                    "default": "Migration",
                    "nb": "Migrasjon"
                  }
                },
                {
                  "value": "Infrastructure",
                  "text": {
                    "default": "Infrastructure",
                    "nb": "Infrastruktur"
                  }
                }
              ]
            },
            {
              "name": "amount",
              "title": {
                "default": "Amount",
                "nb": "Beløp"
              },
              "isRequired": true,
              "cellType": "text",
              "inputType": "number",
              "min": 1
            },
            {
              "name": "monthly",
              "title": {
                "default": "Monthly",
                "nb": "Månedlig"
              },
              "isRequired": true,
              "cellType": "boolean",
              "defaultValue": true,
              "labelTrue": "Monthly",
              "labelFalse": "Yearly"
            },
            {
              "name": "otherTotal",
              "title": {
                "default": "Total",
                "nb": "Total"
              },
              "cellType": "expression",
              "expression": "{row.amount} * iif({row.monthly},12,1)",
              "displayStyle": "currency",
              "totalType": "sum",
              "totalDisplayStyle": "currency",
              "totalFormat": "Total: {0}"
            }
          ]
        },
        {
          "type": "expression",
          "title": {
            "default": "Difference yearly",
            "nb": "Forskjell årlig"
          },
          "expression": "iif({includeCurrentCost},{currentItems-total.currentTotal}-{powerPlatformCost}-iif({otherCosts},{otherItems-total.otherTotal},0),{powerPlatformCost}+iif({otherCosts},{otherItems-total.otherTotal},0))",
          "displayStyle": "currency"
        }
      ]
    }
  ]
}